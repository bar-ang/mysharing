<!DOCTYPE html>
<!-- saved from url=(0098)https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#3035188 -->
<html itemscope="" itemtype="http://schema.org/QAPage"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>python - Fastest way to list all primes below N - Stack Overflow</title>
    <link rel="shortcut icon" href="https://cdn.sstatic.net/Sites/stackoverflow/img/favicon.ico?v=4f32ecc8f43d">
    <link rel="apple-touch-icon image_src" href="https://cdn.sstatic.net/Sites/stackoverflow/img/apple-touch-icon.png?v=c78bd457575a">
    <link rel="search" type="application/opensearchdescription+xml" title="Stack Overflow" href="https://stackoverflow.com/opensearch.xml">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary">
        <meta name="twitter:domain" content="stackoverflow.com">

    <meta property="og:image" itemprop="image primaryImageOfPage" content="https://cdn.sstatic.net/Sites/stackoverflow/img/apple-touch-icon@2.png?v=73d79a89bded">
    <meta name="twitter:title" property="og:title" itemprop="title name" content="Fastest way to list all primes below N">
    <meta name="twitter:description" property="og:description" itemprop="description" content="This is the best algorithm I could come up.

def get_primes(n):
    numbers = set(range(n, 1, -1))
    primes = []
    while numbers:
        p = numbers.pop()
        primes.append(p)
        numb...">
    <meta property="og:url" content="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188">
    <link rel="canonical" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188">

    
    
    <script type="text/javascript" async="" src="https://engine.adzerk.net/ados?t=1500150502668&amp;request={%22Placements%22:[{%22A%22:22,%22S%22:8277,%22D%22:%22adzerk1651577147%22,%22AT%22:4,%22Z%22:[43]},{%22A%22:22,%22S%22:8277,%22D%22:%22adzerk1497483724%22,%22AT%22:4,%22Z%22:[44]},{%22A%22:22,%22S%22:8277,%22D%22:%22adzerk1860010798%22,%22ATA%22:[5,17,2221,1129,43],%22Z%22:[45]}],%22Keywords%22:%22python%2Cmath%2Coptimization%2Cprimes%2Cx-cross-site-unix.stackexchange.com%22,%22Referrer%22:%22https%3A%2F%2Fstackoverflow.com%2Fquestions%2F2068372%2Ffastest-way-to-list-all-primes-below-n%22,%22IsAsync%22:true}"></script><script async="" src="./python - Fastest way to list all primes below N - Stack Overflow_files/quant.js.download"></script><script async="" src="./python - Fastest way to list all primes below N - Stack Overflow_files/beacon.js.download"></script><script async="" src="./python - Fastest way to list all primes below N - Stack Overflow_files/analytics.js.download"></script><script type="text/javascript" async="" src="./python - Fastest way to list all primes below N - Stack Overflow_files/ados.js.download"></script><script src="./python - Fastest way to list all primes below N - Stack Overflow_files/jquery.min.js.download"></script>
    <script src="./python - Fastest way to list all primes below N - Stack Overflow_files/stub.en.js.download"></script>
    <link rel="stylesheet" type="text/css" href="./python - Fastest way to list all primes below N - Stack Overflow_files/all.css">

            <link rel="alternate" type="application/atom+xml" title="Feed for question &#39;Fastest way to list all primes below N&#39;" href="https://stackoverflow.com/feeds/question/2068372">
            <meta name="twitter:app:country" content="US">
            <meta name="twitter:app:name:iphone" content="Stack Exchange iOS">
            <meta name="twitter:app:id:iphone" content="871299723">
            <meta name="twitter:app:url:iphone" content="se-zaphod://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188">
            <meta name="twitter:app:name:ipad" content="Stack Exchange iOS">
            <meta name="twitter:app:id:ipad" content="871299723">
            <meta name="twitter:app:url:ipad" content="se-zaphod://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188">
            <meta name="twitter:app:name:googleplay" content="Stack Exchange Android">
            <meta name="twitter:app:url:googleplay" content="http://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188">
            <meta name="twitter:app:id:googleplay" content="com.stackexchange.marvin">
        <script>
        
            StackExchange.ready(function () {
                                    
                    StackExchange.using("snippets", function () {
                        StackExchange.snippets.initSnippetRenderer();
                    });
                    

                StackExchange.using("postValidation", function () {
                    StackExchange.postValidation.initOnBlurAndSubmit($('#post-form'), 2, 'answer');
                });

                
                StackExchange.question.init({showAnswerHelp:true,totalCommentCount:8,shownCommentCount:5,highlightColor:'#F4A83D',backgroundColor:'#FFF',questionId:2068372});

                styleCode();

                    StackExchange.realtime.subscribeToQuestion('1', '2068372');
                                                                    StackExchange.using("gps", function () { StackExchange.gps.trackOutboundClicks('#content', '.post-text', true); });

            });
        </script>


    <script>
        StackExchange.init({"locale":"en","stackAuthUrl":"https://stackauth.com","networkMetaHostname":"meta.stackexchange.com","serverTime":1500150504,"routeName":"Questions/Show","site":{"name":"Stack Overflow","description":"Q&A for professional and enthusiast programmers","isNoticesTabEnabled":true,"recaptchaPublicKey":"6LdchgIAAAAAAJwGpIzRQSOFaO0pU6s44Xt8aTwc","recaptchaAudioLang":"en","enableNewTagCreationWarning":true,"insertSpaceAfterNameTabCompletion":false,"id":1,"enableInsertDocLinkDialog":true,"childUrl":"https://meta.stackoverflow.com","enableSocialMediaInSharePopup":true,"protocol":"https"},"user":{"fkey":"9022c997ff4316f1992608ad75e0965c","rep":0,"isAnonymous":true,"isAnonymousNetworkWide":true,"canSeeNewHeaderDesign":true},"events":{"postType":{"question":1},"postEditionSection":{"title":1,"body":2,"tags":3}},"story":{"minCompleteBodyLength":75,"likedTagsMaxLength":300,"dislikedTagsMaxLength":300}}, {"site":{"allowImageUploads":true,"enableUserHovercards":true,"styleCode":true,"enableNewLinkInsertDialog":true,"enableImgurHttps":true,"forceHttpsImages":true},"comments":{},"userProfile":{"openGraphAPIKey":"58740831ad23540e00c58987"},"tags":{},"accounts":{"currentPasswordRequiredForChangingStackIdPassword":true},"flags":{"allowRetractingFlags":true},"snippets":{"snippetsEnabled":true,"renderDomain":"stacksnippets.net"},"markdown":{"asteriskIntraWordEmphasis":true},"monitoring":{"clientTimingsAbsoluteTimeout":30000,"clientTimingsDebounceTimeout":1000}});
        StackExchange.using.setCacheBreakers({"js/prettify-full.en.js":"f8ea3f25f117","js/moderator.en.js":"f44f06cabd2f","js/full-anon.en.js":"b909715880a9","js/full.en.js":"71e8ae76b973","js/wmd.en.js":"fcaa29076af6","js/third-party/jquery.autocomplete.min.js":"d3b8fa7fdf74","js/third-party/jquery.autocomplete.min.en.js":"","js/mobile.en.js":"d7da0bad5bdf","js/help.en.js":"118cb359bcc6","js/tageditor.en.js":"248fce004255","js/tageditornew.en.js":"ae513d7acd9d","js/inline-tag-editing.en.js":"7581a98341e4","js/revisions.en.js":"cf90cfea0ccf","js/review.en.js":"379cb84b9f83","js/tagsuggestions.en.js":"d1ff9b84abe5","js/post-validation.en.js":"56ea0f8f12d6","js/explore-qlist.en.js":"d33e3ab2f2e0","js/events.en.js":"f850d31207e1","js/keyboard-shortcuts.en.js":"2aab79834a7a","js/external-editor.en.js":"ae2d26085224","js/adops.en.js":"9a6a7812a212","js/external-editor.en.js":"ae2d26085224","js/snippet-javascript.en.js":"ca40b13b0854","js/snippet-javascript-codemirror.en.js":"ccc4a300e249"});
        StackExchange.using("gps", function() {
             StackExchange.gps.init(true);
        });
    </script>
    
        <script>
            StackExchange.ready(function () {
                $('#nav-tour').click(function () {
                    StackExchange.using("gps", function() {
                        StackExchange.gps.track("aboutpage.click", { aboutclick_location: "headermain" }, true);
                    });
                });
            });
        </script>
    <noscript id="noscript-css">&lt;style type="text/css"&gt;body,.so-header{margin-top:1.9em}&lt;/style&gt;</noscript>
<script async="" src="./python - Fastest way to list all primes below N - Stack Overflow_files/full-anon.en.js.download"></script><script async="" src="./python - Fastest way to list all primes below N - Stack Overflow_files/snippet-javascript.en.js.download"></script><script async="" src="./python - Fastest way to list all primes below N - Stack Overflow_files/post-validation.en.js.download"></script><script async="" src="./python - Fastest way to list all primes below N - Stack Overflow_files/prettify-full.en.js.download"></script><script type="text/javascript" src="./python - Fastest way to list all primes below N - Stack Overflow_files/adFeedback.js.download"></script><link rel="stylesheet" href="./python - Fastest way to list all primes below N - Stack Overflow_files/adFeedback.css"><link rel="stylesheet" href="./python - Fastest way to list all primes below N - Stack Overflow_files/jobs-multi.min.css" type="text/css"></head>
<body class="question-page new-topbar">
            <script>(function () { var old = $.fn.contents; $.fn.contents = function () { try { return old.apply(this, arguments); } catch (e) { return $([]); } } })()</script>
        

    <div id="notify-container"></div>
    <div id="custom-header"></div>


<header class="so-header js-so-header _fixed _scrolling">
    <div class="-container">
        <div class="-main">            
            <a href="https://stackoverflow.com/" class="-logo js-gps-track " data-gps-track="top_nav.click({is_current:false, location:2, destination:8})">

                <span class="-img">Stack Overflow</span>
            </a>

            <nav class="navigation" role="navigation" aria-label="site navigation">
                <ol class="-list">
                        <li class="-item _current">
        <a id="nav-questions" href="https://stackoverflow.com/questions" class="-link js-gps-track" data-gps-track="top_nav.click({is_current:true, location:2, destination:1})">Questions</a>
    </li>

    <li class="-item">
        <a id="nav-jobs" href="https://stackoverflow.com/jobs?med=site-ui&amp;ref=jobs-tab" class="-link js-gps-track" data-gps-track="top_nav.click({is_current:false, location:2, destination:6})">Developer Jobs</a>
    </li>
                        <li class="-item">
        <a id="nav-docs" href="https://stackoverflow.com/documentation" class="-link js-gps-track" data-gps-track="top_nav.click({is_current:false, location:2, destination:7})">Documentation <small class="beta-badge">beta</small></a>
    </li>
                        <li class="-item">
        <a id="nav-tags" href="https://stackoverflow.com/tags" class="-link js-gps-track" data-gps-track="top_nav.click({is_current:false, location:2, destination:2})">Tags</a>
    </li>

                        <li class="-item">
        <a id="nav-users" href="https://stackoverflow.com/users" class="-link js-gps-track" data-gps-track="top_nav.click({is_current:false, location:2, destination:3})">Users</a>
    </li>

                </ol>
            </nav>

                <form id="search" action="https://stackoverflow.com/search" method="get" class="searchbar" autocomplete="off" role="search">
                    <svg role="icon" class="svg-icon iconSearch" width="18" height="18" viewBox="0 0 18 18"><path d="M12.864 11.321L18 16.5 16.5 18l-5.178-5.136v-.357a7 7 0 1 1 1.186-1.186h.356zM7 12A5 5 0 1 0 7 2a5 5 0 0 0 0 10z"></path></svg>
                    <input name="q" type="text" placeholder="Search..." value="" tabindex="1" autocomplete="off" maxlength="240" class="f-input js-search-field">
                    <button type="submit" class="btn js-search-submit">
                        <svg role="icon" class="svg-icon iconSearch" width="18" height="18" viewBox="0 0 18 18"><path d="M12.864 11.321L18 16.5 16.5 18l-5.178-5.136v-.357a7 7 0 1 1 1.186-1.186h.356zM7 12A5 5 0 1 0 7 2a5 5 0 0 0 0 10z"></path></svg>
                    </button>
                </form>

        </div>
        


    

<div class="-actions">
    <nav class="secondary-nav">
        <div class="-dialog-container js-topbar-dialog-corral">


    <div class="topbar-dialog siteSwitcher-dialog dno">
        <div class="header">
            <h3><a href="https://stackoverflow.com/">current community</a>
            </h3>
        </div>
        <div class="modal-content current-site-container">
            <ul class="current-site">
                    <li>
                            <div class="related-links">
            <a href="https://stackoverflow.com/help" class="js-gps-track" data-gps-track="site_switcher.click({ item_type:14 })">help</a>
                    <a href="https://chat.stackoverflow.com/" class="js-gps-track" data-gps-track="site_switcher.click({ item_type:6 })">chat</a>
            </div>

    <a href="https://stackoverflow.com/" class="current-site-link site-link js-gps-track" data-id="1" data-gps-track="site_switcher.click({ item_type:3 })">
        <div class="site-icon favicon favicon-stackoverflow" title="Stack Overflow"></div>
        Stack Overflow
    </a>

                    </li>
                    <li class="related-site">
                            <div class="L-shaped-icon-container">
        <span class="L-shaped-icon"></span>
    </div>

                        
    <a href="https://meta.stackoverflow.com/" class="site-link js-gps-track" data-id="552" data-gps-track="site.switch({ target_site:552, item_type:3 }),site_switcher.click({ item_type:4 })">
        <div class="site-icon favicon favicon-stackoverflowmeta" title="Meta Stack Overflow"></div>
        Meta Stack Overflow
    </a>

                    </li>
            </ul>
        </div>

        <div class="header" id="your-communities-header">
            <h3>
your communities            </h3>

        </div>
        <div class="modal-content" id="your-communities-section">

                <div class="call-to-login">
<a href="https://stackoverflow.com/users/signup?ssrc=site_switcher&amp;returnurl=%2fusers%2fstory%2fcurrent&amp;amp;utm_source=stackoverflow.com&amp;amp;utm_medium=dev-story&amp;amp;utm_campaign=signup-redirect" class="login-link js-gps-track" data-gps-track="site_switcher.click({ item_type:10 })">Sign up</a> or <a href="https://stackoverflow.com/users/login?ssrc=site_switcher&amp;returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f2068372%2ffastest-way-to-list-all-primes-below-n%2f3035188" class="login-link js-gps-track" data-gps-track="site_switcher.click({ item_type:11 })">log in</a> to customize your list.
                </div>
        </div>

        <div class="header">
            <h3><a href="https://stackexchange.com/sites">more stack exchange communities</a>
            </h3>
            <a href="https://stackoverflow.blog/" class="fr">company blog</a>
        </div>
        <div class="modal-content">
                <div class="child-content"></div>
        </div>        
    </div>
                <div class="topbar-dialog help-dialog js-help-dialog dno">
        <div class="modal-content">
            <ul>
                                    <li>
                        <a href="https://stackoverflow.com/tour" class="js-gps-track" data-gps-track="help_popup.click({ item_type:1 })">
                            Tour
                            <span class="item-summary">
                                Start here for a quick overview of the site
                            </span>
                        </a>
                    </li>
                <li>
                    <a href="https://stackoverflow.com/help" class="js-gps-track" data-gps-track="help_popup.click({ item_type:4 })">
                        Help Center
                        <span class="item-summary">
                            Detailed answers to any questions you might have
                        </span>
                    </a>
                </li>
                        <li>
                            <a href="https://meta.stackoverflow.com/" class="js-gps-track" data-gps-track="help_popup.click({ item_type:2 })">
                                Meta
                                <span class="item-summary">
                                    Discuss the workings and policies of this site
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://stackoverflow.com/company/about" class="js-gps-track" data-gps-track="help_popup.click({ item_type:6 })">
                                About Us
                                <span class="item-summary">
                                    Learn more about Stack Overflow the company
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.stackoverflowbusiness.com/?ref=topbar_help" class="js-gps-track" data-gps-track="help_popup.click({ item_type:7 })">
                                Business
                                <span class="item-summary">
                                    Learn more about hiring developers or posting ads with us
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
    </div>

        </div>
        <ol class="-list">


    <li class="-item"><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" class="-link js-help-button" title="Help Center and other resources">
        <svg role="icon" class="svg-icon iconHelp" width="18" height="18" viewBox="0 0 18 18"><path d="M9 1a8 8 0 1 0 0 16.001A8 8 0 0 0 9 1zm.812 12.126c-.02.716-.55 1.157-1.238 1.137-.659-.02-1.177-.49-1.157-1.209.02-.715.566-1.17 1.225-1.15.691.021 1.194.507 1.17 1.222zm1.956-5.114c-.168.237-.546.542-1.02.912l-.527.361c-.257.197-.417.43-.502.695-.044.141-.076.507-.084.752-.004.048-.032.156-.181.156H7.883c-.165 0-.185-.096-.18-.144.023-.667.12-1.218.397-1.66.374-.594 1.426-1.221 1.426-1.221.161-.12.286-.25.382-.39.177-.24.321-.51.321-.8 0-.333-.08-.65-.293-.915-.249-.31-.518-.458-1.036-.458-.51 0-.808.257-1.021.594-.213.338-.177.735-.177 1.097H5.746c0-1.366.357-2.238 1.112-2.752.51-.35 1.162-.502 1.921-.502.996 0 1.788.184 2.487.715.647.49.988 1.181.988 2.113 0 .575-.2 1.057-.486 1.447z"></path></svg>
    </a></li>
                <li class="-item">
        <a href="https://stackexchange.com/" class="-link js-site-switcher-button js-gps-track" data-gps-track="site_switcher.show" title="A list of all 169 Stack Exchange sites">
            <svg role="icon" class="svg-icon iconStackExchange" width="18" height="18" viewBox="0 0 18 18"><path d="M1 13a2 2 0 0 0 2 2h8v3l3-3h1a2 2 0 0 0 2-2v-2H1v2zM15 1H3a2 2 0 0 0-2 2v2h16V3a2 2 0 0 0-2-2zM1 6h16v4H1V6z"></path></svg>
        </a>
    </li>


        </ol>
    </nav>
        <div class="-ctas">
                <a href="https://stackoverflow.com/users/login?ssrc=head&amp;returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f2068372%2ffastest-way-to-list-all-primes-below-n%2f3035188" class="login-link btn-clear" rel="nofollow">Log In</a>
                    <a href="https://stackoverflow.com/users/signup?ssrc=head&amp;returnurl=%2fusers%2fstory%2fcurrent&amp;utm_source=stackoverflow.com&amp;utm_medium=dev-story&amp;utm_campaign=signup-redirect" class="login-link btn" rel="nofollow">Sign Up</a>

        </div>
</div>
    </div>
</header>

    <script>
        StackExchange.ready(function () { StackExchange.topbar.init(); });
            StackExchange.scrollPadding.setPaddingTop(60, 10);     </script>

    <div class="container">
        


        <div id="content" class="snippet-hidden">


            

            

<div itemscope="" itemtype="http://schema.org/Question">
    <link itemprop="image" href="https://cdn.sstatic.net/Sites/stackoverflow/img/apple-touch-icon.png?v=c78bd457575a">


<div id="herobox" class="alternate">
    <div class="test"></div>
        <div id="close">
            <a title="click to minimize"><span>x</span> Dismiss</a>
        </div>
    <div class="content">
        <b>Join the Stack Overflow Community</b>
        <div class="separator"></div>
        <div class="blurb">
            Stack Overflow is a community of 7.4 million programmers, just like you, helping each other.
                <br>
Join them; it only takes a minute:                <br>
        </div>
        <a href="https://stackoverflow.com/users/signup?ssrc=hero&amp;returnurl=%2fusers%2fstory%2fcurrent&amp;amp;utm_source=stackoverflow.com&amp;amp;utm_medium=dev-story&amp;amp;utm_campaign=signup-redirect" id="tell-me-more" class="button">Sign up</a>
    </div>
</div>
<script>
    StackExchange.ready(function () {

        var location = 0;
        if ($("body").hasClass("questions-page")) {
            location = 1;
        } else if ($("body").hasClass("question-page")) {
            location = 1;
        } else if ($("body").hasClass("faq-page")) {
            location = 5;
        } else if ($("body").hasClass("home-page")) {
            location = 3;
        }
        
        $('#tell-me-more').click(function () {
            StackExchange.using("gps", function () {
                StackExchange.gps.track("hero.action", { hero_action_type: 'cta', location: location }, true);
            });
        });
        
        $('#herobox #close').click(function () {
            StackExchange.using("gps", function () {
                StackExchange.gps.track("hero.action", { hero_action_type: "minimize", location: location }, true);
            });
            
            $.cookie("hero", "mini", { path: "/", expires: 365 });
            $.ajax({
                url: "/hero-mini",
                success: function (data) {
                    $("#herobox").fadeOut("fast", function () {
                        $("#herobox").replaceWith(data);
                        $("#herobox-mini").fadeIn("fast");
                    });
                }
            });
            return false;
        });
    });

</script>			<div id="question-header">
                <h1 itemprop="name"><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n" class="question-hyperlink">Fastest way to list all primes below N</a></h1>

            
<div class="aside-cta" role="navigation" aria-label="ask new question">
    <a href="https://stackoverflow.com/questions/ask" class="btn-outlined">Ask Question</a>
</div>
		</div>
			<div id="mainbar" role="main" aria-label="question and answers">

			

<div class="question" data-questionid="2068372" id="question">

    <script>
                var ados = ados || {}; ados.run = ados.run || [];
                ados.run.push(function () { ados_add_placement(22,8277,"adzerk1651577147",4).setZone(43); });
            </script>
            <div class="everyonelovesstackoverflow adzerk-vote" id="adzerk1651577147"><a href="https://engine.adzerk.net/r?e=eyJhdiI6MTg3ODA5LCJhdCI6NCwiYnQiOjAsImNtIjo1NDQ3ODksImNoIjoxMTc4LCJjayI6e30sImNyIjozNDQwMDA5LCJkaSI6IjNjNDE1ODZmMWI0ZTQwODVhNDM5NWU1MWNiZmZjZjU0IiwiZG0iOjEsImZjIjo2MDAwMjY5LCJmbCI6MjgwNjkzNywiaXAiOiI4NC4yMjkuMTA1LjIwIiwia3ciOiJweXRob24sbWF0aCxvcHRpbWl6YXRpb24scHJpbWVzLHgtY3Jvc3Mtc2l0ZS11bml4LnN0YWNrZXhjaGFuZ2UuY29tIiwibWsiOiJvcHRpbWl6YXRpb24iLCJudyI6MjIsInBjIjoxMi42NSwiZWMiOjEyLjY1LCJwciI6NzY1LCJydCI6MiwicmYiOiJodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8yMDY4MzcyL2Zhc3Rlc3Qtd2F5LXRvLWxpc3QtYWxsLXByaW1lcy1iZWxvdy1uIiwic2EiOiIzIiwic2IiOiJpLTBmNTJmMGUwZTcyYjliNTQ0Iiwic3AiOjE4MDEwLCJzdCI6ODI3NywidWsiOiJ1ZTEtNmFhZDU5YTFhODQ4NGNkOWI0MDUwZTc3YWI4ZmNjYzgiLCJ6biI6NDMsInRzIjoxNTAwMTUwNTA2ODg4LCJiZiI6dHJ1ZSwicG4iOiJhZHplcmsxNjUxNTc3MTQ3IiwidXIiOiJodHRwOi8vd3d3LmNvcmVzaXRlLmNvbS9wYWdlcy9wcGMvY2xvdWQtc2VydmljZXMvP3V0bV9jYW1wYWlnbj1zdGFja292ZXJmbG93JnV0bV9tZWRpdW09Y3BtJnV0bV9zb3VyY2U9Ym5yIn0&amp;s=OVxCEB3DfMHDhl5367fPIbjl61s" rel="nofollow" target="_blank" title=""><img src="https://s.zkcdn.net/Advertisers/59c9ce24e4304fc9a1ead59186b3dc33.jpg" title="" alt="" border="0" width="728" height="90" style="display: none !important;"></a><div class="adzerk-vote-controls" style="display:none;"><div class="adzerk-vote-option adzerk-vote-up"><div class="adzerk-vote-icon"></div></div><div class="adzerk-vote-option adzerk-vote-down"><div class="adzerk-vote-icon"></div></div></div><div class="adzerk-vote-survey" style="display:none;"><form><span>No problem. We won't show you that ad again. Why didn't you like it?</span><ul><li><label><input type="radio" value="12" name="downvoteReason">Uninteresting</label></li><li><label><input type="radio" value="13" name="downvoteReason">Misleading</label></li><li><label><input type="radio" value="14" name="downvoteReason">Offensive</label></li><li><label><input type="radio" value="15" name="downvoteReason">Repetitive</label></li><li><label><input type="radio" value="16" name="downvoteReason">Other</label></li></ul><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" class="adzerk-vote-cancel">Oops! I didn't mean to do this.</a></form></div><img height="0px" width="0px" border="0" style="position: absolute; display: none !important;" src="https://engine.adzerk.net/i.gif?e=eyJhdiI6MTg3ODA5LCJhdCI6NCwiYnQiOjAsImNtIjo1NDQ3ODksImNoIjoxMTc4LCJjayI6e30sImNyIjozNDQwMDA5LCJkaSI6IjNjNDE1ODZmMWI0ZTQwODVhNDM5NWU1MWNiZmZjZjU0IiwiZG0iOjEsImZjIjo2MDAwMjY5LCJmbCI6MjgwNjkzNywiaXAiOiI4NC4yMjkuMTA1LjIwIiwia3ciOiJweXRob24sbWF0aCxvcHRpbWl6YXRpb24scHJpbWVzLHgtY3Jvc3Mtc2l0ZS11bml4LnN0YWNrZXhjaGFuZ2UuY29tIiwibWsiOiJvcHRpbWl6YXRpb24iLCJudyI6MjIsInBjIjoxMi42NSwiZWMiOjEyLjY1LCJwciI6NzY1LCJydCI6MiwicmYiOiJodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8yMDY4MzcyL2Zhc3Rlc3Qtd2F5LXRvLWxpc3QtYWxsLXByaW1lcy1iZWxvdy1uIiwic2EiOiIzIiwic2IiOiJpLTBmNTJmMGUwZTcyYjliNTQ0Iiwic3AiOjE4MDEwLCJzdCI6ODI3NywidWsiOiJ1ZTEtNmFhZDU5YTFhODQ4NGNkOWI0MDUwZTc3YWI4ZmNjYzgiLCJ6biI6NDMsInRzIjoxNTAwMTUwNTA2ODkwLCJiZiI6dHJ1ZSwicG4iOiJhZHplcmsxNjUxNTc3MTQ3IiwiZnEiOjB9&amp;s=9yo7nA96XhlnDUqWI4OyYW9JbSM"></div>    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2068372">
        <a class="vote-up-off" title="This question shows research effort; it is useful and clear">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">273</span>
        <a class="vote-down-off" title="This question does not show any research effort; it is unclear or not useful">down vote</a>

        <a class="star-off" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#">favorite</a>
        <div class="favoritecount"><b>236</b></div>


</div>

            </td>
            
<td class="postcell">
<div>
    <div class="post-text" itemprop="text">

<p>This is the best algorithm I could come up.</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">def</span><span class="pln"> get_primes</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    numbers </span><span class="pun">=</span><span class="pln"> set</span><span class="pun">(</span><span class="pln">range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">))</span><span class="pln">
    primes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> numbers</span><span class="pun">:</span><span class="pln">
        p </span><span class="pun">=</span><span class="pln"> numbers</span><span class="pun">.</span><span class="pln">pop</span><span class="pun">()</span><span class="pln">
        primes</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">p</span><span class="pun">)</span><span class="pln">
        numbers</span><span class="pun">.</span><span class="pln">difference_update</span><span class="pun">(</span><span class="pln">set</span><span class="pun">(</span><span class="pln">range</span><span class="pun">(</span><span class="pln">p</span><span class="pun">*</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">)))</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> primes

</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> timeit</span><span class="pun">.</span><span class="typ">Timer</span><span class="pun">(</span><span class="pln">stmt</span><span class="pun">=</span><span class="str">'get_primes.get_primes(1000000)'</span><span class="pun">,</span><span class="pln"> setup</span><span class="pun">=</span><span class="str">'import   get_primes'</span><span class="pun">).</span><span class="pln">timeit</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
</span><span class="lit">1.1499958793645562</span></code></pre>

<p>Can it be made even faster?</p>

<p>This code has a flaw: Since <code>numbers</code> is an unordered set, there is no guarantee that <code>numbers.pop()</code> will remove the lowest number from the set. Nevertheless, it works (at least for me) for some input numbers:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pun">&gt;&gt;&gt;</span><span class="pln"> sum</span><span class="pun">(</span><span class="pln">get_primes</span><span class="pun">(</span><span class="lit">2000000</span><span class="pun">))</span><span class="pln">
</span><span class="lit">142913828922L</span><span class="pln">
</span><span class="com">#That's the correct sum of all numbers below 2 million</span><span class="pln">
</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="lit">529</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> get_primes</span><span class="pun">(</span><span class="lit">1000</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">False</span><span class="pln">
</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="lit">529</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> get_primes</span><span class="pun">(</span><span class="lit">530</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">True</span></code></pre>
    </div>
    <div class="post-taglist">
        <a href="https://stackoverflow.com/questions/tagged/python" class="post-tag js-gps-track" title="show questions tagged &#39;python&#39;" rel="tag">python</a> <a href="https://stackoverflow.com/questions/tagged/math" class="post-tag js-gps-track" title="show questions tagged &#39;math&#39;" rel="tag">math</a> <a href="https://stackoverflow.com/questions/tagged/optimization" class="post-tag js-gps-track" title="show questions tagged &#39;optimization&#39;" rel="tag">optimization</a> <a href="https://stackoverflow.com/questions/tagged/primes" class="post-tag js-gps-track" title="show questions tagged &#39;primes&#39;" rel="tag">primes</a> 
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/q/2068372" title="short permalink to this question" class="short-link" id="link-post-2068372">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/2068372/edit" class="suggest-edit-post" title="">improve this question</a></div>        
    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/2068372/revisions" title="show all edits to this post">edited <span title="2014-11-02 22:33:30Z" class="relativetime">Nov 2 '14 at 22:33</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/2371861/bjb568"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/7nxqo.jpg" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/2371861/bjb568">bjb568</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">6,316</span><span title="10 gold badges"><span class="badge1"></span><span class="badgecount">10</span></span><span title="30 silver badges"><span class="badge2"></span><span class="badgecount">30</span></span><span title="59 bronze badges"><span class="badge3"></span><span class="badgecount">59</span></span>
        </div>
    </div>
</div>    </td>
    <td class="post-signature owner">
        <div class="user-info ">
    <div class="user-action-time">
        asked <span title="2010-01-14 23:40:27Z" class="relativetime">Jan 14 '10 at 23:40</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/230636/jbochi"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/1018b29e2da89f5920a58482e17a1948" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/230636/jbochi">jbochi</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 16,903" dir="ltr">16.9k</span><span title="13 gold badges"><span class="badge1"></span><span class="badgecount">13</span></span><span title="58 silver badges"><span class="badge2"></span><span class="badgecount">58</span></span><span title="78 bronze badges"><span class="badge3"></span><span class="badgecount">78</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</div>
</td>
        </tr>
                    
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2068372" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="3" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-2061403" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Code sniplet in question is much faster if numbers declared like numbers = set(range(n, 2, -2)). But can't beat sundaram3.  Thanks for the question.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/84513/shekhar" title="5,139 reputation" class="comment-user">Shekhar</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2061403_2068372"><span title="2010-01-23 14:51:35Z" class="relativetime-clean">Jan 23 '10 at 14:51</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-8898980" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">2</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">It'd be nice if there could be Python 3 versions of the functions in the answers.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/149530/michael-foukarakis" title="23,926 reputation" class="comment-user">Michael Foukarakis</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment8898980_2068372"><span title="2011-09-10 15:19:43Z" class="relativetime-clean">Sep 10 '11 at 15:19</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-18176766" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Surely there's a library to do this so we don't have to roll our own&gt; xkcd promised Python is as simple as <code>import antigravity</code>. Isn't there anything like <code>require 'prime'; Prime.take(10)</code> (Ruby)?</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/284795/colonel-panic" title="63,588 reputation" class="comment-user">Colonel Panic</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment18176766_2068372"><span title="2012-11-10 17:09:26Z" class="relativetime-clean">Nov 10 '12 at 17:09</span></a></span>
                        <span class="edited-yes" title="this comment was edited 1 time"></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-50557459" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">2</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@ColonelPanic As it so happens I updated <a href="https://github.com/jaredks/pyprimesieve" rel="nofollow noreferrer">github.com/jaredks/pyprimesieve</a> for Py3 and added to PyPi. It's certainly faster than these but not orders of magnitude - more like ~5x faster than the best numpy versions.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/2147024/jared" title="11,297 reputation" class="comment-user">Jared</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment50557459_2068372"><span title="2015-07-08 01:48:27Z" class="relativetime-clean">Jul 8 '15 at 1:48</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-50951995" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@ColonelPanic: I think editing old answers to note that they've aged is appropriate, since that makes it a more useful resource.  If the "accepted" answer is no longer the best one, maybe edit a note into the question with a 2015 update to point people at the current best method.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/224132/peter-cordes" title="57,719 reputation" class="comment-user">Peter Cordes</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment50951995_2068372"><span title="2015-07-18 18:28:57Z" class="relativetime-clean">Jul 18 '15 at 18:28</span></a></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2068372" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link  dno" title="Use comments to ask for more information or suggest improvements. Avoid answering questions in comments."></a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link " title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick="">show <b>3</b> more comments</a>
        </div>         
    </td>
</tr>        </tbody></table>
</div>

			<div id="answers">

				<a name="tab-top"></a>
				<div id="answers-header">
					<div class="subheader answers-subheader">
						<h2>
								28 Answers
                                <span style="display:none;" itemprop="answerCount">28</span>
						</h2>
						<div>
							<div id="tabs">
        <a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n?answertab=active#tab-top" data-nav-xhref="" title="Answers with the latest activity first" data-value="active" data-shortcut="A">
            active</a>
        <a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n?answertab=oldest#tab-top" data-nav-xhref="" title="Answers in the order they were provided" data-value="oldest" data-shortcut="O">
            oldest</a>
        <a class="youarehere" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n?answertab=votes#tab-top" data-nav-xhref="" title="Answers with the highest score first" data-value="votes" data-shortcut="V">
            votes</a>
</div>
						</div>
					</div>    
				</div>    




  
<a name="2068548"></a>
<div id="answer-2068548" class="answer accepted-answer" data-answerid="2068548" itemscope="" itemtype="http://schema.org/Answer" itemprop="acceptedAnswer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2068548">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">275</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>



        <span class="vote-accepted-on load-accepted-answer-date" title="loading when this answer was accepted...">accepted</span>
<div class="bounty-award-container"><span class="bounty-award" title="This answer has been awarded bounties worth 100 reputation by jbochi">+100</span></div>
</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p><strong>Warning:</strong> <code>timeit</code> results may vary due to differences in hardware or
version of Python.  </p>

<p>Below is a script which compares a number of implementations: 
</p><ul>
<li>ambi_sieve_plain,
</li><li><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188">rwh_primes</a>, 
</li><li><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188">rwh_primes1</a>, 
</li><li><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188">rwh_primes2</a>, 
</li><li><a href="https://web.archive.org/web/20080324064651/http://krenzel.info/?p=83" rel="nofollow noreferrer">sieveOfAtkin</a>, 
</li><li><a href="http://groups.google.com/group/comp.lang.python/msg/f1f10ced88c68c2d" rel="nofollow noreferrer">sieveOfEratosthenes</a>, 
</li><li><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/2073279#2073279">sundaram3</a>,
</li><li><a href="http://zerovolt.com/?p=88" rel="nofollow noreferrer">sieve_wheel_30</a>,
</li><li><a href="http://tommih.blogspot.com/2009/04/fast-prime-number-generator.html" rel="nofollow noreferrer">ambi_sieve</a> (requires numpy)
</li><li><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188">primesfrom3to</a> (requires numpy)
</li><li><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188">primesfrom2to</a> (requires numpy)
</li></ul><p></p>

<p>Many thanks to <a href="https://stackoverflow.com/users/92092/stephan">stephan</a> for bringing sieve_wheel_30 to my attention.
Credit goes to <a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188">Robert William Hanks</a> for primesfrom2to, primesfrom3to, rwh_primes, rwh_primes1, and rwh_primes2.</p>

<p>Of the plain Python methods tested, <strong>with psyco</strong>, for n=1000000,
<strong>rwh_primes1</strong> was the fastest tested.</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pun">+---------------------+-------+</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> </span><span class="typ">Method</span><span class="pln">              </span><span class="pun">|</span><span class="pln"> ms    </span><span class="pun">|</span><span class="pln">
</span><span class="pun">+---------------------+-------+</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> rwh_primes1         </span><span class="pun">|</span><span class="pln"> </span><span class="lit">43.0</span><span class="pln">  </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> sieveOfAtkin        </span><span class="pun">|</span><span class="pln"> </span><span class="lit">46.4</span><span class="pln">  </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> rwh_primes          </span><span class="pun">|</span><span class="pln"> </span><span class="lit">57.4</span><span class="pln">  </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> sieve_wheel_30      </span><span class="pun">|</span><span class="pln"> </span><span class="lit">63.0</span><span class="pln">  </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> rwh_primes2         </span><span class="pun">|</span><span class="pln"> </span><span class="lit">67.8</span><span class="pln">  </span><span class="pun">|</span><span class="pln">    
</span><span class="pun">|</span><span class="pln"> sieveOfEratosthenes </span><span class="pun">|</span><span class="pln"> </span><span class="lit">147.0</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> ambi_sieve_plain    </span><span class="pun">|</span><span class="pln"> </span><span class="lit">152.0</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> sundaram3           </span><span class="pun">|</span><span class="pln"> </span><span class="lit">194.0</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="pun">+---------------------+-------+</span></code></pre>

<p>Of the plain Python methods tested, <strong>without psyco</strong>, for n=1000000,
<strong>rwh_primes2</strong> was the fastest.</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pun">+---------------------+-------+</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> </span><span class="typ">Method</span><span class="pln">              </span><span class="pun">|</span><span class="pln"> ms    </span><span class="pun">|</span><span class="pln">
</span><span class="pun">+---------------------+-------+</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> rwh_primes2         </span><span class="pun">|</span><span class="pln"> </span><span class="lit">68.1</span><span class="pln">  </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> rwh_primes1         </span><span class="pun">|</span><span class="pln"> </span><span class="lit">93.7</span><span class="pln">  </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> rwh_primes          </span><span class="pun">|</span><span class="pln"> </span><span class="lit">94.6</span><span class="pln">  </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> sieve_wheel_30      </span><span class="pun">|</span><span class="pln"> </span><span class="lit">97.4</span><span class="pln">  </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> sieveOfEratosthenes </span><span class="pun">|</span><span class="pln"> </span><span class="lit">178.0</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> ambi_sieve_plain    </span><span class="pun">|</span><span class="pln"> </span><span class="lit">286.0</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> sieveOfAtkin        </span><span class="pun">|</span><span class="pln"> </span><span class="lit">314.0</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> sundaram3           </span><span class="pun">|</span><span class="pln"> </span><span class="lit">416.0</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="pun">+---------------------+-------+</span></code></pre>

<p>Of all the methods tested, <em>allowing numpy</em>, for n=1000000,
<strong>primesfrom2to</strong> was the fastest tested.</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pun">+---------------------+-------+</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> </span><span class="typ">Method</span><span class="pln">              </span><span class="pun">|</span><span class="pln"> ms    </span><span class="pun">|</span><span class="pln">
</span><span class="pun">+---------------------+-------+</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> primesfrom2to       </span><span class="pun">|</span><span class="pln"> </span><span class="lit">15.9</span><span class="pln">  </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> primesfrom3to       </span><span class="pun">|</span><span class="pln"> </span><span class="lit">18.4</span><span class="pln">  </span><span class="pun">|</span><span class="pln">
</span><span class="pun">|</span><span class="pln"> ambi_sieve          </span><span class="pun">|</span><span class="pln"> </span><span class="lit">29.3</span><span class="pln">  </span><span class="pun">|</span><span class="pln">
</span><span class="pun">+---------------------+-------+</span></code></pre>

<p>Timings were measured using the command:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pln">python </span><span class="pun">-</span><span class="pln">mtimeit </span><span class="pun">-</span><span class="pln">s</span><span class="str">"import primes"</span><span class="pln"> </span><span class="str">"primes.{method}(1000000)"</span></code></pre>

<p>with <code>{method}</code> replaced by each of the method names.</p>

<p>primes.py:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="com">#!/usr/bin/env python</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> psyco</span><span class="pun">;</span><span class="pln"> psyco</span><span class="pun">.</span><span class="pln">full</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">from</span><span class="pln"> math </span><span class="kwd">import</span><span class="pln"> sqrt</span><span class="pun">,</span><span class="pln"> ceil
</span><span class="kwd">import</span><span class="pln"> numpy </span><span class="kwd">as</span><span class="pln"> np

</span><span class="kwd">def</span><span class="pln"> rwh_primes</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    </span><span class="com"># https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188</span><span class="pln">
    </span><span class="str">""" Returns  a list of primes &lt; n """</span><span class="pln">
    sieve </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">**</span><span class="lit">0.5</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">::</span><span class="lit">2</span><span class="pun">*</span><span class="pln">i</span><span class="pun">]=[</span><span class="kwd">False</span><span class="pun">]*((</span><span class="pln">n</span><span class="pun">-</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)/(</span><span class="lit">2</span><span class="pun">*</span><span class="pln">i</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">[</span><span class="pln">i </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> rwh_primes1</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    </span><span class="com"># https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188</span><span class="pln">
    </span><span class="str">""" Returns  a list of primes &lt; n """</span><span class="pln">
    sieve </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">/</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">**</span><span class="lit">0.5</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">/</span><span class="lit">2</span><span class="pun">]:</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">/</span><span class="lit">2</span><span class="pun">::</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">False</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">((</span><span class="pln">n</span><span class="pun">-</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)/(</span><span class="lit">2</span><span class="pun">*</span><span class="pln">i</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">*</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">/</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> rwh_primes2</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    </span><span class="com"># https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188</span><span class="pln">
    </span><span class="str">""" Input n&gt;=6, Returns a list of primes, 2 &lt;= p &lt; n """</span><span class="pln">
    correction </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">%</span><span class="lit">6</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">0</span><span class="pun">:</span><span class="pln">n</span><span class="pun">,</span><span class="lit">1</span><span class="pun">:</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">:</span><span class="pln">n</span><span class="pun">+</span><span class="lit">4</span><span class="pun">,</span><span class="lit">3</span><span class="pun">:</span><span class="pln">n</span><span class="pun">+</span><span class="lit">3</span><span class="pun">,</span><span class="lit">4</span><span class="pun">:</span><span class="pln">n</span><span class="pun">+</span><span class="lit">2</span><span class="pun">,</span><span class="lit">5</span><span class="pun">:</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">}[</span><span class="pln">n</span><span class="pun">%</span><span class="lit">6</span><span class="pun">]</span><span class="pln">
    sieve </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">/</span><span class="lit">3</span><span class="pun">)</span><span class="pln">
    sieve</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">**</span><span class="lit">0.5</span><span class="pun">)/</span><span class="lit">3</span><span class="pun">+</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
        k</span><span class="pun">=</span><span class="lit">3</span><span class="pun">*</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pln">
        sieve</span><span class="pun">[</span><span class="pln">      </span><span class="pun">((</span><span class="pln">k</span><span class="pun">*</span><span class="pln">k</span><span class="pun">)/</span><span class="lit">3</span><span class="pun">)</span><span class="pln">      </span><span class="pun">::</span><span class="lit">2</span><span class="pun">*</span><span class="pln">k</span><span class="pun">]=[</span><span class="kwd">False</span><span class="pun">]*((</span><span class="pln">n</span><span class="pun">/</span><span class="lit">6</span><span class="pun">-(</span><span class="pln">k</span><span class="pun">*</span><span class="pln">k</span><span class="pun">)/</span><span class="lit">6</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)/</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        sieve</span><span class="pun">[(</span><span class="pln">k</span><span class="pun">*</span><span class="pln">k</span><span class="pun">+</span><span class="lit">4</span><span class="pun">*</span><span class="pln">k</span><span class="pun">-</span><span class="lit">2</span><span class="pun">*</span><span class="pln">k</span><span class="pun">*(</span><span class="pln">i</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">))/</span><span class="lit">3</span><span class="pun">::</span><span class="lit">2</span><span class="pun">*</span><span class="pln">k</span><span class="pun">]=[</span><span class="kwd">False</span><span class="pun">]*((</span><span class="pln">n</span><span class="pun">/</span><span class="lit">6</span><span class="pun">-(</span><span class="pln">k</span><span class="pun">*</span><span class="pln">k</span><span class="pun">+</span><span class="lit">4</span><span class="pun">*</span><span class="pln">k</span><span class="pun">-</span><span class="lit">2</span><span class="pun">*</span><span class="pln">k</span><span class="pun">*(</span><span class="pln">i</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">))/</span><span class="lit">6</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)/</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">[</span><span class="lit">3</span><span class="pun">*</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">/</span><span class="lit">3</span><span class="pun">-</span><span class="pln">correction</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> sieve_wheel_30</span><span class="pun">(</span><span class="pln">N</span><span class="pun">):</span><span class="pln">
    </span><span class="com"># http://zerovolt.com/?p=88</span><span class="pln">
    </span><span class="str">''' Returns a list of primes &lt;= N using wheel criterion 2*3*5 = 30

Copyright 2009 by zerovolt.com
This code is free for non-commercial purposes, in which case you can just leave this comment as a credit for my work.
If you need this code for commercial purposes, please contact me by sending an email to: info [at] zerovolt [dot] com.'''</span><span class="pln">
    __smallp </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">11</span><span class="pun">,</span><span class="pln"> </span><span class="lit">13</span><span class="pun">,</span><span class="pln"> </span><span class="lit">17</span><span class="pun">,</span><span class="pln"> </span><span class="lit">19</span><span class="pun">,</span><span class="pln"> </span><span class="lit">23</span><span class="pun">,</span><span class="pln"> </span><span class="lit">29</span><span class="pun">,</span><span class="pln"> </span><span class="lit">31</span><span class="pun">,</span><span class="pln"> </span><span class="lit">37</span><span class="pun">,</span><span class="pln"> </span><span class="lit">41</span><span class="pun">,</span><span class="pln"> </span><span class="lit">43</span><span class="pun">,</span><span class="pln"> </span><span class="lit">47</span><span class="pun">,</span><span class="pln"> </span><span class="lit">53</span><span class="pun">,</span><span class="pln"> </span><span class="lit">59</span><span class="pun">,</span><span class="pln">
    </span><span class="lit">61</span><span class="pun">,</span><span class="pln"> </span><span class="lit">67</span><span class="pun">,</span><span class="pln"> </span><span class="lit">71</span><span class="pun">,</span><span class="pln"> </span><span class="lit">73</span><span class="pun">,</span><span class="pln"> </span><span class="lit">79</span><span class="pun">,</span><span class="pln"> </span><span class="lit">83</span><span class="pun">,</span><span class="pln"> </span><span class="lit">89</span><span class="pun">,</span><span class="pln"> </span><span class="lit">97</span><span class="pun">,</span><span class="pln"> </span><span class="lit">101</span><span class="pun">,</span><span class="pln"> </span><span class="lit">103</span><span class="pun">,</span><span class="pln"> </span><span class="lit">107</span><span class="pun">,</span><span class="pln"> </span><span class="lit">109</span><span class="pun">,</span><span class="pln"> </span><span class="lit">113</span><span class="pun">,</span><span class="pln"> </span><span class="lit">127</span><span class="pun">,</span><span class="pln"> </span><span class="lit">131</span><span class="pun">,</span><span class="pln"> </span><span class="lit">137</span><span class="pun">,</span><span class="pln"> </span><span class="lit">139</span><span class="pun">,</span><span class="pln">
    </span><span class="lit">149</span><span class="pun">,</span><span class="pln"> </span><span class="lit">151</span><span class="pun">,</span><span class="pln"> </span><span class="lit">157</span><span class="pun">,</span><span class="pln"> </span><span class="lit">163</span><span class="pun">,</span><span class="pln"> </span><span class="lit">167</span><span class="pun">,</span><span class="pln"> </span><span class="lit">173</span><span class="pun">,</span><span class="pln"> </span><span class="lit">179</span><span class="pun">,</span><span class="pln"> </span><span class="lit">181</span><span class="pun">,</span><span class="pln"> </span><span class="lit">191</span><span class="pun">,</span><span class="pln"> </span><span class="lit">193</span><span class="pun">,</span><span class="pln"> </span><span class="lit">197</span><span class="pun">,</span><span class="pln"> </span><span class="lit">199</span><span class="pun">,</span><span class="pln"> </span><span class="lit">211</span><span class="pun">,</span><span class="pln"> </span><span class="lit">223</span><span class="pun">,</span><span class="pln"> </span><span class="lit">227</span><span class="pun">,</span><span class="pln">
    </span><span class="lit">229</span><span class="pun">,</span><span class="pln"> </span><span class="lit">233</span><span class="pun">,</span><span class="pln"> </span><span class="lit">239</span><span class="pun">,</span><span class="pln"> </span><span class="lit">241</span><span class="pun">,</span><span class="pln"> </span><span class="lit">251</span><span class="pun">,</span><span class="pln"> </span><span class="lit">257</span><span class="pun">,</span><span class="pln"> </span><span class="lit">263</span><span class="pun">,</span><span class="pln"> </span><span class="lit">269</span><span class="pun">,</span><span class="pln"> </span><span class="lit">271</span><span class="pun">,</span><span class="pln"> </span><span class="lit">277</span><span class="pun">,</span><span class="pln"> </span><span class="lit">281</span><span class="pun">,</span><span class="pln"> </span><span class="lit">283</span><span class="pun">,</span><span class="pln"> </span><span class="lit">293</span><span class="pun">,</span><span class="pln"> </span><span class="lit">307</span><span class="pun">,</span><span class="pln"> </span><span class="lit">311</span><span class="pun">,</span><span class="pln">
    </span><span class="lit">313</span><span class="pun">,</span><span class="pln"> </span><span class="lit">317</span><span class="pun">,</span><span class="pln"> </span><span class="lit">331</span><span class="pun">,</span><span class="pln"> </span><span class="lit">337</span><span class="pun">,</span><span class="pln"> </span><span class="lit">347</span><span class="pun">,</span><span class="pln"> </span><span class="lit">349</span><span class="pun">,</span><span class="pln"> </span><span class="lit">353</span><span class="pun">,</span><span class="pln"> </span><span class="lit">359</span><span class="pun">,</span><span class="pln"> </span><span class="lit">367</span><span class="pun">,</span><span class="pln"> </span><span class="lit">373</span><span class="pun">,</span><span class="pln"> </span><span class="lit">379</span><span class="pun">,</span><span class="pln"> </span><span class="lit">383</span><span class="pun">,</span><span class="pln"> </span><span class="lit">389</span><span class="pun">,</span><span class="pln"> </span><span class="lit">397</span><span class="pun">,</span><span class="pln"> </span><span class="lit">401</span><span class="pun">,</span><span class="pln">
    </span><span class="lit">409</span><span class="pun">,</span><span class="pln"> </span><span class="lit">419</span><span class="pun">,</span><span class="pln"> </span><span class="lit">421</span><span class="pun">,</span><span class="pln"> </span><span class="lit">431</span><span class="pun">,</span><span class="pln"> </span><span class="lit">433</span><span class="pun">,</span><span class="pln"> </span><span class="lit">439</span><span class="pun">,</span><span class="pln"> </span><span class="lit">443</span><span class="pun">,</span><span class="pln"> </span><span class="lit">449</span><span class="pun">,</span><span class="pln"> </span><span class="lit">457</span><span class="pun">,</span><span class="pln"> </span><span class="lit">461</span><span class="pun">,</span><span class="pln"> </span><span class="lit">463</span><span class="pun">,</span><span class="pln"> </span><span class="lit">467</span><span class="pun">,</span><span class="pln"> </span><span class="lit">479</span><span class="pun">,</span><span class="pln"> </span><span class="lit">487</span><span class="pun">,</span><span class="pln"> </span><span class="lit">491</span><span class="pun">,</span><span class="pln">
    </span><span class="lit">499</span><span class="pun">,</span><span class="pln"> </span><span class="lit">503</span><span class="pun">,</span><span class="pln"> </span><span class="lit">509</span><span class="pun">,</span><span class="pln"> </span><span class="lit">521</span><span class="pun">,</span><span class="pln"> </span><span class="lit">523</span><span class="pun">,</span><span class="pln"> </span><span class="lit">541</span><span class="pun">,</span><span class="pln"> </span><span class="lit">547</span><span class="pun">,</span><span class="pln"> </span><span class="lit">557</span><span class="pun">,</span><span class="pln"> </span><span class="lit">563</span><span class="pun">,</span><span class="pln"> </span><span class="lit">569</span><span class="pun">,</span><span class="pln"> </span><span class="lit">571</span><span class="pun">,</span><span class="pln"> </span><span class="lit">577</span><span class="pun">,</span><span class="pln"> </span><span class="lit">587</span><span class="pun">,</span><span class="pln"> </span><span class="lit">593</span><span class="pun">,</span><span class="pln"> </span><span class="lit">599</span><span class="pun">,</span><span class="pln">
    </span><span class="lit">601</span><span class="pun">,</span><span class="pln"> </span><span class="lit">607</span><span class="pun">,</span><span class="pln"> </span><span class="lit">613</span><span class="pun">,</span><span class="pln"> </span><span class="lit">617</span><span class="pun">,</span><span class="pln"> </span><span class="lit">619</span><span class="pun">,</span><span class="pln"> </span><span class="lit">631</span><span class="pun">,</span><span class="pln"> </span><span class="lit">641</span><span class="pun">,</span><span class="pln"> </span><span class="lit">643</span><span class="pun">,</span><span class="pln"> </span><span class="lit">647</span><span class="pun">,</span><span class="pln"> </span><span class="lit">653</span><span class="pun">,</span><span class="pln"> </span><span class="lit">659</span><span class="pun">,</span><span class="pln"> </span><span class="lit">661</span><span class="pun">,</span><span class="pln"> </span><span class="lit">673</span><span class="pun">,</span><span class="pln"> </span><span class="lit">677</span><span class="pun">,</span><span class="pln"> </span><span class="lit">683</span><span class="pun">,</span><span class="pln">
    </span><span class="lit">691</span><span class="pun">,</span><span class="pln"> </span><span class="lit">701</span><span class="pun">,</span><span class="pln"> </span><span class="lit">709</span><span class="pun">,</span><span class="pln"> </span><span class="lit">719</span><span class="pun">,</span><span class="pln"> </span><span class="lit">727</span><span class="pun">,</span><span class="pln"> </span><span class="lit">733</span><span class="pun">,</span><span class="pln"> </span><span class="lit">739</span><span class="pun">,</span><span class="pln"> </span><span class="lit">743</span><span class="pun">,</span><span class="pln"> </span><span class="lit">751</span><span class="pun">,</span><span class="pln"> </span><span class="lit">757</span><span class="pun">,</span><span class="pln"> </span><span class="lit">761</span><span class="pun">,</span><span class="pln"> </span><span class="lit">769</span><span class="pun">,</span><span class="pln"> </span><span class="lit">773</span><span class="pun">,</span><span class="pln"> </span><span class="lit">787</span><span class="pun">,</span><span class="pln"> </span><span class="lit">797</span><span class="pun">,</span><span class="pln">
    </span><span class="lit">809</span><span class="pun">,</span><span class="pln"> </span><span class="lit">811</span><span class="pun">,</span><span class="pln"> </span><span class="lit">821</span><span class="pun">,</span><span class="pln"> </span><span class="lit">823</span><span class="pun">,</span><span class="pln"> </span><span class="lit">827</span><span class="pun">,</span><span class="pln"> </span><span class="lit">829</span><span class="pun">,</span><span class="pln"> </span><span class="lit">839</span><span class="pun">,</span><span class="pln"> </span><span class="lit">853</span><span class="pun">,</span><span class="pln"> </span><span class="lit">857</span><span class="pun">,</span><span class="pln"> </span><span class="lit">859</span><span class="pun">,</span><span class="pln"> </span><span class="lit">863</span><span class="pun">,</span><span class="pln"> </span><span class="lit">877</span><span class="pun">,</span><span class="pln"> </span><span class="lit">881</span><span class="pun">,</span><span class="pln"> </span><span class="lit">883</span><span class="pun">,</span><span class="pln"> </span><span class="lit">887</span><span class="pun">,</span><span class="pln">
    </span><span class="lit">907</span><span class="pun">,</span><span class="pln"> </span><span class="lit">911</span><span class="pun">,</span><span class="pln"> </span><span class="lit">919</span><span class="pun">,</span><span class="pln"> </span><span class="lit">929</span><span class="pun">,</span><span class="pln"> </span><span class="lit">937</span><span class="pun">,</span><span class="pln"> </span><span class="lit">941</span><span class="pun">,</span><span class="pln"> </span><span class="lit">947</span><span class="pun">,</span><span class="pln"> </span><span class="lit">953</span><span class="pun">,</span><span class="pln"> </span><span class="lit">967</span><span class="pun">,</span><span class="pln"> </span><span class="lit">971</span><span class="pun">,</span><span class="pln"> </span><span class="lit">977</span><span class="pun">,</span><span class="pln"> </span><span class="lit">983</span><span class="pun">,</span><span class="pln"> </span><span class="lit">991</span><span class="pun">,</span><span class="pln"> </span><span class="lit">997</span><span class="pun">)</span><span class="pln">

    wheel </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">)</span><span class="pln">
    const </span><span class="pun">=</span><span class="pln"> </span><span class="lit">30</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> N </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> N </span><span class="pun">&lt;=</span><span class="pln"> const</span><span class="pun">:</span><span class="pln">
        pos </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> __smallp</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> N</span><span class="pun">:</span><span class="pln">
            pos </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">__smallp</span><span class="pun">[:</span><span class="pln">pos</span><span class="pun">])</span><span class="pln">
    </span><span class="com"># make the offsets list</span><span class="pln">
    offsets </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">11</span><span class="pun">,</span><span class="pln"> </span><span class="lit">13</span><span class="pun">,</span><span class="pln"> </span><span class="lit">17</span><span class="pun">,</span><span class="pln"> </span><span class="lit">19</span><span class="pun">,</span><span class="pln"> </span><span class="lit">23</span><span class="pun">,</span><span class="pln"> </span><span class="lit">29</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="com"># prepare the list</span><span class="pln">
    p </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">]</span><span class="pln">
    dim </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> N </span><span class="pun">//</span><span class="pln"> const
    tk1  </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dim
    tk7  </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dim
    tk11 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dim
    tk13 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dim
    tk17 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dim
    tk19 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dim
    tk23 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dim
    tk29 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dim
    tk1</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="com"># help dictionary d</span><span class="pln">
    </span><span class="com"># d[a , b] = c  ==&gt; if I want to find the smallest useful multiple of (30*pos)+a</span><span class="pln">
    </span><span class="com"># on tkc, then I need the index given by the product of [(30*pos)+a][(30*pos)+b]</span><span class="pln">
    </span><span class="com"># in general. If b &lt; a, I need [(30*pos)+a][(30*(pos+1))+b]</span><span class="pln">
    d </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> offsets</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> y </span><span class="kwd">in</span><span class="pln"> offsets</span><span class="pun">:</span><span class="pln">
            res </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">*</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> const
            </span><span class="kwd">if</span><span class="pln"> res </span><span class="kwd">in</span><span class="pln"> offsets</span><span class="pun">:</span><span class="pln">
                d</span><span class="pun">[(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> res</span><span class="pun">)]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> y
    </span><span class="com"># another help dictionary: gives tkx calling tmptk[x]</span><span class="pln">
    tmptk </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">1</span><span class="pun">:</span><span class="pln">tk1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">:</span><span class="pln">tk7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">11</span><span class="pun">:</span><span class="pln">tk11</span><span class="pun">,</span><span class="pln"> </span><span class="lit">13</span><span class="pun">:</span><span class="pln">tk13</span><span class="pun">,</span><span class="pln"> </span><span class="lit">17</span><span class="pun">:</span><span class="pln">tk17</span><span class="pun">,</span><span class="pln"> </span><span class="lit">19</span><span class="pun">:</span><span class="pln">tk19</span><span class="pun">,</span><span class="pln"> </span><span class="lit">23</span><span class="pun">:</span><span class="pln">tk23</span><span class="pun">,</span><span class="pln"> </span><span class="lit">29</span><span class="pun">:</span><span class="pln">tk29</span><span class="pun">}</span><span class="pln">
    pos</span><span class="pun">,</span><span class="pln"> prime</span><span class="pun">,</span><span class="pln"> lastadded</span><span class="pun">,</span><span class="pln"> stop </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">ceil</span><span class="pun">(</span><span class="pln">sqrt</span><span class="pun">(</span><span class="pln">N</span><span class="pun">)))</span><span class="pln">
    </span><span class="com"># inner functions definition</span><span class="pln">
    </span><span class="kwd">def</span><span class="pln"> del_mult</span><span class="pun">(</span><span class="pln">tk</span><span class="pun">,</span><span class="pln"> start</span><span class="pun">,</span><span class="pln"> step</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> k </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">start</span><span class="pun">,</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">tk</span><span class="pun">),</span><span class="pln"> step</span><span class="pun">):</span><span class="pln">
            tk</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="com"># end of inner functions definition</span><span class="pln">
    cpos </span><span class="pun">=</span><span class="pln"> const </span><span class="pun">*</span><span class="pln"> pos
    </span><span class="kwd">while</span><span class="pln"> prime </span><span class="pun">&lt;</span><span class="pln"> stop</span><span class="pun">:</span><span class="pln">
        </span><span class="com"># 30k + 7</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk7</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln">
            prime </span><span class="pun">=</span><span class="pln"> cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">7</span><span class="pln">
            p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">prime</span><span class="pun">)</span><span class="pln">
            lastadded </span><span class="pun">=</span><span class="pln"> </span><span class="lit">7</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> off </span><span class="kwd">in</span><span class="pln"> offsets</span><span class="pun">:</span><span class="pln">
                tmp </span><span class="pun">=</span><span class="pln"> d</span><span class="pun">[(</span><span class="lit">7</span><span class="pun">,</span><span class="pln"> off</span><span class="pun">)]</span><span class="pln">
                start </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> off </span><span class="pun">==</span><span class="pln"> </span><span class="lit">7</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">prime </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">const </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> tmp </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">7</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> tmp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)//</span><span class="pln">const
                del_mult</span><span class="pun">(</span><span class="pln">tmptk</span><span class="pun">[</span><span class="pln">off</span><span class="pun">],</span><span class="pln"> start</span><span class="pun">,</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln">
        </span><span class="com"># 30k + 11</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk11</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln">
            prime </span><span class="pun">=</span><span class="pln"> cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">11</span><span class="pln">
            p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">prime</span><span class="pun">)</span><span class="pln">
            lastadded </span><span class="pun">=</span><span class="pln"> </span><span class="lit">11</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> off </span><span class="kwd">in</span><span class="pln"> offsets</span><span class="pun">:</span><span class="pln">
                tmp </span><span class="pun">=</span><span class="pln"> d</span><span class="pun">[(</span><span class="lit">11</span><span class="pun">,</span><span class="pln"> off</span><span class="pun">)]</span><span class="pln">
                start </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> off </span><span class="pun">==</span><span class="pln"> </span><span class="lit">11</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">prime </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">const </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> tmp </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">11</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> tmp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)//</span><span class="pln">const
                del_mult</span><span class="pun">(</span><span class="pln">tmptk</span><span class="pun">[</span><span class="pln">off</span><span class="pun">],</span><span class="pln"> start</span><span class="pun">,</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln">
        </span><span class="com"># 30k + 13</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk13</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln">
            prime </span><span class="pun">=</span><span class="pln"> cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">13</span><span class="pln">
            p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">prime</span><span class="pun">)</span><span class="pln">
            lastadded </span><span class="pun">=</span><span class="pln"> </span><span class="lit">13</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> off </span><span class="kwd">in</span><span class="pln"> offsets</span><span class="pun">:</span><span class="pln">
                tmp </span><span class="pun">=</span><span class="pln"> d</span><span class="pun">[(</span><span class="lit">13</span><span class="pun">,</span><span class="pln"> off</span><span class="pun">)]</span><span class="pln">
                start </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> off </span><span class="pun">==</span><span class="pln"> </span><span class="lit">13</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">prime </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">const </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> tmp </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">13</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> tmp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)//</span><span class="pln">const
                del_mult</span><span class="pun">(</span><span class="pln">tmptk</span><span class="pun">[</span><span class="pln">off</span><span class="pun">],</span><span class="pln"> start</span><span class="pun">,</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln">
        </span><span class="com"># 30k + 17</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk17</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln">
            prime </span><span class="pun">=</span><span class="pln"> cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">17</span><span class="pln">
            p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">prime</span><span class="pun">)</span><span class="pln">
            lastadded </span><span class="pun">=</span><span class="pln"> </span><span class="lit">17</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> off </span><span class="kwd">in</span><span class="pln"> offsets</span><span class="pun">:</span><span class="pln">
                tmp </span><span class="pun">=</span><span class="pln"> d</span><span class="pun">[(</span><span class="lit">17</span><span class="pun">,</span><span class="pln"> off</span><span class="pun">)]</span><span class="pln">
                start </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> off </span><span class="pun">==</span><span class="pln"> </span><span class="lit">17</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">prime </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">const </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> tmp </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">17</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> tmp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)//</span><span class="pln">const
                del_mult</span><span class="pun">(</span><span class="pln">tmptk</span><span class="pun">[</span><span class="pln">off</span><span class="pun">],</span><span class="pln"> start</span><span class="pun">,</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln">
        </span><span class="com"># 30k + 19</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk19</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln">
            prime </span><span class="pun">=</span><span class="pln"> cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">19</span><span class="pln">
            p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">prime</span><span class="pun">)</span><span class="pln">
            lastadded </span><span class="pun">=</span><span class="pln"> </span><span class="lit">19</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> off </span><span class="kwd">in</span><span class="pln"> offsets</span><span class="pun">:</span><span class="pln">
                tmp </span><span class="pun">=</span><span class="pln"> d</span><span class="pun">[(</span><span class="lit">19</span><span class="pun">,</span><span class="pln"> off</span><span class="pun">)]</span><span class="pln">
                start </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> off </span><span class="pun">==</span><span class="pln"> </span><span class="lit">19</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">prime </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">const </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> tmp </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">19</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> tmp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)//</span><span class="pln">const
                del_mult</span><span class="pun">(</span><span class="pln">tmptk</span><span class="pun">[</span><span class="pln">off</span><span class="pun">],</span><span class="pln"> start</span><span class="pun">,</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln">
        </span><span class="com"># 30k + 23</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk23</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln">
            prime </span><span class="pun">=</span><span class="pln"> cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">23</span><span class="pln">
            p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">prime</span><span class="pun">)</span><span class="pln">
            lastadded </span><span class="pun">=</span><span class="pln"> </span><span class="lit">23</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> off </span><span class="kwd">in</span><span class="pln"> offsets</span><span class="pun">:</span><span class="pln">
                tmp </span><span class="pun">=</span><span class="pln"> d</span><span class="pun">[(</span><span class="lit">23</span><span class="pun">,</span><span class="pln"> off</span><span class="pun">)]</span><span class="pln">
                start </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> off </span><span class="pun">==</span><span class="pln"> </span><span class="lit">23</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">prime </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">const </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> tmp </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">23</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> tmp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)//</span><span class="pln">const
                del_mult</span><span class="pun">(</span><span class="pln">tmptk</span><span class="pun">[</span><span class="pln">off</span><span class="pun">],</span><span class="pln"> start</span><span class="pun">,</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln">
        </span><span class="com"># 30k + 29</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk29</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln">
            prime </span><span class="pun">=</span><span class="pln"> cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">29</span><span class="pln">
            p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">prime</span><span class="pun">)</span><span class="pln">
            lastadded </span><span class="pun">=</span><span class="pln"> </span><span class="lit">29</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> off </span><span class="kwd">in</span><span class="pln"> offsets</span><span class="pun">:</span><span class="pln">
                tmp </span><span class="pun">=</span><span class="pln"> d</span><span class="pun">[(</span><span class="lit">29</span><span class="pun">,</span><span class="pln"> off</span><span class="pun">)]</span><span class="pln">
                start </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> off </span><span class="pun">==</span><span class="pln"> </span><span class="lit">29</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">prime </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">const </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> tmp </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">29</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> tmp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)//</span><span class="pln">const
                del_mult</span><span class="pun">(</span><span class="pln">tmptk</span><span class="pun">[</span><span class="pln">off</span><span class="pun">],</span><span class="pln"> start</span><span class="pun">,</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln">
        </span><span class="com"># now we go back to top tk1, so we need to increase pos by 1</span><span class="pln">
        pos </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        cpos </span><span class="pun">=</span><span class="pln"> const </span><span class="pun">*</span><span class="pln"> pos
        </span><span class="com"># 30k + 1</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk1</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln">
            prime </span><span class="pun">=</span><span class="pln"> cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">prime</span><span class="pun">)</span><span class="pln">
            lastadded </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> off </span><span class="kwd">in</span><span class="pln"> offsets</span><span class="pun">:</span><span class="pln">
                tmp </span><span class="pun">=</span><span class="pln"> d</span><span class="pun">[(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> off</span><span class="pun">)]</span><span class="pln">
                start </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> off </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">prime </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">const </span><span class="pun">*</span><span class="pln"> pos </span><span class="pun">+</span><span class="pln"> tmp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">)//</span><span class="pln">const
                del_mult</span><span class="pun">(</span><span class="pln">tmptk</span><span class="pun">[</span><span class="pln">off</span><span class="pun">],</span><span class="pln"> start</span><span class="pun">,</span><span class="pln"> prime</span><span class="pun">)</span><span class="pln">
    </span><span class="com"># time to add remaining primes</span><span class="pln">
    </span><span class="com"># if lastadded == 1, remove last element and start adding them from tk1</span><span class="pln">
    </span><span class="com"># this way we don't need an "if" within the last while</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> lastadded </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln">
        p</span><span class="pun">.</span><span class="pln">pop</span><span class="pun">()</span><span class="pln">
    </span><span class="com"># now complete for every other possible prime</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> pos </span><span class="pun">&lt;</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">tk1</span><span class="pun">):</span><span class="pln">
        cpos </span><span class="pun">=</span><span class="pln"> const </span><span class="pun">*</span><span class="pln"> pos
        </span><span class="kwd">if</span><span class="pln"> tk1</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk7</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">7</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk11</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">11</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk13</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">13</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk17</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">17</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk19</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">19</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk23</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">23</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> tk29</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]:</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">cpos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">29</span><span class="pun">)</span><span class="pln">
        pos </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="com"># remove exceeding if present</span><span class="pln">
    pos </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> N</span><span class="pun">:</span><span class="pln">
        pos </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> pos </span><span class="pun">&lt;</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">del</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">+</span><span class="lit">1</span><span class="pun">:]</span><span class="pln">
    </span><span class="com"># return p list</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> p

</span><span class="kwd">def</span><span class="pln"> sieveOfEratosthenes</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    </span><span class="str">"""sieveOfEratosthenes(n): return the list of the primes &lt; n."""</span><span class="pln">
    </span><span class="com"># Code from: &lt;dickinsm@gmail.com&gt;, Nov 30 2006</span><span class="pln">
    </span><span class="com"># http://groups.google.com/group/comp.lang.python/msg/f1f10ced88c68c2d</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> n </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
    sieve </span><span class="pun">=</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    top </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">sieve</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> si </span><span class="kwd">in</span><span class="pln"> sieve</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> si</span><span class="pun">:</span><span class="pln">
            bottom </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">si</span><span class="pun">*</span><span class="pln">si </span><span class="pun">-</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">//</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> bottom </span><span class="pun">&gt;=</span><span class="pln"> top</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">break</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">bottom</span><span class="pun">::</span><span class="pln">si</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">-((</span><span class="pln">bottom </span><span class="pun">-</span><span class="pln"> top</span><span class="pun">)</span><span class="pln"> </span><span class="pun">//</span><span class="pln"> si</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">[</span><span class="pln">el </span><span class="kwd">for</span><span class="pln"> el </span><span class="kwd">in</span><span class="pln"> sieve </span><span class="kwd">if</span><span class="pln"> el</span><span class="pun">]</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> sieveOfAtkin</span><span class="pun">(</span><span class="pln">end</span><span class="pun">):</span><span class="pln">
    </span><span class="str">"""sieveOfAtkin(end): return a list of all the prime numbers &lt;end
    using the Sieve of Atkin."""</span><span class="pln">
    </span><span class="com"># Code by Steve Krenzel, &lt;Sgk284@gmail.com&gt;, improved</span><span class="pln">
    </span><span class="com"># Code: https://web.archive.org/web/20080324064651/http://krenzel.info/?p=83</span><span class="pln">
    </span><span class="com"># Info: http://en.wikipedia.org/wiki/Sieve_of_Atkin</span><span class="pln">
    </span><span class="kwd">assert</span><span class="pln"> end </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    lng </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">end</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">//</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    sieve </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">False</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lng </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">

    x_max</span><span class="pun">,</span><span class="pln"> x2</span><span class="pun">,</span><span class="pln"> xd </span><span class="pun">=</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">sqrt</span><span class="pun">((</span><span class="pln">end</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)/</span><span class="lit">4.0</span><span class="pun">)),</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> xd </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">*</span><span class="pln">x_max </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">):</span><span class="pln">
        x2 </span><span class="pun">+=</span><span class="pln"> xd
        y_max </span><span class="pun">=</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">sqrt</span><span class="pun">(</span><span class="pln">end</span><span class="pun">-</span><span class="pln">x2</span><span class="pun">))</span><span class="pln">
        n</span><span class="pun">,</span><span class="pln"> n_diff </span><span class="pun">=</span><span class="pln"> x2 </span><span class="pun">+</span><span class="pln"> y_max</span><span class="pun">*</span><span class="pln">y_max</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y_max </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">):</span><span class="pln">
            n </span><span class="pun">-=</span><span class="pln"> n_diff
            n_diff </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> d </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">((</span><span class="pln">n_diff </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">8</span><span class="pun">):</span><span class="pln">
            m </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">%</span><span class="pln"> </span><span class="lit">12</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> m </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> m </span><span class="pun">==</span><span class="pln"> </span><span class="lit">5</span><span class="pun">:</span><span class="pln">
                m </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
                sieve</span><span class="pun">[</span><span class="pln">m</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">m</span><span class="pun">]</span><span class="pln">
            n </span><span class="pun">-=</span><span class="pln"> d

    x_max</span><span class="pun">,</span><span class="pln"> x2</span><span class="pun">,</span><span class="pln"> xd </span><span class="pun">=</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">sqrt</span><span class="pun">((</span><span class="pln">end</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">3.0</span><span class="pun">)),</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> xd </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> x_max </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">):</span><span class="pln">
        x2 </span><span class="pun">+=</span><span class="pln"> xd
        y_max </span><span class="pun">=</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">sqrt</span><span class="pun">(</span><span class="pln">end</span><span class="pun">-</span><span class="pln">x2</span><span class="pun">))</span><span class="pln">
        n</span><span class="pun">,</span><span class="pln"> n_diff </span><span class="pun">=</span><span class="pln"> x2 </span><span class="pun">+</span><span class="pln"> y_max</span><span class="pun">*</span><span class="pln">y_max</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y_max </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pun">(</span><span class="pln">n </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">):</span><span class="pln">
            n </span><span class="pun">-=</span><span class="pln"> n_diff
            n_diff </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> d </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">((</span><span class="pln">n_diff </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">8</span><span class="pun">):</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> n </span><span class="pun">%</span><span class="pln"> </span><span class="lit">12</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">7</span><span class="pun">:</span><span class="pln">
                m </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
                sieve</span><span class="pun">[</span><span class="pln">m</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">m</span><span class="pun">]</span><span class="pln">
            n </span><span class="pun">-=</span><span class="pln"> d

    x_max</span><span class="pun">,</span><span class="pln"> y_min</span><span class="pun">,</span><span class="pln"> x2</span><span class="pun">,</span><span class="pln"> xd </span><span class="pun">=</span><span class="pln"> int</span><span class="pun">((</span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> sqrt</span><span class="pun">(</span><span class="lit">4</span><span class="pun">-</span><span class="lit">8</span><span class="pun">*(</span><span class="lit">1</span><span class="pun">-</span><span class="pln">end</span><span class="pun">)))/</span><span class="lit">4</span><span class="pun">),</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> x_max </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        x2 </span><span class="pun">+=</span><span class="pln"> xd
        xd </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">6</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> x2 </span><span class="pun">&gt;=</span><span class="pln"> end</span><span class="pun">:</span><span class="pln"> y_min </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(((</span><span class="pln">int</span><span class="pun">(</span><span class="pln">ceil</span><span class="pun">(</span><span class="pln">sqrt</span><span class="pun">(</span><span class="pln">x2 </span><span class="pun">-</span><span class="pln"> end</span><span class="pun">)))</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        n</span><span class="pun">,</span><span class="pln"> n_diff </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">x</span><span class="pun">*</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(((</span><span class="pln">x</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> d </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">n_diff</span><span class="pun">,</span><span class="pln"> y_min</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">8</span><span class="pun">):</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> n </span><span class="pun">%</span><span class="pln"> </span><span class="lit">12</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">11</span><span class="pun">:</span><span class="pln">
                m </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
                sieve</span><span class="pun">[</span><span class="pln">m</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">m</span><span class="pun">]</span><span class="pln">
            n </span><span class="pun">+=</span><span class="pln"> d

    primes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">]</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> end </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> primes</span><span class="pun">[:</span><span class="pln">max</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln">end</span><span class="pun">-</span><span class="lit">2</span><span class="pun">)]</span><span class="pln">

    </span><span class="kwd">for</span><span class="pln"> n </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">5</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="pln">int</span><span class="pun">(</span><span class="pln">sqrt</span><span class="pun">(</span><span class="pln">end</span><span class="pun">))+</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
            primes</span><span class="pun">.</span><span class="pln">append</span><span class="pun">((</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            aux </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            aux </span><span class="pun">*=</span><span class="pln"> aux
            </span><span class="kwd">for</span><span class="pln"> k </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">aux</span><span class="pun">,</span><span class="pln"> end</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> aux</span><span class="pun">):</span><span class="pln">
                sieve</span><span class="pun">[</span><span class="pln">k </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">

    s  </span><span class="pun">=</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">sqrt</span><span class="pun">(</span><span class="pln">end</span><span class="pun">))</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> s  </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
        s </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    primes</span><span class="pun">.</span><span class="pln">extend</span><span class="pun">([</span><span class="pln">i </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">s</span><span class="pun">,</span><span class="pln"> end</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]])</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> primes

</span><span class="kwd">def</span><span class="pln"> ambi_sieve_plain</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    s </span><span class="pun">=</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> m </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">**</span><span class="lit">0.5</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">):</span><span class="pln"> 
        </span><span class="kwd">if</span><span class="pln"> s</span><span class="pun">[(</span><span class="pln">m</span><span class="pun">-</span><span class="lit">3</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">]:</span><span class="pln"> 
            </span><span class="kwd">for</span><span class="pln"> t </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">((</span><span class="pln">m</span><span class="pun">*</span><span class="pln">m</span><span class="pun">-</span><span class="lit">3</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">,(</span><span class="pln">n</span><span class="pun">&gt;&gt;</span><span class="lit">1</span><span class="pun">)-</span><span class="lit">1</span><span class="pun">,</span><span class="pln">m</span><span class="pun">):</span><span class="pln">
                s</span><span class="pun">[</span><span class="pln">t</span><span class="pun">]=</span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">]+[</span><span class="pln">t </span><span class="kwd">for</span><span class="pln"> t </span><span class="kwd">in</span><span class="pln"> s </span><span class="kwd">if</span><span class="pln"> t</span><span class="pun">&gt;</span><span class="lit">0</span><span class="pun">]</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> sundaram3</span><span class="pun">(</span><span class="pln">max_n</span><span class="pun">):</span><span class="pln">
    </span><span class="com"># https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/2073279#2073279</span><span class="pln">
    numbers </span><span class="pun">=</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> max_n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    half </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">max_n</span><span class="pun">)//</span><span class="lit">2</span><span class="pln">
    initial </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln">

    </span><span class="kwd">for</span><span class="pln"> step </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> max_n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">initial</span><span class="pun">,</span><span class="pln"> half</span><span class="pun">,</span><span class="pln"> step</span><span class="pun">):</span><span class="pln">
            numbers</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
        initial </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*(</span><span class="pln">step</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> initial </span><span class="pun">&gt;</span><span class="pln"> half</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> filter</span><span class="pun">(</span><span class="kwd">None</span><span class="pun">,</span><span class="pln"> numbers</span><span class="pun">)</span><span class="pln">

</span><span class="com">################################################################################</span><span class="pln">
</span><span class="com"># Using Numpy:</span><span class="pln">
</span><span class="kwd">def</span><span class="pln"> ambi_sieve</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    </span><span class="com"># http://tommih.blogspot.com/2009/04/fast-prime-number-generator.html</span><span class="pln">
    s </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">arange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> m </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">n </span><span class="pun">**</span><span class="pln"> </span><span class="lit">0.5</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">):</span><span class="pln"> 
        </span><span class="kwd">if</span><span class="pln"> s</span><span class="pun">[(</span><span class="pln">m</span><span class="pun">-</span><span class="lit">3</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">]:</span><span class="pln"> 
            s</span><span class="pun">[(</span><span class="pln">m</span><span class="pun">*</span><span class="pln">m</span><span class="pun">-</span><span class="lit">3</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">::</span><span class="pln">m</span><span class="pun">]=</span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">r_</span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">s</span><span class="pun">&gt;</span><span class="lit">0</span><span class="pun">]]</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> primesfrom3to</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    </span><span class="com"># https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188</span><span class="pln">
    </span><span class="str">""" Returns a array of primes, p &lt; n """</span><span class="pln">
    </span><span class="kwd">assert</span><span class="pln"> n</span><span class="pun">&gt;=</span><span class="lit">2</span><span class="pln">
    sieve </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">ones</span><span class="pun">(</span><span class="pln">n</span><span class="pun">/</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> dtype</span><span class="pun">=</span><span class="pln">np</span><span class="pun">.</span><span class="pln">bool</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">**</span><span class="lit">0.5</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">/</span><span class="lit">2</span><span class="pun">]:</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">/</span><span class="lit">2</span><span class="pun">::</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">r_</span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*</span><span class="pln">np</span><span class="pun">.</span><span class="pln">nonzero</span><span class="pun">(</span><span class="pln">sieve</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">::]+</span><span class="lit">1</span><span class="pun">]</span><span class="pln">    

</span><span class="kwd">def</span><span class="pln"> primesfrom2to</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    </span><span class="com"># https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188</span><span class="pln">
    </span><span class="str">""" Input n&gt;=6, Returns a array of primes, 2 &lt;= p &lt; n """</span><span class="pln">
    sieve </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">ones</span><span class="pun">(</span><span class="pln">n</span><span class="pun">/</span><span class="lit">3</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">%</span><span class="lit">6</span><span class="pun">==</span><span class="lit">2</span><span class="pun">),</span><span class="pln"> dtype</span><span class="pun">=</span><span class="pln">np</span><span class="pun">.</span><span class="pln">bool</span><span class="pun">)</span><span class="pln">
    sieve</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">**</span><span class="lit">0.5</span><span class="pun">)/</span><span class="lit">3</span><span class="pun">+</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
            k</span><span class="pun">=</span><span class="lit">3</span><span class="pun">*</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">      </span><span class="pun">((</span><span class="pln">k</span><span class="pun">*</span><span class="pln">k</span><span class="pun">)/</span><span class="lit">3</span><span class="pun">)</span><span class="pln">      </span><span class="pun">::</span><span class="lit">2</span><span class="pun">*</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
            sieve</span><span class="pun">[(</span><span class="pln">k</span><span class="pun">*</span><span class="pln">k</span><span class="pun">+</span><span class="lit">4</span><span class="pun">*</span><span class="pln">k</span><span class="pun">-</span><span class="lit">2</span><span class="pun">*</span><span class="pln">k</span><span class="pun">*(</span><span class="pln">i</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">))/</span><span class="lit">3</span><span class="pun">::</span><span class="lit">2</span><span class="pun">*</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">r_</span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,((</span><span class="lit">3</span><span class="pun">*</span><span class="pln">np</span><span class="pun">.</span><span class="pln">nonzero</span><span class="pun">(</span><span class="pln">sieve</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">]+</span><span class="lit">1</span><span class="pun">)|</span><span class="lit">1</span><span class="pun">)]</span><span class="pln">

</span><span class="kwd">if</span><span class="pln"> __name__</span><span class="pun">==</span><span class="str">'__main__'</span><span class="pun">:</span><span class="pln">
    </span><span class="kwd">import</span><span class="pln"> itertools
    </span><span class="kwd">import</span><span class="pln"> sys

    </span><span class="kwd">def</span><span class="pln"> test</span><span class="pun">(</span><span class="pln">f1</span><span class="pun">,</span><span class="pln">f2</span><span class="pun">,</span><span class="pln">num</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'Testing {f1} and {f2} return same results'</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">
            f1</span><span class="pun">=</span><span class="pln">f1</span><span class="pun">.</span><span class="pln">func_name</span><span class="pun">,</span><span class="pln">
            f2</span><span class="pun">=</span><span class="pln">f2</span><span class="pun">.</span><span class="pln">func_name</span><span class="pun">))</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> all</span><span class="pun">([</span><span class="pln">a</span><span class="pun">==</span><span class="pln">b </span><span class="kwd">for</span><span class="pln"> a</span><span class="pun">,</span><span class="pln">b </span><span class="kwd">in</span><span class="pln"> itertools</span><span class="pun">.</span><span class="pln">izip_longest</span><span class="pun">(</span><span class="pln">f1</span><span class="pun">(</span><span class="pln">num</span><span class="pun">),</span><span class="pln">f2</span><span class="pun">(</span><span class="pln">num</span><span class="pun">))]):</span><span class="pln">
            sys</span><span class="pun">.</span><span class="pln">exit</span><span class="pun">(</span><span class="str">"Error: %s(%s) != %s(%s)"</span><span class="pun">%(</span><span class="pln">f1</span><span class="pun">.</span><span class="pln">func_name</span><span class="pun">,</span><span class="pln">num</span><span class="pun">,</span><span class="pln">f2</span><span class="pun">.</span><span class="pln">func_name</span><span class="pun">,</span><span class="pln">num</span><span class="pun">))</span><span class="pln">

    n</span><span class="pun">=</span><span class="lit">1000000</span><span class="pln">
    test</span><span class="pun">(</span><span class="pln">sieveOfAtkin</span><span class="pun">,</span><span class="pln">sieveOfEratosthenes</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
    test</span><span class="pun">(</span><span class="pln">sieveOfAtkin</span><span class="pun">,</span><span class="pln">ambi_sieve</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
    test</span><span class="pun">(</span><span class="pln">sieveOfAtkin</span><span class="pun">,</span><span class="pln">ambi_sieve_plain</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> 
    test</span><span class="pun">(</span><span class="pln">sieveOfAtkin</span><span class="pun">,</span><span class="pln">sundaram3</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
    test</span><span class="pun">(</span><span class="pln">sieveOfAtkin</span><span class="pun">,</span><span class="pln">sieve_wheel_30</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
    test</span><span class="pun">(</span><span class="pln">sieveOfAtkin</span><span class="pun">,</span><span class="pln">primesfrom3to</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
    test</span><span class="pun">(</span><span class="pln">sieveOfAtkin</span><span class="pun">,</span><span class="pln">primesfrom2to</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
    test</span><span class="pun">(</span><span class="pln">sieveOfAtkin</span><span class="pun">,</span><span class="pln">rwh_primes</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
    test</span><span class="pun">(</span><span class="pln">sieveOfAtkin</span><span class="pun">,</span><span class="pln">rwh_primes1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln">         
    test</span><span class="pun">(</span><span class="pln">sieveOfAtkin</span><span class="pun">,</span><span class="pln">rwh_primes2</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span></code></pre>

<p>Running the script tests that all implementations give the same result.</p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/2068548" title="short permalink to this answer" class="short-link" id="link-post-2068548">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/2068548/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info user-hover">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/2068548/revisions" title="show all edits to this post">edited <span title="2017-05-23 11:55:05Z" class="relativetime">May 23 at 11:55</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/-1/community"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/a007be5a61f6aa8f3e85ae2fc18dd66e" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/-1/community">Community</a><span class="mod-flair" title="moderator">♦</span>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">1</span><span title="1 silver badge"><span class="badge2"></span><span class="badgecount">1</span></span>
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-01-15 00:19:09Z" class="relativetime">Jan 15 '10 at 0:19</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/190597/unutbu"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/aabc98d5c6482ca0e1405ec97710f30a" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/190597/unutbu">unutbu</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 436,169" dir="ltr">436k</span><span title="68 gold badges"><span class="badge1"></span><span class="badgecount">68</span></span><span title="866 silver badges"><span class="badge2"></span><span class="badgecount">866</span></span><span title="973 bronze badges"><span class="badge3"></span><span class="badgecount">973</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2068548" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="24" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-1998287" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">That's not pure Python, but it's the fastest version so far. thanks!</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/230636/jbochi" title="16,903 reputation" class="comment-user owner">jbochi</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment1998287_2068548"><span title="2010-01-15 01:11:56Z" class="relativetime-clean">Jan 15 '10 at 1:11</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-1998429" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">2</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">If you're interested in non-pure-Python code, then you should check out <code>gmpy</code> -- it has pretty good support for primes, via the <code>next_prime</code> method of its <code>mpz</code> type.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/95810/alex-martelli" title="525,912 reputation" class="comment-user">Alex Martelli</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment1998429_2068548"><span title="2010-01-15 01:41:09Z" class="relativetime-clean">Jan 15 '10 at 1:41</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-2000472" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">just for correctness, the code example should have <code>import numpy as np</code></span>
                    –&nbsp;<a href="https://stackoverflow.com/users/180174/kimvais" title="20,254 reputation" class="comment-user">Kimvais</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2000472_2068548"><span title="2010-01-15 10:15:53Z" class="relativetime-clean">Jan 15 '10 at 10:15</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-2032467" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy"><code>int(n ** 0.5)</code> should be <code>int(math.ceil(n ** 0.5))</code> or <code>int(n ** 0.5) + 1</code>.  <code>ambi_sieve(10)</code> gives wrong answer otherwise.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/226621/alok-singhal" title="54,953 reputation" class="comment-user">Alok Singhal</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2032467_2068548"><span title="2010-01-20 03:48:47Z" class="relativetime-clean">Jan 20 '10 at 3:48</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-50624486" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">If someone wonders how the functions here fare against <a href="https://en.wikibooks.org/wiki/Efficient_Prime_Number_Generating_Algorithms" rel="nofollow noreferrer">PG7.8 of Wikibooks</a> for pure python without psyco nor pypy: for n = 1000000: PG7.8: 4.93 s per loop ; rwh_primes1: 69 ms per loop ; rwh_primes2: 57.1 ms per loop</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/1121352/gaborous" title="5,470 reputation" class="comment-user">gaborous</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment50624486_2068548"><span title="2015-07-09 13:19:09Z" class="relativetime-clean">Jul 9 '15 at 13:19</span></a></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2068548" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link  dno" title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."></a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link " title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick="">show <b>24</b> more comments</a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>
<script>
                var ados = ados || {}; ados.run = ados.run || [];
                ados.run.push(function () { ados_add_placement(22,8277,"adzerk1497483724",4).setZone(44); });
            </script>
            <div class="everyonelovesstackoverflow adzerk-vote" id="adzerk1497483724"><iframe id="ados_frame_adzerk1497483724_6204676" frameborder="0" scrolling="no" height="90" width="728" src="./python - Fastest way to list all primes below N - Stack Overflow_files/saved_resource.html"></iframe><div class="adzerk-vote-controls" style="display:none;"><div class="adzerk-vote-option adzerk-vote-up"><div class="adzerk-vote-icon"></div></div><div class="adzerk-vote-option adzerk-vote-down"><div class="adzerk-vote-icon"></div></div></div><div class="adzerk-vote-survey" style="display:none;"><form><span>No problem. We won't show you that ad again. Why didn't you like it?</span><ul><li><label><input type="radio" value="12" name="downvoteReason">Uninteresting</label></li><li><label><input type="radio" value="13" name="downvoteReason">Misleading</label></li><li><label><input type="radio" value="14" name="downvoteReason">Offensive</label></li><li><label><input type="radio" value="15" name="downvoteReason">Repetitive</label></li><li><label><input type="radio" value="16" name="downvoteReason">Other</label></li></ul><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" class="adzerk-vote-cancel">Oops! I didn't mean to do this.</a></form></div><img height="0px" width="0px" border="0" style="position: absolute; display: none !important;" src="https://engine.adzerk.net/i.gif?e=eyJhdiI6MTE4ODQ3LCJhdCI6NCwiYnQiOjAsImNtIjo2MDU5NjAsImNoIjoxMTc4LCJjayI6e30sImNyIjozNTIwNzczLCJkaSI6IjBmMDJmMGEyZTYzMjQxNTA4YzgwZjY3NzZlNzJlYWI0IiwiZG0iOjEsImZjIjo2MTAwNzQxLCJmbCI6NjIwNDY3NiwiaXAiOiI4NC4yMjkuMTA1LjIwIiwia3ciOiJweXRob24sbWF0aCxvcHRpbWl6YXRpb24scHJpbWVzLHgtY3Jvc3Mtc2l0ZS11bml4LnN0YWNrZXhjaGFuZ2UuY29tIiwibnciOjIyLCJwYyI6MCwiZHAiOjEuNjUzLCJlYyI6MCwicHIiOjExNDEyNCwicnQiOjIsInJmIjoiaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjA2ODM3Mi9mYXN0ZXN0LXdheS10by1saXN0LWFsbC1wcmltZXMtYmVsb3ctbiIsInNhIjoiMyIsInNiIjoiaS0wZjUyZjBlMGU3MmI5YjU0NCIsInNwIjoxODAxMCwic3QiOjgyNzcsInVrIjoidWUxLTZhYWQ1OWExYTg0ODRjZDliNDA1MGU3N2FiOGZjY2M4Iiwiem4iOjQ0LCJ0cyI6MTUwMDE1MDUwNjg5NCwiYmYiOnRydWUsInBuIjoiYWR6ZXJrMTQ5NzQ4MzcyNCIsImJyIjoxLCJmcSI6MH0&amp;s=d8nBdvoFg341ybQoMCEKa8_ikTg"></div>
  
<a name="3035188"></a>
<div id="answer-3035188" class="answer" data-answerid="3035188" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="3035188">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">94</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>Related question(dealing with primes generators &amp; including benchmarks):<br>
<a href="https://stackoverflow.com/questions/2897297/speed-up-bitstring-bit-operations-in-python">Speed up bitstring/bit operations in Python?</a>  </p>

<p>Faster &amp; more memory-wise pure Python code:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">def</span><span class="pln"> primes</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    </span><span class="str">""" Returns  a list of primes &lt; n """</span><span class="pln">
    sieve </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">**</span><span class="lit">0.5</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">::</span><span class="lit">2</span><span class="pun">*</span><span class="pln">i</span><span class="pun">]=[</span><span class="kwd">False</span><span class="pun">]*((</span><span class="pln">n</span><span class="pun">-</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)/(</span><span class="lit">2</span><span class="pun">*</span><span class="pln">i</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">[</span><span class="pln">i </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span></code></pre>

<p>or starting with half sieve</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">def</span><span class="pln"> primes1</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    </span><span class="str">""" Returns  a list of primes &lt; n """</span><span class="pln">
    sieve </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">/</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">**</span><span class="lit">0.5</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">/</span><span class="lit">2</span><span class="pun">]:</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">/</span><span class="lit">2</span><span class="pun">::</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">False</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">((</span><span class="pln">n</span><span class="pun">-</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)/(</span><span class="lit">2</span><span class="pun">*</span><span class="pln">i</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">*</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">/</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span></code></pre>

<p>Faster &amp; more memory-wise numpy code:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">import</span><span class="pln"> numpy
</span><span class="kwd">def</span><span class="pln"> primesfrom3to</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    </span><span class="str">""" Returns a array of primes, 3 &lt;= p &lt; n """</span><span class="pln">
    sieve </span><span class="pun">=</span><span class="pln"> numpy</span><span class="pun">.</span><span class="pln">ones</span><span class="pun">(</span><span class="pln">n</span><span class="pun">/</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> dtype</span><span class="pun">=</span><span class="pln">numpy</span><span class="pun">.</span><span class="pln">bool</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">**</span><span class="lit">0.5</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">/</span><span class="lit">2</span><span class="pun">]:</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">/</span><span class="lit">2</span><span class="pun">::</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*</span><span class="pln">numpy</span><span class="pun">.</span><span class="pln">nonzero</span><span class="pun">(</span><span class="pln">sieve</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">::]+</span><span class="lit">1</span></code></pre>

<p>a faster variation starting with a third of a sieve:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">import</span><span class="pln"> numpy
</span><span class="kwd">def</span><span class="pln"> primesfrom2to</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    </span><span class="str">""" Input n&gt;=6, Returns a array of primes, 2 &lt;= p &lt; n """</span><span class="pln">
    sieve </span><span class="pun">=</span><span class="pln"> numpy</span><span class="pun">.</span><span class="pln">ones</span><span class="pun">(</span><span class="pln">n</span><span class="pun">/</span><span class="lit">3</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">%</span><span class="lit">6</span><span class="pun">==</span><span class="lit">2</span><span class="pun">),</span><span class="pln"> dtype</span><span class="pun">=</span><span class="pln">numpy</span><span class="pun">.</span><span class="pln">bool</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">**</span><span class="lit">0.5</span><span class="pun">)/</span><span class="lit">3</span><span class="pun">+</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
            k</span><span class="pun">=</span><span class="lit">3</span><span class="pun">*</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">       k</span><span class="pun">*</span><span class="pln">k</span><span class="pun">/</span><span class="lit">3</span><span class="pln">     </span><span class="pun">::</span><span class="lit">2</span><span class="pun">*</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">k</span><span class="pun">*(</span><span class="pln">k</span><span class="pun">-</span><span class="lit">2</span><span class="pun">*(</span><span class="pln">i</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)+</span><span class="lit">4</span><span class="pun">)/</span><span class="lit">3</span><span class="pun">::</span><span class="lit">2</span><span class="pun">*</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> numpy</span><span class="pun">.</span><span class="pln">r_</span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,((</span><span class="lit">3</span><span class="pun">*</span><span class="pln">numpy</span><span class="pun">.</span><span class="pln">nonzero</span><span class="pun">(</span><span class="pln">sieve</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">:]+</span><span class="lit">1</span><span class="pun">)|</span><span class="lit">1</span><span class="pun">)]</span></code></pre>

<p>A (hard-to-code) pure-python version of the above code would be:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">def</span><span class="pln"> primes2</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    </span><span class="str">""" Input n&gt;=6, Returns a list of primes, 2 &lt;= p &lt; n """</span><span class="pln">
    n</span><span class="pun">,</span><span class="pln"> correction </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">-</span><span class="pln">n</span><span class="pun">%</span><span class="lit">6</span><span class="pun">+</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">-(</span><span class="pln">n</span><span class="pun">%</span><span class="lit">6</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    sieve </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">/</span><span class="lit">3</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">**</span><span class="lit">0.5</span><span class="pun">)/</span><span class="lit">3</span><span class="pun">+</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
        k</span><span class="pun">=</span><span class="lit">3</span><span class="pun">*</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pln">
        sieve</span><span class="pun">[</span><span class="pln">      k</span><span class="pun">*</span><span class="pln">k</span><span class="pun">/</span><span class="lit">3</span><span class="pln">      </span><span class="pun">::</span><span class="lit">2</span><span class="pun">*</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">False</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">((</span><span class="pln">n</span><span class="pun">/</span><span class="lit">6</span><span class="pun">-</span><span class="pln">k</span><span class="pun">*</span><span class="pln">k</span><span class="pun">/</span><span class="lit">6</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)/</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        sieve</span><span class="pun">[</span><span class="pln">k</span><span class="pun">*(</span><span class="pln">k</span><span class="pun">-</span><span class="lit">2</span><span class="pun">*(</span><span class="pln">i</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)+</span><span class="lit">4</span><span class="pun">)/</span><span class="lit">3</span><span class="pun">::</span><span class="lit">2</span><span class="pun">*</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">False</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">((</span><span class="pln">n</span><span class="pun">/</span><span class="lit">6</span><span class="pun">-</span><span class="pln">k</span><span class="pun">*(</span><span class="pln">k</span><span class="pun">-</span><span class="lit">2</span><span class="pun">*(</span><span class="pln">i</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)+</span><span class="lit">4</span><span class="pun">)/</span><span class="lit">6</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)/</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">[</span><span class="lit">3</span><span class="pun">*</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">/</span><span class="lit">3</span><span class="pun">-</span><span class="pln">correction</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span></code></pre>

<p>Unfortunately pure-python don't adopt the simpler and faster numpy way of doing Assignment, and calling len() inside the loop as in <code>[False]*len(sieve[((k*k)/3)::2*k])</code> is too slow. So i had to improvise to correct input (&amp; avoid more math) and do some extreme (&amp; painful) math-magic.<br>
  Personally i think it is a shame that numpy (which is so widely used) is not part of python standard library(2 years after python 3 release &amp; no numpy compatibility), and that the improvements in syntax and speed seem to be completely overlooked by python developers.</p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/3035188" title="short permalink to this answer" class="short-link" id="link-post-3035188">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/3035188/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/3035188/revisions" title="show all edits to this post">edited <span title="2017-05-23 12:34:39Z" class="relativetime">May 23 at 12:34</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info">
    <div class="user-details">
        <span class="community-wiki" title="This post is community owned as of Jul 27 &#39;10 at 1:53. Votes do not generate reputation, and it can be edited by users with 100 rep">
            community wiki
        </span>
    </div><br>
    <div class="user-details">
        <a id="history-3035188" href="https://stackoverflow.com/posts/3035188/revisions" title="show revision history for this post">
        14 revs, 2 users 98%<br></a><a href="https://stackoverflow.com/users/350331">Robert William Hanks</a>
        
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-3035188" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="6" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-3107282" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">+1: <code>primesfrom3to</code> (19.6ms) is signifcantly faster than <code>ambi_sieve</code> (29.4ms). Terrific. Thanks for sharing. PS. Since 2 is prime, would you consider changing the return value to <code>numpy.r_[2, 2*np.nonzero(sieve)[0][1::]+1]</code>?</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/190597/unutbu" title="436,169 reputation" class="comment-user">unutbu</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment3107282_3035188"><span title="2010-06-14 13:11:38Z" class="relativetime-clean">Jun 14 '10 at 13:11</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-3110733" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">i use the code that way, fell free to change it for tests if you want, probably with the correction the timing will be almost the same for 1e6 (for 1e7 to 1e9 should be faster), also plz tel me how primes(n) &amp; primes1(n) compare in your machine to the pure python best code for 1e6 &amp; 1e7.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/350331/robert-william-hanks" title="346 reputation" class="comment-user">Robert William Hanks</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment3110733_3035188"><span title="2010-06-14 19:44:54Z" class="relativetime-clean">Jun 14 '10 at 19:44</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-3454178" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">I don't see any measurable speed-up for the new <code>primesfrom2to()</code> <a href="http://ideone.com/5YJkw" rel="nofollow noreferrer">ideone.com/5YJkw</a> (performance comparison is at the end of the file)</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/4279/j-f-sebastian" title="208,500 reputation" class="comment-user">J.F. Sebastian</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment3454178_3035188"><span title="2010-07-25 18:03:29Z" class="relativetime-clean">Jul 25 '10 at 18:03</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-22131203" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Numpy is now compatible with Python 3. The fact that it's not in the standard library is good, that way they can have their own release cycle.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/1106367/codesparkle" title="10,244 reputation" class="comment-user">codesparkle</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment22131203_3035188"><span title="2013-03-24 23:17:16Z" class="relativetime-clean">Mar 24 '13 at 23:17</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-60624024" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">For a pure python version compatible with python 3, follow this link : <a href="http://stackoverflow.com/a/33356284/2482582">stackoverflow.com/a/33356284/2482582</a></span>
                    –&nbsp;<a href="https://stackoverflow.com/users/2482582/moebius" title="1,546 reputation" class="comment-user">Moebius</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment60624024_3035188"><span title="2016-04-08 20:15:07Z" class="relativetime-clean">Apr 8 '16 at 20:15</span></a></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-3035188" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link  dno" title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."></a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link " title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick="">show <b>6</b> more comments</a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="2068412"></a>
<div id="answer-2068412" class="answer" data-answerid="2068412" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2068412">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">38</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>There's a pretty neat sample from the Python Cookbook <a href="http://oreilly.com/pub/a/python/excerpt/pythonckbk_chap1/index1.html?page=last" rel="noreferrer">here</a> -- the fastest version proposed on that URL is:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">import</span><span class="pln"> itertools
</span><span class="kwd">def</span><span class="pln"> erat2</span><span class="pun">(</span><span class="pln"> </span><span class="pun">):</span><span class="pln">
    D </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">yield</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> q </span><span class="kwd">in</span><span class="pln"> itertools</span><span class="pun">.</span><span class="pln">islice</span><span class="pun">(</span><span class="pln">itertools</span><span class="pun">.</span><span class="pln">count</span><span class="pun">(</span><span class="lit">3</span><span class="pun">),</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        p </span><span class="pun">=</span><span class="pln"> D</span><span class="pun">.</span><span class="pln">pop</span><span class="pun">(</span><span class="pln">q</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> p </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">:</span><span class="pln">
            D</span><span class="pun">[</span><span class="pln">q</span><span class="pun">*</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> q
            </span><span class="kwd">yield</span><span class="pln"> q
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            x </span><span class="pun">=</span><span class="pln"> p </span><span class="pun">+</span><span class="pln"> q
            </span><span class="kwd">while</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> D </span><span class="kwd">or</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
                x </span><span class="pun">+=</span><span class="pln"> p
            D</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span></code></pre>

<p>so that would give</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">def</span><span class="pln"> get_primes_erat</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">itertools</span><span class="pun">.</span><span class="pln">takewhile</span><span class="pun">(</span><span class="kwd">lambda</span><span class="pln"> p</span><span class="pun">:</span><span class="pln"> p</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> erat2</span><span class="pun">()))</span></code></pre>

<p>Measuring at the shell prompt (as I prefer to do) with this code in pri.py, I observe:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pln">$ python2</span><span class="pun">.</span><span class="lit">5</span><span class="pln"> </span><span class="pun">-</span><span class="pln">mtimeit </span><span class="pun">-</span><span class="pln">s</span><span class="str">'import pri'</span><span class="pln"> </span><span class="str">'pri.get_primes(1000000)'</span><span class="pln">
</span><span class="lit">10</span><span class="pln"> loops</span><span class="pun">,</span><span class="pln"> best of </span><span class="lit">3</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1.69</span><span class="pln"> sec per loop
$ python2</span><span class="pun">.</span><span class="lit">5</span><span class="pln"> </span><span class="pun">-</span><span class="pln">mtimeit </span><span class="pun">-</span><span class="pln">s</span><span class="str">'import pri'</span><span class="pln"> </span><span class="str">'pri.get_primes_erat(1000000)'</span><span class="pln">
</span><span class="lit">10</span><span class="pln"> loops</span><span class="pun">,</span><span class="pln"> best of </span><span class="lit">3</span><span class="pun">:</span><span class="pln"> </span><span class="lit">673</span><span class="pln"> msec per loop</span></code></pre>

<p>so it looks like the Cookbook solution is over twice as fast.</p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/2068412" title="short permalink to this answer" class="short-link" id="link-post-2068412">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/2068412/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/2068412/revisions" title="show all edits to this post">edited <span title="2015-07-16 13:33:40Z" class="relativetime">Jul 16 '15 at 13:33</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/284795/colonel-panic"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/99f7ffd3d45dbcef0b3b6960dcfe81a2" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/284795/colonel-panic">Colonel Panic</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 63,588" dir="ltr">63.6k</span><span title="41 gold badges"><span class="badge1"></span><span class="badgecount">41</span></span><span title="251 silver badges"><span class="badge2"></span><span class="badgecount">251</span></span><span title="320 bronze badges"><span class="badge3"></span><span class="badgecount">320</span></span>
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-01-14 23:52:06Z" class="relativetime">Jan 14 '10 at 23:52</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/95810/alex-martelli"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/e8d5fe90f1fe2148bf130cccd4dc311c" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/95810/alex-martelli">Alex Martelli</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 525,912" dir="ltr">526k</span><span title="97 gold badges"><span class="badge1"></span><span class="badgecount">97</span></span><span title="929 silver badges"><span class="badge2"></span><span class="badgecount">929</span></span><span title="1203 bronze badges"><span class="badge3"></span><span class="badgecount">1203</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2068412" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-1997910" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@jbochi, you're welcome -- but do look at that URL, including the credits: it took <b>ten</b> of us to collectively refine the code to this point, including Python-performance luminaries such as Tim Peters and Raymond Hettinger (I wrote the final text of the recipe since I edited the printed Cookbook, but in terms of coding my contribution was on a par with the others') -- in the end, it's really subtle and finely tuned code, and that's not surprising!-)</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/95810/alex-martelli" title="525,912 reputation" class="comment-user">Alex Martelli</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment1997910_2068412"><span title="2010-01-14 23:59:13Z" class="relativetime-clean">Jan 14 '10 at 23:59</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-1997992" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@Alex: Knowing that your code is "only" twice as fast as mine, makes me pretty proud then. :) The URL was also very interesting to read. Thanks again.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/230636/jbochi" title="16,903 reputation" class="comment-user owner">jbochi</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment1997992_2068412"><span title="2010-01-15 00:13:22Z" class="relativetime-clean">Jan 15 '10 at 0:13</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-4023983" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">And it can be made even faster with a minor change: see <a href="http://stackoverflow.com/questions/2211990/how-to-implement-an-efficient-infinite-generator-of-prime-numbers-in-python/3796442#3796442" title="how to implement an efficient infinite generator of prime numbers in python">stackoverflow.com/questions/2211990/…</a></span>
                    –&nbsp;<a href="https://stackoverflow.com/users/6899/tzot" title="52,028 reputation" class="comment-user">tzot</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment4023983_2068412"><span title="2010-09-26 03:02:36Z" class="relativetime-clean">Sep 26 '10 at 3:02</span></a></span>
                        <span class="edited-yes" title="this comment was edited 1 time"></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-15657933" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">... And it <a href="http://stackoverflow.com/a/10733621/849891">can be made yet faster</a> with additional ~1.2x-1.3x speedup, drastic reduction in memory footprint from O(n) to O(sqrt(n)) and improvement in empirical time complexity, by postponing the addition of primes to the dict until their <i>square</i> is seen in the input. <a href="http://ideone.com/WFv4f" rel="nofollow noreferrer">Test it here</a>.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/849891/will-ness" title="32,974 reputation" class="comment-user">Will Ness</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment15657933_2068412"><span title="2012-08-02 22:28:05Z" class="relativetime-clean">Aug 2 '12 at 22:28</span></a></span>
                        <span class="edited-yes" title="this comment was edited 1 time"></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2068412" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="2073279"></a>
<div id="answer-2073279" class="answer" data-answerid="2073279" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2073279">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">26</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>Using <a href="http://plus.maths.org/issue50/features/havil/index.html" rel="noreferrer">Sundaram's Sieve</a>, I think I broke pure-Python's record:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">def</span><span class="pln"> sundaram3</span><span class="pun">(</span><span class="pln">max_n</span><span class="pun">):</span><span class="pln">
    numbers </span><span class="pun">=</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> max_n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    half </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">max_n</span><span class="pun">)//</span><span class="lit">2</span><span class="pln">
    initial </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln">

    </span><span class="kwd">for</span><span class="pln"> step </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> max_n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">initial</span><span class="pun">,</span><span class="pln"> half</span><span class="pun">,</span><span class="pln"> step</span><span class="pun">):</span><span class="pln">
            numbers</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
        initial </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*(</span><span class="pln">step</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> initial </span><span class="pun">&gt;</span><span class="pln"> half</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> filter</span><span class="pun">(</span><span class="kwd">None</span><span class="pun">,</span><span class="pln"> numbers</span><span class="pun">)</span></code></pre>

<p>Comparasion:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pln">C</span><span class="pun">:</span><span class="pln">\USERS</span><span class="pun">&gt;</span><span class="pln">python </span><span class="pun">-</span><span class="pln">m timeit </span><span class="pun">-</span><span class="pln">n10 </span><span class="pun">-</span><span class="pln">s </span><span class="str">"import get_primes"</span><span class="pln"> </span><span class="str">"get_primes.get_primes_erat(1000000)"</span><span class="pln">
</span><span class="lit">10</span><span class="pln"> loops</span><span class="pun">,</span><span class="pln"> best of </span><span class="lit">3</span><span class="pun">:</span><span class="pln"> </span><span class="lit">710</span><span class="pln"> msec per loop

C</span><span class="pun">:</span><span class="pln">\USERS</span><span class="pun">&gt;</span><span class="pln">python </span><span class="pun">-</span><span class="pln">m timeit </span><span class="pun">-</span><span class="pln">n10 </span><span class="pun">-</span><span class="pln">s </span><span class="str">"import get_primes"</span><span class="pln"> </span><span class="str">"get_primes.daniel_sieve_2(1000000)"</span><span class="pln">
</span><span class="lit">10</span><span class="pln"> loops</span><span class="pun">,</span><span class="pln"> best of </span><span class="lit">3</span><span class="pun">:</span><span class="pln"> </span><span class="lit">435</span><span class="pln"> msec per loop

C</span><span class="pun">:</span><span class="pln">\USERS</span><span class="pun">&gt;</span><span class="pln">python </span><span class="pun">-</span><span class="pln">m timeit </span><span class="pun">-</span><span class="pln">n10 </span><span class="pun">-</span><span class="pln">s </span><span class="str">"import get_primes"</span><span class="pln"> </span><span class="str">"get_primes.sundaram3(1000000)"</span><span class="pln">
</span><span class="lit">10</span><span class="pln"> loops</span><span class="pun">,</span><span class="pln"> best of </span><span class="lit">3</span><span class="pun">:</span><span class="pln"> </span><span class="lit">327</span><span class="pln"> msec per loop</span></code></pre>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/2073279" title="short permalink to this answer" class="short-link" id="link-post-2073279">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/2073279/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/2073279/revisions" title="show all edits to this post">edited <span title="2010-01-20 11:11:19Z" class="relativetime">Jan 20 '10 at 11:11</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature owner">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2010-01-15 16:50:02Z" class="relativetime">Jan 15 '10 at 16:50</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/230636/jbochi"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/1018b29e2da89f5920a58482e17a1948" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/230636/jbochi">jbochi</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 16,903" dir="ltr">16.9k</span><span title="13 gold badges"><span class="badge1"></span><span class="badgecount">13</span></span><span title="58 silver badges"><span class="badge2"></span><span class="badgecount">58</span></span><span title="78 bronze badges"><span class="badge3"></span><span class="badgecount">78</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2073279" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-2003356" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">I've not come across Sundaram's Sieve before - very cool!</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/37416/mike-houston" title="5,343 reputation" class="comment-user">Mike Houston</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2003356_2073279"><span title="2010-01-15 17:15:32Z" class="relativetime-clean">Jan 15 '10 at 17:15</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-2034228" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">I managed to speed up your function about 20% by adding "zero = 0" at the top of the function and then replacing the lambda in your filter with "zero.__sub__". Not the prettiest code in the world, but a bit faster :)</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/39991/truppo" title="15,559 reputation" class="comment-user">truppo</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2034228_2073279"><span title="2010-01-20 10:34:20Z" class="relativetime-clean">Jan 20 '10 at 10:34</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-2034429" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@truppo: Thanks for your comment! I just realized that passing <code>None</code> instead of the original function works and it's even faster than <code>zero.__sub__</code></span>
                    –&nbsp;<a href="https://stackoverflow.com/users/230636/jbochi" title="16,903 reputation" class="comment-user owner">jbochi</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2034429_2073279"><span title="2010-01-20 11:08:01Z" class="relativetime-clean">Jan 20 '10 at 11:08</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-27965578" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">4</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Did you know that if you pass <code>sundaram3(9)</code> it will return <code>[2, 3, 5, 7, 9]</code>?  It seems to do this with numerous -- perhaps all -- odd numbers (even when they aren't prime)</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/1572626/wrhall" title="671 reputation" class="comment-user">wrhall</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment27965578_2073279"><span title="2013-09-21 23:57:49Z" class="relativetime-clean">Sep 21 '13 at 23:57</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-57043783" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">it has an issue: sundaram3(7071) includes 7071 while it is not prime</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/1327005/assem-chelli" title="7,715 reputation" class="comment-user">Assem Chelli</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment57043783_2073279"><span title="2016-01-07 07:08:28Z" class="relativetime-clean">Jan 7 '16 at 7:08</span></a></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2073279" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="2068522"></a>
<div id="answer-2068522" class="answer" data-answerid="2068522" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2068522">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">17</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>The algorithm is fast, but it has a serious flaw:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pun">&gt;&gt;&gt;</span><span class="pln"> sorted</span><span class="pun">(</span><span class="pln">get_primes</span><span class="pun">(</span><span class="lit">530</span><span class="pun">))</span><span class="pln">
</span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">11</span><span class="pun">,</span><span class="pln"> </span><span class="lit">13</span><span class="pun">,</span><span class="pln"> </span><span class="lit">17</span><span class="pun">,</span><span class="pln"> </span><span class="lit">19</span><span class="pun">,</span><span class="pln"> </span><span class="lit">23</span><span class="pun">,</span><span class="pln"> </span><span class="lit">29</span><span class="pun">,</span><span class="pln"> </span><span class="lit">31</span><span class="pun">,</span><span class="pln"> </span><span class="lit">37</span><span class="pun">,</span><span class="pln"> </span><span class="lit">41</span><span class="pun">,</span><span class="pln"> </span><span class="lit">43</span><span class="pun">,</span><span class="pln"> </span><span class="lit">47</span><span class="pun">,</span><span class="pln"> </span><span class="lit">53</span><span class="pun">,</span><span class="pln"> </span><span class="lit">59</span><span class="pun">,</span><span class="pln"> </span><span class="lit">61</span><span class="pun">,</span><span class="pln"> </span><span class="lit">67</span><span class="pun">,</span><span class="pln"> </span><span class="lit">71</span><span class="pun">,</span><span class="pln"> </span><span class="lit">73</span><span class="pun">,</span><span class="pln">
</span><span class="lit">79</span><span class="pun">,</span><span class="pln"> </span><span class="lit">83</span><span class="pun">,</span><span class="pln"> </span><span class="lit">89</span><span class="pun">,</span><span class="pln"> </span><span class="lit">97</span><span class="pun">,</span><span class="pln"> </span><span class="lit">101</span><span class="pun">,</span><span class="pln"> </span><span class="lit">103</span><span class="pun">,</span><span class="pln"> </span><span class="lit">107</span><span class="pun">,</span><span class="pln"> </span><span class="lit">109</span><span class="pun">,</span><span class="pln"> </span><span class="lit">113</span><span class="pun">,</span><span class="pln"> </span><span class="lit">127</span><span class="pun">,</span><span class="pln"> </span><span class="lit">131</span><span class="pun">,</span><span class="pln"> </span><span class="lit">137</span><span class="pun">,</span><span class="pln"> </span><span class="lit">139</span><span class="pun">,</span><span class="pln"> </span><span class="lit">149</span><span class="pun">,</span><span class="pln"> </span><span class="lit">151</span><span class="pun">,</span><span class="pln"> </span><span class="lit">157</span><span class="pun">,</span><span class="pln"> </span><span class="lit">163</span><span class="pun">,</span><span class="pln">
</span><span class="lit">167</span><span class="pun">,</span><span class="pln"> </span><span class="lit">173</span><span class="pun">,</span><span class="pln"> </span><span class="lit">179</span><span class="pun">,</span><span class="pln"> </span><span class="lit">181</span><span class="pun">,</span><span class="pln"> </span><span class="lit">191</span><span class="pun">,</span><span class="pln"> </span><span class="lit">193</span><span class="pun">,</span><span class="pln"> </span><span class="lit">197</span><span class="pun">,</span><span class="pln"> </span><span class="lit">199</span><span class="pun">,</span><span class="pln"> </span><span class="lit">211</span><span class="pun">,</span><span class="pln"> </span><span class="lit">223</span><span class="pun">,</span><span class="pln"> </span><span class="lit">227</span><span class="pun">,</span><span class="pln"> </span><span class="lit">229</span><span class="pun">,</span><span class="pln"> </span><span class="lit">233</span><span class="pun">,</span><span class="pln"> </span><span class="lit">239</span><span class="pun">,</span><span class="pln"> </span><span class="lit">241</span><span class="pun">,</span><span class="pln"> </span><span class="lit">251</span><span class="pun">,</span><span class="pln">
</span><span class="lit">257</span><span class="pun">,</span><span class="pln"> </span><span class="lit">263</span><span class="pun">,</span><span class="pln"> </span><span class="lit">269</span><span class="pun">,</span><span class="pln"> </span><span class="lit">271</span><span class="pun">,</span><span class="pln"> </span><span class="lit">277</span><span class="pun">,</span><span class="pln"> </span><span class="lit">281</span><span class="pun">,</span><span class="pln"> </span><span class="lit">283</span><span class="pun">,</span><span class="pln"> </span><span class="lit">293</span><span class="pun">,</span><span class="pln"> </span><span class="lit">307</span><span class="pun">,</span><span class="pln"> </span><span class="lit">311</span><span class="pun">,</span><span class="pln"> </span><span class="lit">313</span><span class="pun">,</span><span class="pln"> </span><span class="lit">317</span><span class="pun">,</span><span class="pln"> </span><span class="lit">331</span><span class="pun">,</span><span class="pln"> </span><span class="lit">337</span><span class="pun">,</span><span class="pln"> </span><span class="lit">347</span><span class="pun">,</span><span class="pln"> </span><span class="lit">349</span><span class="pun">,</span><span class="pln">
</span><span class="lit">353</span><span class="pun">,</span><span class="pln"> </span><span class="lit">359</span><span class="pun">,</span><span class="pln"> </span><span class="lit">367</span><span class="pun">,</span><span class="pln"> </span><span class="lit">373</span><span class="pun">,</span><span class="pln"> </span><span class="lit">379</span><span class="pun">,</span><span class="pln"> </span><span class="lit">383</span><span class="pun">,</span><span class="pln"> </span><span class="lit">389</span><span class="pun">,</span><span class="pln"> </span><span class="lit">397</span><span class="pun">,</span><span class="pln"> </span><span class="lit">401</span><span class="pun">,</span><span class="pln"> </span><span class="lit">409</span><span class="pun">,</span><span class="pln"> </span><span class="lit">419</span><span class="pun">,</span><span class="pln"> </span><span class="lit">421</span><span class="pun">,</span><span class="pln"> </span><span class="lit">431</span><span class="pun">,</span><span class="pln"> </span><span class="lit">433</span><span class="pun">,</span><span class="pln"> </span><span class="lit">439</span><span class="pun">,</span><span class="pln"> </span><span class="lit">443</span><span class="pun">,</span><span class="pln">
</span><span class="lit">449</span><span class="pun">,</span><span class="pln"> </span><span class="lit">457</span><span class="pun">,</span><span class="pln"> </span><span class="lit">461</span><span class="pun">,</span><span class="pln"> </span><span class="lit">463</span><span class="pun">,</span><span class="pln"> </span><span class="lit">467</span><span class="pun">,</span><span class="pln"> </span><span class="lit">479</span><span class="pun">,</span><span class="pln"> </span><span class="lit">487</span><span class="pun">,</span><span class="pln"> </span><span class="lit">491</span><span class="pun">,</span><span class="pln"> </span><span class="lit">499</span><span class="pun">,</span><span class="pln"> </span><span class="lit">503</span><span class="pun">,</span><span class="pln"> </span><span class="lit">509</span><span class="pun">,</span><span class="pln"> </span><span class="lit">521</span><span class="pun">,</span><span class="pln"> </span><span class="lit">523</span><span class="pun">,</span><span class="pln"> </span><span class="lit">527</span><span class="pun">,</span><span class="pln"> </span><span class="lit">529</span><span class="pun">]</span><span class="pln">
</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="lit">17</span><span class="pun">*</span><span class="lit">31</span><span class="pln">
</span><span class="lit">527</span><span class="pln">
</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="lit">23</span><span class="pun">*</span><span class="lit">23</span><span class="pln">
</span><span class="lit">529</span></code></pre>

<p>You assume that <code>numbers.pop()</code> would return the smallest number in the set, but this is not guaranteed at all. Sets are unordered and <code>pop()</code> removes and returns an <a href="http://docs.python.org/library/stdtypes.html#set.pop" rel="noreferrer"><strong>arbitrary</strong></a> element, so it cannot be used to select the next prime from the remaining numbers.</p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/2068522" title="short permalink to this answer" class="short-link" id="link-post-2068522">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/2068522/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-01-15 00:14:04Z" class="relativetime">Jan 15 '10 at 0:14</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/56338/sth"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/92fb4563ddc5ceeaa8b19b60a7a172f4" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/56338/sth">sth</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 139,990" dir="ltr">140k</span><span title="34 gold badges"><span class="badge1"></span><span class="badgecount">34</span></span><span title="218 silver badges"><span class="badge2"></span><span class="badgecount">218</span></span><span title="319 bronze badges"><span class="badge3"></span><span class="badgecount">319</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2068522" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-1998274" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Thanks for pointing this out... I was using lists and I moved to sets to make it faster, but I didn't realize it broke the algorithm.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/230636/jbochi" title="16,903 reputation" class="comment-user owner">jbochi</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment1998274_2068522"><span title="2010-01-15 01:10:52Z" class="relativetime-clean">Jan 15 '10 at 1:10</span></a></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2068522" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="2070175"></a>
<div id="answer-2070175" class="answer" data-answerid="2070175" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2070175">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">14</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>For <strong>truly</strong> fastest solution with sufficiently large N would be to download a <a href="http://primes.utm.edu/lists/small/millions/" rel="noreferrer">pre-calculated list of primes</a>, store it as a tuple and do something like:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">for</span><span class="pln"> pos</span><span class="pun">,</span><span class="pln">i </span><span class="kwd">in</span><span class="pln"> enumerate</span><span class="pun">(</span><span class="pln">primes</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> N</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln"> primes</span><span class="pun">[:</span><span class="pln">pos</span><span class="pun">]</span></code></pre>

<p>If <code>N &gt; primes[-1]</code> <em>only</em> then calculate more primes and save the new list in your code, so next time it is equally as fast.</p>

<p><em>Always think outside the box.</em></p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/2070175" title="short permalink to this answer" class="short-link" id="link-post-2070175">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/2070175/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-01-15 07:58:18Z" class="relativetime">Jan 15 '10 at 7:58</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/180174/kimvais"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/6193f1c7bb7098184a5096339c455a0d" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/180174/kimvais">Kimvais</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 20,254" dir="ltr">20.3k</span><span title="8 gold badges"><span class="badge1"></span><span class="badgecount">8</span></span><span title="75 silver badges"><span class="badge2"></span><span class="badgecount">75</span></span><span title="110 bronze badges"><span class="badge3"></span><span class="badgecount">110</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2070175" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-2000019" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="warm">7</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">To be fair, though, you'd have to count the time downloading, unzipping, and formatting the primes and compare that with the time to generate primes using an algorithm - any one of these algorithms could easily write the results to a file for later use. I think in that case, given enough memory to actually calculate all primes less than 982,451,653, the numpy solution would still be faster.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/207432/daniel-g" title="29,111 reputation" class="comment-user">Daniel G</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2000019_2070175"><span title="2010-01-15 08:49:03Z" class="relativetime-clean">Jan 15 '10 at 8:49</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-2000441" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">3</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@Daniel correct. However the store what you have and continue whenever needed still stands...</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/180174/kimvais" title="20,254 reputation" class="comment-user">Kimvais</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2000441_2070175"><span title="2010-01-15 10:11:21Z" class="relativetime-clean">Jan 15 '10 at 10:11</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-41666552" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@Daniel G I think download time is irrelevant. Isn't it really about generating the numbers, so you would want to take into account the algorithm used to create that list you're downloading. And any time complexity would ignore the once of file transfer given it O(n).</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/539394/ross" title="733 reputation" class="comment-user">Ross</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment41666552_2070175"><span title="2014-10-22 22:56:46Z" class="relativetime-clean">Oct 22 '14 at 22:56</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-75267410" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">The <a href="https://primes.utm.edu/notes/faq/LongestList.html" rel="nofollow noreferrer">FAQ</a> for the UTM prime page suggests calculating small primes is faster than reading them off a disk (the question is what small means).</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/4729930/batman" title="103 reputation" class="comment-user">Batman</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment75267410_2070175"><span title="2017-05-23 00:59:12Z" class="relativetime-clean">May 23 at 0:59</span></a></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2070175" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="31221522"></a>
<div id="answer-31221522" class="answer" data-answerid="31221522" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="31221522">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">7</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>If you don't want to reinvent the wheel, you can install the symbolic maths library <a href="http://www.sympy.org/en/index.html" rel="noreferrer">sympy</a> (yes it's Python 3 compatible)</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pln">pip install sympy</span></code></pre>

<p>And use the <a href="http://docs.sympy.org/dev/modules/ntheory.html#sympy.ntheory.generate.Sieve.primerange" rel="noreferrer">primerange</a> function</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">from</span><span class="pln"> sympy </span><span class="kwd">import</span><span class="pln"> sieve
primes </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">sieve</span><span class="pun">.</span><span class="pln">primerange</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10</span><span class="pun">**</span><span class="lit">6</span><span class="pun">))</span></code></pre>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/31221522" title="short permalink to this answer" class="short-link" id="link-post-31221522">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/31221522/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/31221522/revisions" title="show all edits to this post">edited <span title="2015-07-20 09:06:05Z" class="relativetime">Jul 20 '15 at 9:06</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2015-07-04 14:06:49Z" class="relativetime">Jul 4 '15 at 14:06</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/284795/colonel-panic"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/99f7ffd3d45dbcef0b3b6960dcfe81a2" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/284795/colonel-panic">Colonel Panic</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 63,588" dir="ltr">63.6k</span><span title="41 gold badges"><span class="badge1"></span><span class="badgecount">41</span></span><span title="251 silver badges"><span class="badge2"></span><span class="badgecount">251</span></span><span title="320 bronze badges"><span class="badge3"></span><span class="badgecount">320</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-31221522" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-31221522" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="31322423"></a>
<div id="answer-31322423" class="answer" data-answerid="31322423" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="31322423">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">5</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>It's instructive to write your own prime finding code, but it's also useful to have a fast reliable library at hand. I wrote a wrapper around the <a href="http://primesieve.org/" rel="nofollow">C++ library primesieve</a>, named it <a href="https://github.com/hickford/primesieve-python" rel="nofollow">primesieve-python</a></p>

<p>Try it <code>pip install primesieve</code></p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">import</span><span class="pln"> primesieve
primes </span><span class="pun">=</span><span class="pln"> primesieve</span><span class="pun">.</span><span class="pln">generate_primes</span><span class="pun">(</span><span class="lit">10</span><span class="pun">**</span><span class="lit">8</span><span class="pun">)</span></code></pre>

<p>I'd be curious to see the speed compared.</p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/31322423" title="short permalink to this answer" class="short-link" id="link-post-31322423">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/31322423/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/31322423/revisions" title="show all edits to this post">edited <span title="2015-07-20 09:06:46Z" class="relativetime">Jul 20 '15 at 9:06</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2015-07-09 15:50:07Z" class="relativetime">Jul 9 '15 at 15:50</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/284795/colonel-panic"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/99f7ffd3d45dbcef0b3b6960dcfe81a2" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/284795/colonel-panic">Colonel Panic</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 63,588" dir="ltr">63.6k</span><span title="41 gold badges"><span class="badge1"></span><span class="badgecount">41</span></span><span title="251 silver badges"><span class="badge2"></span><span class="badgecount">251</span></span><span title="320 bronze badges"><span class="badge3"></span><span class="badgecount">320</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-31322423" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-50631526" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">See also <a href="https://github.com/jaredks/pyprimesieve" rel="nofollow noreferrer">github.com/jaredks/pyprimesieve</a></span>
                    –&nbsp;<a href="https://stackoverflow.com/users/284795/colonel-panic" title="63,588 reputation" class="comment-user">Colonel Panic</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment50631526_31322423"><span title="2015-07-09 15:50:16Z" class="relativetime-clean">Jul 9 '15 at 15:50</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-50775057" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">It's not exactly what OP ordered but I fail to see why the downvote. It's a 2.8sec solution unlike some other outside modules. I've noticed in the source that it's threaded, got any tests on how well it scales?</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/2809008/ljetibo" title="1,876 reputation" class="comment-user">ljetibo</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment50775057_31322423"><span title="2015-07-14 07:24:40Z" class="relativetime-clean">Jul 14 '15 at 7:24</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-50776933" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@ljetibo cheers. The bottleneck seems to be copying C++ vector to Python list, thus the <code>count_primes</code> function is much faster than <code>generate_primes</code></span>
                    –&nbsp;<a href="https://stackoverflow.com/users/284795/colonel-panic" title="63,588 reputation" class="comment-user">Colonel Panic</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment50776933_31322423"><span title="2015-07-14 08:19:17Z" class="relativetime-clean">Jul 14 '15 at 8:19</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-50777341" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">On my computer it can comfortably generate primes up to 1e8 (it gives MemoryError for 1e9) , and count primes up to 1e10. @HappyLeapSecond above compares algorithms for 1e6</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/284795/colonel-panic" title="63,588 reputation" class="comment-user">Colonel Panic</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment50777341_31322423"><span title="2015-07-14 08:30:07Z" class="relativetime-clean">Jul 14 '15 at 8:30</span></a></span>
                        <span class="edited-yes" title="this comment was edited 1 time"></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-31322423" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="33356284"></a>
<div id="answer-33356284" class="answer" data-answerid="33356284" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="33356284">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">5</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>If you accept itertools but not numpy, here is an adaptation of rwh_primes2 for Python 3 that runs about twice as fast on my machine.  The only substantial change is using a bytearray instead of a list for the boolean, and using compress instead of a list comprehension to build the final list.  (I'd add this as a comment like moarningsun if I were able.)</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">import</span><span class="pln"> itertools
izip </span><span class="pun">=</span><span class="pln"> itertools</span><span class="pun">.</span><span class="pln">zip_longest
chain </span><span class="pun">=</span><span class="pln"> itertools</span><span class="pun">.</span><span class="pln">chain</span><span class="pun">.</span><span class="pln">from_iterable
compress </span><span class="pun">=</span><span class="pln"> itertools</span><span class="pun">.</span><span class="pln">compress
</span><span class="kwd">def</span><span class="pln"> rwh_primes2_python3</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    </span><span class="str">""" Input n&gt;=6, Returns a list of primes, 2 &lt;= p &lt; n """</span><span class="pln">
    zero </span><span class="pun">=</span><span class="pln"> bytearray</span><span class="pun">([</span><span class="kwd">False</span><span class="pun">])</span><span class="pln">
    size </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">//</span><span class="lit">3</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">%</span><span class="pln"> </span><span class="lit">6</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    sieve </span><span class="pun">=</span><span class="pln"> bytearray</span><span class="pun">([</span><span class="kwd">True</span><span class="pun">])</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> size
    sieve</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">**</span><span class="lit">0.5</span><span class="pun">)//</span><span class="lit">3</span><span class="pun">+</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
        k</span><span class="pun">=</span><span class="lit">3</span><span class="pun">*</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pln">
        start </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k</span><span class="pun">*</span><span class="pln">k</span><span class="pun">+</span><span class="lit">4</span><span class="pun">*</span><span class="pln">k</span><span class="pun">-</span><span class="lit">2</span><span class="pun">*</span><span class="pln">k</span><span class="pun">*(</span><span class="pln">i</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">))//</span><span class="lit">3</span><span class="pln">
        sieve</span><span class="pun">[(</span><span class="pln">k</span><span class="pun">*</span><span class="pln">k</span><span class="pun">)//</span><span class="lit">3</span><span class="pun">::</span><span class="lit">2</span><span class="pun">*</span><span class="pln">k</span><span class="pun">]=</span><span class="pln">zero</span><span class="pun">*((</span><span class="pln">size </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k</span><span class="pun">*</span><span class="pln">k</span><span class="pun">)//</span><span class="lit">3</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">//</span><span class="pln"> </span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        sieve</span><span class="pun">[</span><span class="pln">  start </span><span class="pun">::</span><span class="lit">2</span><span class="pun">*</span><span class="pln">k</span><span class="pun">]=</span><span class="pln">zero</span><span class="pun">*((</span><span class="pln">size </span><span class="pun">-</span><span class="pln">   start  </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">//</span><span class="pln"> </span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">]</span><span class="pln">
    poss </span><span class="pun">=</span><span class="pln"> chain</span><span class="pun">(</span><span class="pln">izip</span><span class="pun">(*[</span><span class="pln">range</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">5</span><span class="pun">)]))</span><span class="pln">
    ans</span><span class="pun">.</span><span class="pln">extend</span><span class="pun">(</span><span class="pln">compress</span><span class="pun">(</span><span class="pln">poss</span><span class="pun">,</span><span class="pln"> sieve</span><span class="pun">))</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ans</span></code></pre>

<p>Comparisons:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pun">&gt;&gt;&gt;</span><span class="pln"> timeit</span><span class="pun">.</span><span class="pln">timeit</span><span class="pun">(</span><span class="str">'primes.rwh_primes2(10**6)'</span><span class="pun">,</span><span class="pln"> setup</span><span class="pun">=</span><span class="str">'import primes'</span><span class="pun">,</span><span class="pln"> number</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
</span><span class="lit">0.0652179726976101</span><span class="pln">
</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> timeit</span><span class="pun">.</span><span class="pln">timeit</span><span class="pun">(</span><span class="str">'primes.rwh_primes2_python3(10**6)'</span><span class="pun">,</span><span class="pln"> setup</span><span class="pun">=</span><span class="str">'import primes'</span><span class="pun">,</span><span class="pln"> number</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
</span><span class="lit">0.03267321276325674</span></code></pre>

<p>and</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pun">&gt;&gt;&gt;</span><span class="pln"> timeit</span><span class="pun">.</span><span class="pln">timeit</span><span class="pun">(</span><span class="str">'primes.rwh_primes2(10**8)'</span><span class="pun">,</span><span class="pln"> setup</span><span class="pun">=</span><span class="str">'import primes'</span><span class="pun">,</span><span class="pln"> number</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
</span><span class="lit">6.394284538007014</span><span class="pln">
</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> timeit</span><span class="pun">.</span><span class="pln">timeit</span><span class="pun">(</span><span class="str">'primes.rwh_primes2_python3(10**8)'</span><span class="pun">,</span><span class="pln"> setup</span><span class="pun">=</span><span class="str">'import primes'</span><span class="pun">,</span><span class="pln"> number</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
</span><span class="lit">3.833829450302801</span></code></pre>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/33356284" title="short permalink to this answer" class="short-link" id="link-post-33356284">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/33356284/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/33356284/revisions" title="show all edits to this post">edited <span title="2016-02-28 16:14:14Z" class="relativetime">Feb 28 '16 at 16:14</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2015-10-26 21:51:11Z" class="relativetime">Oct 26 '15 at 21:51</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/5439078/jason"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/24bd5e7e0a86eb55bf2a66172d28b5ba" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/5439078/jason">Jason</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">63</span><span title="1 silver badge"><span class="badge2"></span><span class="badgecount">1</span></span><span title="7 bronze badges"><span class="badge3"></span><span class="badgecount">7</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-33356284" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-33356284" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="2106085"></a>
<div id="answer-2106085" class="answer" data-answerid="2106085" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2106085">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">4</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>If you have control over N, the very fastest way to list all primes is to precompute them. Seriously. Precomputing is a way overlooked optimization.</p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/2106085" title="short permalink to this answer" class="short-link" id="link-post-2106085">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/2106085/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-01-21 00:21:40Z" class="relativetime">Jan 21 '10 at 0:21</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/62288/dave-w-smith"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/01239dcaa443502ce71059f5308bca74" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/62288/dave-w-smith">Dave W. Smith</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 13,477" dir="ltr">13.5k</span><span title="1 gold badge"><span class="badge1"></span><span class="badgecount">1</span></span><span title="20 silver badges"><span class="badge2"></span><span class="badgecount">20</span></span><span title="26 bronze badges"><span class="badge3"></span><span class="badgecount">26</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2106085" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-2043322" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">3</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Or download them from here <a href="http://primes.utm.edu/lists/small/millions/" rel="nofollow noreferrer">primes.utm.edu/lists/small/millions</a>, but the idea is to test python's limit and see if beautiful code emerge from optimization.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/230636/jbochi" title="16,903 reputation" class="comment-user owner">jbochi</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2043322_2106085"><span title="2010-01-21 10:14:15Z" class="relativetime-clean">Jan 21 '10 at 10:14</span></a></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2106085" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="2110724"></a>
<div id="answer-2110724" class="answer" data-answerid="2110724" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2110724">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">4</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>Here's the code I normally use to generate primes in Python:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pln">$ python </span><span class="pun">-</span><span class="pln">mtimeit </span><span class="pun">-</span><span class="pln">s</span><span class="str">'import sieve'</span><span class="pln"> </span><span class="str">'sieve.sieve(1000000)'</span><span class="pln"> 
</span><span class="lit">10</span><span class="pln"> loops</span><span class="pun">,</span><span class="pln"> best of </span><span class="lit">3</span><span class="pun">:</span><span class="pln"> </span><span class="lit">445</span><span class="pln"> msec per loop
$ cat sieve</span><span class="pun">.</span><span class="pln">py
</span><span class="kwd">from</span><span class="pln"> math </span><span class="kwd">import</span><span class="pln"> sqrt

</span><span class="kwd">def</span><span class="pln"> sieve</span><span class="pun">(</span><span class="pln">size</span><span class="pun">):</span><span class="pln">
 prime</span><span class="pun">=[</span><span class="kwd">True</span><span class="pun">]*</span><span class="pln">size
 rng</span><span class="pun">=</span><span class="pln">xrange
 limit</span><span class="pun">=</span><span class="pln">int</span><span class="pun">(</span><span class="pln">sqrt</span><span class="pun">(</span><span class="pln">size</span><span class="pun">))</span><span class="pln">

 </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> rng</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln">limit</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,+</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> prime</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
   prime</span><span class="pun">[</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">::+</span><span class="pln">i</span><span class="pun">]=[</span><span class="kwd">False</span><span class="pun">]*</span><span class="pln">len</span><span class="pun">(</span><span class="pln">prime</span><span class="pun">[</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">::+</span><span class="pln">i</span><span class="pun">])</span><span class="pln">

 </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">]+[</span><span class="pln">i </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> rng</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln">size</span><span class="pun">,+</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> prime</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln">

</span><span class="kwd">if</span><span class="pln"> __name__</span><span class="pun">==</span><span class="str">'__main__'</span><span class="pun">:</span><span class="pln">
 </span><span class="kwd">print</span><span class="pln"> sieve</span><span class="pun">(</span><span class="lit">100</span><span class="pun">)</span></code></pre>

<p>It can't compete with the faster solutions posted here, but at least it is pure python.</p>

<p>Thanks for posting this question. I really learnt a lot today. </p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/2110724" title="short permalink to this answer" class="short-link" id="link-post-2110724">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/2110724/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2010-01-21 16:09:36Z" class="relativetime">Jan 21 '10 at 16:09</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/125382/mak"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/ad5a692e6c564556953c2db8a51bdab2" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/125382/mak">MAK</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 17,166" dir="ltr">17.2k</span><span title="7 gold badges"><span class="badge1"></span><span class="badgecount">7</span></span><span title="39 silver badges"><span class="badge2"></span><span class="badgecount">39</span></span><span title="72 bronze badges"><span class="badge3"></span><span class="badgecount">72</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2110724" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2110724" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="2070107"></a>
<div id="answer-2070107" class="answer" data-answerid="2070107" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2070107">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">3</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>For the fastest code, the numpy solution is the best. For purely academic reasons, though, I'm posting my pure python version, which is a bit less than 50% faster than the cookbook version posted above. Since I make the entire list in memory, you need enough space to hold everything, but it seems to scale fairly well.</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">def</span><span class="pln"> daniel_sieve_2</span><span class="pun">(</span><span class="pln">maxNumber</span><span class="pun">):</span><span class="pln">
    </span><span class="str">"""
    Given a number, returns all numbers less than or equal to
    that number which are prime.
    """</span><span class="pln">
    allNumbers </span><span class="pun">=</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> maxNumber</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> mIndex</span><span class="pun">,</span><span class="pln"> number </span><span class="kwd">in</span><span class="pln"> enumerate</span><span class="pun">(</span><span class="pln">xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> maxNumber</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> allNumbers</span><span class="pun">[</span><span class="pln">mIndex</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">continue</span><span class="pln">
        </span><span class="com"># now set all multiples to 0</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> index </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">mIndex</span><span class="pun">+</span><span class="pln">number</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="pln">maxNumber</span><span class="pun">-</span><span class="lit">3</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> number</span><span class="pun">):</span><span class="pln">
            allNumbers</span><span class="pun">[</span><span class="pln">index</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> filter</span><span class="pun">(</span><span class="kwd">lambda</span><span class="pln"> n</span><span class="pun">:</span><span class="pln"> n</span><span class="pun">!=</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> allNumbers</span><span class="pun">)</span></code></pre>

<p>And the results:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pun">&gt;&gt;&gt;</span><span class="pln">mine </span><span class="pun">=</span><span class="pln"> timeit</span><span class="pun">.</span><span class="typ">Timer</span><span class="pun">(</span><span class="str">"daniel_sieve_2(1000000)"</span><span class="pun">,</span><span class="pln">
</span><span class="pun">...</span><span class="pln">                    </span><span class="str">"from sieves import daniel_sieve_2"</span><span class="pun">)</span><span class="pln">
</span><span class="pun">&gt;&gt;&gt;</span><span class="pln">prev </span><span class="pun">=</span><span class="pln"> timeit</span><span class="pun">.</span><span class="typ">Timer</span><span class="pun">(</span><span class="str">"get_primes_erat(1000000)"</span><span class="pun">,</span><span class="pln">
</span><span class="pun">...</span><span class="pln">                    </span><span class="str">"from sieves import get_primes_erat"</span><span class="pun">)</span><span class="pln">
</span><span class="pun">&gt;&gt;&gt;</span><span class="kwd">print</span><span class="pln"> </span><span class="str">"Mine: {0:0.4f} ms"</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">min</span><span class="pun">(</span><span class="pln">mine</span><span class="pun">.</span><span class="pln">repeat</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">))*</span><span class="lit">1000</span><span class="pun">)</span><span class="pln">
</span><span class="typ">Mine</span><span class="pun">:</span><span class="pln"> </span><span class="lit">428.9446</span><span class="pln"> ms
</span><span class="pun">&gt;&gt;&gt;</span><span class="kwd">print</span><span class="pln"> </span><span class="str">"Previous Best {0:0.4f} ms"</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">min</span><span class="pun">(</span><span class="pln">prev</span><span class="pun">.</span><span class="pln">repeat</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">))*</span><span class="lit">1000</span><span class="pun">)</span><span class="pln">
</span><span class="typ">Previous</span><span class="pln"> </span><span class="typ">Best</span><span class="pln"> </span><span class="lit">621.3581</span><span class="pln"> ms</span></code></pre>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/2070107" title="short permalink to this answer" class="short-link" id="link-post-2070107">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/2070107/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-01-15 07:41:25Z" class="relativetime">Jan 15 '10 at 7:41</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/207432/daniel-g"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/6813ca950db3b749647569d79b96fbf9" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/207432/daniel-g">Daniel G</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 29,111" dir="ltr">29.1k</span><span title="4 gold badges"><span class="badge1"></span><span class="badgecount">4</span></span><span title="30 silver badges"><span class="badge2"></span><span class="badgecount">30</span></span><span title="36 bronze badges"><span class="badge3"></span><span class="badgecount">36</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2070107" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2070107" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="2106069"></a>
<div id="answer-2106069" class="answer" data-answerid="2106069" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2106069">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">3</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>A deterministic implementation of Miller-Rabin's Primality test on the assumption that N &lt; 9,080,191</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">import</span><span class="pln"> sys
</span><span class="kwd">import</span><span class="pln"> random

</span><span class="kwd">def</span><span class="pln"> miller_rabin_pass</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">):</span><span class="pln">
    d </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> d </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
        d </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        s </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">

    a_to_power </span><span class="pun">=</span><span class="pln"> pow</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> a_to_power </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">s</span><span class="pun">-</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> a_to_power </span><span class="pun">==</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">
        a_to_power </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a_to_power </span><span class="pun">*</span><span class="pln"> a_to_power</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n
    </span><span class="kwd">return</span><span class="pln"> a_to_power </span><span class="pun">==</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">


</span><span class="kwd">def</span><span class="pln"> miller_rabin</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> a </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">37</span><span class="pun">,</span><span class="pln"> </span><span class="lit">73</span><span class="pun">]:</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> miller_rabin_pass</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">


n </span><span class="pun">=</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">sys</span><span class="pun">.</span><span class="pln">argv</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span><span class="pln">
primes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> p </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> miller_rabin</span><span class="pun">(</span><span class="pln">p</span><span class="pun">):</span><span class="pln">
    primes</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">p</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">print</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">primes</span><span class="pun">)</span></code></pre>

<p>According to the article on Wikipedia (<a href="http://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test" rel="nofollow noreferrer">http://en.wikipedia.org/wiki/Miller–Rabin_primality_test</a>) testing N &lt; 9,080,191 for a = 2,3,37, and 73 is enough to decide whether N is composite or not.</p>

<p>And I adapted the source code from the probabilistic implementation of original Miller-Rabin's test found here: <a href="http://en.literateprograms.org/Miller-Rabin_primality_test_(Python)" rel="nofollow noreferrer">http://en.literateprograms.org/Miller-Rabin_primality_test_(Python)</a></p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/2106069" title="short permalink to this answer" class="short-link" id="link-post-2106069">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/2106069/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2010-01-21 00:17:45Z" class="relativetime">Jan 21 '10 at 0:17</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/252684/ruggiero-spearman"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/f5921e405ea478c8cf28bc13c16691a2" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/252684/ruggiero-spearman">Ruggiero Spearman</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">3,285</span><span title="4 gold badges"><span class="badge1"></span><span class="badgecount">4</span></span><span title="19 silver badges"><span class="badge2"></span><span class="badgecount">19</span></span><span title="35 bronze badges"><span class="badge3"></span><span class="badgecount">35</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2106069" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-2043273" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Thank's for the Miller-Rabin primality test, but this code is actually slower and is not providing the correct results. 37 is prime and does not pass the test.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/230636/jbochi" title="16,903 reputation" class="comment-user owner">jbochi</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2043273_2106069"><span title="2010-01-21 10:07:20Z" class="relativetime-clean">Jan 21 '10 at 10:07</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-2043591" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">I guess 37 is one of the special cases, my bad. I was hopeful about the deterministic version though :)</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/252684/ruggiero-spearman" title="3,285 reputation" class="comment-user">Ruggiero Spearman</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2043591_2106069"><span title="2010-01-21 11:07:42Z" class="relativetime-clean">Jan 21 '10 at 11:07</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-30170527" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">There isn't any special case for rabin miller.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/807631/juli%c3%a1n" title="942 reputation" class="comment-user">Julián</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment30170527_2106069"><span title="2013-11-26 23:37:16Z" class="relativetime-clean">Nov 26 '13 at 23:37</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-31125642" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">2</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">You misread the article. It is 31, not 37. This is why your implementation fails.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/924537/logan" title="903 reputation" class="comment-user">Logan</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment31125642_2106069"><span title="2013-12-24 22:36:41Z" class="relativetime-clean">Dec 24 '13 at 22:36</span></a></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2106069" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="3638617"></a>
<div id="answer-3638617" class="answer" data-answerid="3638617" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="3638617">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">3</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>A slightly different implementation of a half sieve using Numpy:</p>

<p><a href="http://rebrained.com/?p=458" rel="nofollow noreferrer">http://rebrained.com/?p=458</a></p>

<pre>import math
import numpy
def prime6(upto):
    primes=numpy.arange(3,upto+1,2)
    isprime=numpy.ones((upto-1)/2,dtype=bool)
    for factor in primes[:int(math.sqrt(upto))]:
        if isprime[(factor-2)/2]: isprime[(factor*3-2)/2:(upto-1)/2:factor]=0
    return numpy.insert(primes[isprime],0,2)
</pre>

<p>Can someone compare this with the other timings?  On my machine it seems pretty comparable to the other Numpy half-sieve.</p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/3638617" title="short permalink to this answer" class="short-link" id="link-post-3638617">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/3638617/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2010-09-03 18:37:02Z" class="relativetime">Sep 3 '10 at 18:37</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/439236/nolfonzo"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/3b744e07efc4766c135b33a74056c9e1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/439236/nolfonzo">nolfonzo</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">31</span><span title="1 bronze badge"><span class="badge3"></span><span class="badgecount">1</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-3638617" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-3826399" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy"><code>upto=10**6</code>: <code>primesfrom2to()</code> - 7 ms; <code>prime6()</code> - 12 ms <a href="http://ideone.com/oDg2Y" rel="nofollow noreferrer">ideone.com/oDg2Y</a></span>
                    –&nbsp;<a href="https://stackoverflow.com/users/4279/j-f-sebastian" title="208,500 reputation" class="comment-user">J.F. Sebastian</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment3826399_3638617"><span title="2010-09-04 01:57:35Z" class="relativetime-clean">Sep 4 '10 at 1:57</span></a></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-3638617" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="14972126"></a>
<div id="answer-14972126" class="answer" data-answerid="14972126" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="14972126">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">2</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>First time using python, so some of the methods I use in this might seem a bit cumbersome. I just straight converted my c++ code to python and this is what I have (albeit a tad bit slowww in python)</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="com">#!/usr/bin/env python</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> time

</span><span class="kwd">def</span><span class="pln"> </span><span class="typ">GetPrimes</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">

    </span><span class="typ">Sieve</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)]</span><span class="pln">

    </span><span class="typ">Done</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    w </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln">

    </span><span class="kwd">while</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> </span><span class="typ">Done</span><span class="pun">:</span><span class="pln">

        </span><span class="kwd">for</span><span class="pln"> q </span><span class="kwd">in</span><span class="pln"> xrange </span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">):</span><span class="pln">
            </span><span class="typ">Prod</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> w</span><span class="pun">*</span><span class="pln">q
            </span><span class="kwd">if</span><span class="pln"> </span><span class="typ">Prod</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">:</span><span class="pln">
                </span><span class="typ">Sieve</span><span class="pun">[</span><span class="typ">Prod</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
            </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">break</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> w </span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n</span><span class="pun">/</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
            </span><span class="typ">Done</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">
        w </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Sieve</span><span class="pln">



start </span><span class="pun">=</span><span class="pln"> time</span><span class="pun">.</span><span class="pln">clock</span><span class="pun">()</span><span class="pln">

d </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10000000</span><span class="pln">
</span><span class="typ">Primes</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPrimes</span><span class="pun">(</span><span class="pln">d</span><span class="pun">)</span><span class="pln">

count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="com">#This is for 2</span><span class="pln">

</span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> xrange </span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="typ">Primes</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]:</span><span class="pln">
        count</span><span class="pun">+=</span><span class="lit">1</span><span class="pln">

elapsed </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">time</span><span class="pun">.</span><span class="pln">clock</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> start</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">print</span><span class="pln"> </span><span class="str">"\nFound"</span><span class="pun">,</span><span class="pln"> count</span><span class="pun">,</span><span class="pln"> </span><span class="str">"primes in"</span><span class="pun">,</span><span class="pln"> elapsed</span><span class="pun">,</span><span class="pln"> </span><span class="str">"seconds!\n"</span></code></pre>

<blockquote>
  <p>pythonw Primes.py</p>
  
  <p>Found 664579 primes in 12.799119 seconds!</p>
</blockquote>

<pre class="lang-py prettyprint prettyprinted"><code><span class="com">#!/usr/bin/env python</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> time

</span><span class="kwd">def</span><span class="pln"> </span><span class="typ">GetPrimes2</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">

    </span><span class="typ">Sieve</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)]</span><span class="pln">

    </span><span class="kwd">for</span><span class="pln"> q </span><span class="kwd">in</span><span class="pln"> xrange </span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        k </span><span class="pun">=</span><span class="pln"> q
        </span><span class="kwd">for</span><span class="pln"> y </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">k</span><span class="pun">*</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">*</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
            </span><span class="typ">Sieve</span><span class="pun">[</span><span class="pln">y</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Sieve</span><span class="pln">



start </span><span class="pun">=</span><span class="pln"> time</span><span class="pun">.</span><span class="pln">clock</span><span class="pun">()</span><span class="pln">

d </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10000000</span><span class="pln">
</span><span class="typ">Primes</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPrimes2</span><span class="pun">(</span><span class="pln">d</span><span class="pun">)</span><span class="pln">

count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="com">#This is for 2</span><span class="pln">

</span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> xrange </span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="typ">Primes</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]:</span><span class="pln">
        count</span><span class="pun">+=</span><span class="lit">1</span><span class="pln">

elapsed </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">time</span><span class="pun">.</span><span class="pln">clock</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> start</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">print</span><span class="pln"> </span><span class="str">"\nFound"</span><span class="pun">,</span><span class="pln"> count</span><span class="pun">,</span><span class="pln"> </span><span class="str">"primes in"</span><span class="pun">,</span><span class="pln"> elapsed</span><span class="pun">,</span><span class="pln"> </span><span class="str">"seconds!\n"</span></code></pre>

<blockquote>
  <p>pythonw Primes2.py</p>
  
  <p>Found 664579 primes in 10.230172 seconds!</p>
</blockquote>

<pre class="lang-py prettyprint prettyprinted"><code><span class="com">#!/usr/bin/env python</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> time

</span><span class="kwd">def</span><span class="pln"> </span><span class="typ">GetPrimes3</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">

    </span><span class="typ">Sieve</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)]</span><span class="pln">

    </span><span class="kwd">for</span><span class="pln"> q </span><span class="kwd">in</span><span class="pln"> xrange </span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        k </span><span class="pun">=</span><span class="pln"> q
        </span><span class="kwd">for</span><span class="pln"> y </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">k</span><span class="pun">*</span><span class="pln">k</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">):</span><span class="pln">
            </span><span class="typ">Sieve</span><span class="pun">[</span><span class="pln">y</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Sieve</span><span class="pln">



start </span><span class="pun">=</span><span class="pln"> time</span><span class="pun">.</span><span class="pln">clock</span><span class="pun">()</span><span class="pln">

d </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10000000</span><span class="pln">
</span><span class="typ">Primes</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPrimes3</span><span class="pun">(</span><span class="pln">d</span><span class="pun">)</span><span class="pln">

count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="com">#This is for 2</span><span class="pln">

</span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> xrange </span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="typ">Primes</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]:</span><span class="pln">
        count</span><span class="pun">+=</span><span class="lit">1</span><span class="pln">

elapsed </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">time</span><span class="pun">.</span><span class="pln">clock</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> start</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">print</span><span class="pln"> </span><span class="str">"\nFound"</span><span class="pun">,</span><span class="pln"> count</span><span class="pun">,</span><span class="pln"> </span><span class="str">"primes in"</span><span class="pun">,</span><span class="pln"> elapsed</span><span class="pun">,</span><span class="pln"> </span><span class="str">"seconds!\n"</span></code></pre>

<blockquote>
  <p>python Primes2.py</p>
  
  <p>Found 664579 primes in 7.113776 seconds!</p>
</blockquote>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/14972126" title="short permalink to this answer" class="short-link" id="link-post-14972126">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/14972126/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/14972126/revisions" title="show all edits to this post">edited <span title="2013-02-20 23:12:55Z" class="relativetime">Feb 20 '13 at 23:12</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2013-02-20 04:06:22Z" class="relativetime">Feb 20 '13 at 4:06</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/2089675/smac89"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/sBz5q.jpg" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/2089675/smac89">smac89</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">7,233</span><span title="3 gold badges"><span class="badge1"></span><span class="badgecount">3</span></span><span title="18 silver badges"><span class="badge2"></span><span class="badgecount">18</span></span><span title="52 bronze badges"><span class="badge3"></span><span class="badgecount">52</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-14972126" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-14972126" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="18944432"></a>
<div id="answer-18944432" class="answer" data-answerid="18944432" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="18944432">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">2</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>I know the competition is closed for some years. …</p>

<p>Nonetheless this is my suggestion for a pure python prime sieve, based on omitting the multiples of 2, 3 and 5 by using appropriate steps while processing the sieve forward. Nonetheless it is actually slower for N&lt;10^9 than @Robert William Hanks superior solutions rwh_primes2 and rwh_primes1. By using a ctypes.c_ushort sieve array above 1.5* 10^8 it is somehow adaptive to memory limits.</p>

<p>10^6</p>

<p>$ python -mtimeit -s"import primeSieveSpeedComp" "primeSieveSpeedComp.primeSieveSeq(1000000)"
10 loops, best of 3: 46.7 msec per loop</p>

<blockquote>
  <p>to compare:$ python -mtimeit -s"import primeSieveSpeedComp"
  "primeSieveSpeedComp.rwh_primes1(1000000)" 10 loops, best of 3: 43.2
  msec per loop
  to compare: $ python -m timeit -s"import primeSieveSpeedComp"
  "primeSieveSpeedComp.rwh_primes2(1000000)" 10 loops, best of 3: 34.5
  msec per loop</p>
</blockquote>

<p>10^7</p>

<p>$ python -mtimeit -s"import primeSieveSpeedComp" "primeSieveSpeedComp.primeSieveSeq(10000000)"
10 loops, best of 3: 530 msec per loop</p>

<blockquote>
  <p>to compare:$ python -mtimeit -s"import primeSieveSpeedComp"
  "primeSieveSpeedComp.rwh_primes1(10000000)" 10 loops, best of 3: 494
  msec per loop
  to compare: $ python -m timeit -s"import primeSieveSpeedComp"
  "primeSieveSpeedComp.rwh_primes2(10000000)" 10 loops, best of 3: 375
  msec per loop</p>
</blockquote>

<p>10^8</p>

<p>$ python -mtimeit -s"import primeSieveSpeedComp" "primeSieveSpeedComp.primeSieveSeq(100000000)"
10 loops, best of 3: 5.55 sec per loop</p>

<blockquote>
  <p>to compare: $ python -mtimeit -s"import primeSieveSpeedComp"
  "primeSieveSpeedComp.rwh_primes1(100000000)" 10 loops, best of 3: 5.33
  sec per loop
  to compare: $ python -m timeit -s"import primeSieveSpeedComp"
  "primeSieveSpeedComp.rwh_primes2(100000000)" 10 loops, best of 3: 3.95
  sec per loop</p>
</blockquote>

<p>10^9</p>

<p>$ python -mtimeit -s"import primeSieveSpeedComp" "primeSieveSpeedComp.primeSieveSeq(1000000000)"
10 loops, best of 3: <strong>61.2</strong> sec per loop</p>

<blockquote>
  <p>to compare: $ python -mtimeit -n 3 -s"import primeSieveSpeedComp"
  "primeSieveSpeedComp.rwh_primes1(1000000000)" 3 loops, best of 3: <strong>97.8</strong>
  sec per loop</p>
  
  <p>to compare: $ python -m timeit -s"import primeSieveSpeedComp"
  "primeSieveSpeedComp.rwh_primes2(1000000000)" 10 loops, best of 3:
  41.9 sec per loop</p>
</blockquote>

<p>You may copy the code below into ubuntus primeSieveSpeedComp to review this tests.</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">def</span><span class="pln"> primeSieveSeq</span><span class="pun">(</span><span class="pln">MAX_Int</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> MAX_Int </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">5</span><span class="pun">*</span><span class="lit">10</span><span class="pun">**</span><span class="lit">8</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">import</span><span class="pln"> ctypes
        int16Array </span><span class="pun">=</span><span class="pln"> ctypes</span><span class="pun">.</span><span class="pln">c_ushort </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">MAX_Int </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        sieve </span><span class="pun">=</span><span class="pln"> int16Array</span><span class="pun">()</span><span class="pln">
        </span><span class="com">#print 'uses ctypes "unsigned short int Array"'</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        sieve </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">MAX_Int </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">False</span><span class="pun">]</span><span class="pln">
        </span><span class="com">#print 'uses python list() of long long int'</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> MAX_Int </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">10</span><span class="pun">**</span><span class="lit">8</span><span class="pun">:</span><span class="pln">
        sieve</span><span class="pun">[</span><span class="lit">4</span><span class="pun">::</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]*((</span><span class="pln">MAX_Int </span><span class="pun">-</span><span class="pln"> </span><span class="lit">8</span><span class="pun">)/</span><span class="lit">6</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        sieve</span><span class="pun">[</span><span class="lit">12</span><span class="pun">::</span><span class="lit">5</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]*((</span><span class="pln">MAX_Int </span><span class="pun">-</span><span class="pln"> </span><span class="lit">24</span><span class="pun">)/</span><span class="lit">10</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    r </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">]</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">int</span><span class="pun">(</span><span class="pln">MAX_Int</span><span class="pun">**</span><span class="lit">0.5</span><span class="pun">)/</span><span class="lit">30</span><span class="pun">+</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">3</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
            n2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">n2</span><span class="pun">)</span><span class="pln">
            n2q </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n2</span><span class="pun">**</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">n2q</span><span class="pun">::</span><span class="pln">n2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]*(((</span><span class="pln">MAX_Int </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> n2q </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> n2 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
            n2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">n2</span><span class="pun">)</span><span class="pln">
            n2q </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n2</span><span class="pun">**</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">n2q</span><span class="pun">::</span><span class="pln">n2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]*(((</span><span class="pln">MAX_Int </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> n2q </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> n2 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
            n2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">n2</span><span class="pun">)</span><span class="pln">
            n2q </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n2</span><span class="pun">**</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">n2q</span><span class="pun">::</span><span class="pln">n2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]*(((</span><span class="pln">MAX_Int </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> n2q </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> n2 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
            n2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">n2</span><span class="pun">)</span><span class="pln">
            n2q </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n2</span><span class="pun">**</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">n2q</span><span class="pun">::</span><span class="pln">n2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]*(((</span><span class="pln">MAX_Int </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> n2q </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> n2 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
            n2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">n2</span><span class="pun">)</span><span class="pln">
            n2q </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n2</span><span class="pun">**</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">n2q</span><span class="pun">::</span><span class="pln">n2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]*(((</span><span class="pln">MAX_Int </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> n2q </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> n2 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
            n2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">n2</span><span class="pun">)</span><span class="pln">
            n2q </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n2</span><span class="pun">**</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">n2q</span><span class="pun">::</span><span class="pln">n2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]*(((</span><span class="pln">MAX_Int </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> n2q </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> n2 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">3</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
            n2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">n2</span><span class="pun">)</span><span class="pln">
            n2q </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n2</span><span class="pun">**</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">n2q</span><span class="pun">::</span><span class="pln">n2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]*(((</span><span class="pln">MAX_Int </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> n2q </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> n2 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
            n2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">n2</span><span class="pun">)</span><span class="pln">
            n2q </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n2</span><span class="pun">**</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            sieve</span><span class="pun">[</span><span class="pln">n2q</span><span class="pun">::</span><span class="pln">n2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]*(((</span><span class="pln">MAX_Int </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> n2q </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> n2 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> MAX_Int </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">10</span><span class="pun">**</span><span class="lit">8</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">]+[(</span><span class="pln">p </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> p </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">[</span><span class="pln">n </span><span class="kwd">for</span><span class="pln"> n </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> MAX_Int </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]]]</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">try</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">((</span><span class="pln">MAX_Int</span><span class="pun">-</span><span class="lit">2</span><span class="pun">*</span><span class="pln">n</span><span class="pun">)/</span><span class="lit">30</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">):</span><span class="pln">
            n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">3</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
                r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">((</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
                r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">((</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
                r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">((</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
                r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">((</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
                r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">((</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
                r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">((</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">3</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
                r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">((</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            n </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]:</span><span class="pln">
                r</span><span class="pun">.</span><span class="pln">append</span><span class="pun">((</span><span class="pln">n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">except</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">pass</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> r</span></code></pre>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/18944432" title="short permalink to this answer" class="short-link" id="link-post-18944432">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/18944432/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/18944432/revisions" title="show all edits to this post">edited <span title="2013-09-25 07:33:23Z" class="relativetime">Sep 25 '13 at 7:33</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2013-09-22 13:35:58Z" class="relativetime">Sep 22 '13 at 13:35</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/2804068/abri"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/bba54618c0b0ddabd4b666cf96002f4a" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/2804068/abri">ABri</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">454</span><span title="4 silver badges"><span class="badge2"></span><span class="badgecount">4</span></span><span title="9 bronze badges"><span class="badge3"></span><span class="badgecount">9</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-18944432" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-59215245" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">to visualize your test results, plot them on log-log scale, to <i>see</i> and compare the <a href="https://en.wikipedia.org/wiki/Analysis_of_algorithms#Empirical_orders_of_growth" rel="nofollow noreferrer">empirical orders of growth</a>.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/849891/will-ness" title="32,974 reputation" class="comment-user">Will Ness</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment59215245_18944432"><span title="2016-03-03 12:18:52Z" class="relativetime-clean">Mar 3 '16 at 12:18</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-59580227" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@ Will thanks for the input, i'll have this in mind the next time i need such comparison</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/2804068/abri" title="454 reputation" class="comment-user">ABri</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment59580227_18944432"><span title="2016-03-12 20:04:06Z" class="relativetime-clean">Mar 12 '16 at 20:04</span></a></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-18944432" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="40101683"></a>
<div id="answer-40101683" class="answer" data-answerid="40101683" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="40101683">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">2</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>I tested  some <a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n?answertab=active#tab-top">unutbu's functions</a>, i computed it with hungred millions number</p>

<p>The winners are the functions that use numpy library, </p>

<p><strong>Note</strong>: It would also interesting make a memory utilization test :)</p>

<p><a href="./python - Fastest way to list all primes below N - Stack Overflow_files/LYfjc.png" rel="nofollow noreferrer"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/LYfjc.png" alt="Computation time result"></a></p>

<p><strong>Sample code</strong></p>

<p><a href="https://github.com/badele/prime-number" rel="nofollow noreferrer">Complete code on my github repository</a></p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="com">#!/usr/bin/env python</span><span class="pln">

</span><span class="kwd">import</span><span class="pln"> lib
</span><span class="kwd">import</span><span class="pln"> timeit
</span><span class="kwd">import</span><span class="pln"> sys
</span><span class="kwd">import</span><span class="pln"> math
</span><span class="kwd">import</span><span class="pln"> datetime

</span><span class="kwd">import</span><span class="pln"> prettyplotlib </span><span class="kwd">as</span><span class="pln"> ppl
</span><span class="kwd">import</span><span class="pln"> numpy </span><span class="kwd">as</span><span class="pln"> np

</span><span class="kwd">import</span><span class="pln"> matplotlib</span><span class="pun">.</span><span class="pln">pyplot </span><span class="kwd">as</span><span class="pln"> plt
</span><span class="kwd">from</span><span class="pln"> prettyplotlib </span><span class="kwd">import</span><span class="pln"> brewer2mpl

primenumbers_gen </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">
    </span><span class="str">'sieveOfEratosthenes'</span><span class="pun">,</span><span class="pln">
    </span><span class="str">'ambi_sieve'</span><span class="pun">,</span><span class="pln">
    </span><span class="str">'ambi_sieve_plain'</span><span class="pun">,</span><span class="pln">
    </span><span class="str">'sundaram3'</span><span class="pun">,</span><span class="pln">
    </span><span class="str">'sieve_wheel_30'</span><span class="pun">,</span><span class="pln">
    </span><span class="str">'primesfrom3to'</span><span class="pun">,</span><span class="pln">
    </span><span class="str">'primesfrom2to'</span><span class="pun">,</span><span class="pln">
    </span><span class="str">'rwh_primes'</span><span class="pun">,</span><span class="pln">
    </span><span class="str">'rwh_primes1'</span><span class="pun">,</span><span class="pln">
    </span><span class="str">'rwh_primes2'</span><span class="pun">,</span><span class="pln">
</span><span class="pun">]</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> human_format</span><span class="pun">(</span><span class="pln">num</span><span class="pun">):</span><span class="pln">
    </span><span class="com"># https://stackoverflow.com/questions/579310/formatting-long-numbers-as-strings-in-python?answertab=active#tab-top</span><span class="pln">
    magnitude </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> abs</span><span class="pun">(</span><span class="pln">num</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">:</span><span class="pln">
        magnitude </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        num </span><span class="pun">/=</span><span class="pln"> </span><span class="lit">1000.0</span><span class="pln">
    </span><span class="com"># add more suffixes if you need them</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="str">'%.2f%s'</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">num</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="str">''</span><span class="pun">,</span><span class="pln"> </span><span class="str">'K'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'M'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'G'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'T'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'P'</span><span class="pun">][</span><span class="pln">magnitude</span><span class="pun">])</span><span class="pln">


</span><span class="kwd">if</span><span class="pln"> __name__</span><span class="pun">==</span><span class="str">'__main__'</span><span class="pun">:</span><span class="pln">

    </span><span class="com"># Vars</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10000000</span><span class="pln"> </span><span class="com"># number itereration generator</span><span class="pln">
    nbcol </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln"> </span><span class="com"># For decompose prime number generator</span><span class="pln">
    nb_benchloop </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="com"># Eliminate false positive value during the test (bench average time)</span><span class="pln">
    datetimeformat </span><span class="pun">=</span><span class="pln"> </span><span class="str">'%Y-%m-%d %H:%M:%S.%f'</span><span class="pln">
    config </span><span class="pun">=</span><span class="pln"> </span><span class="str">'from __main__ import n; import lib'</span><span class="pln">
    primenumbers_gen </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="str">'sieveOfEratosthenes'</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">'color'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'b'</span><span class="pun">},</span><span class="pln">
        </span><span class="str">'ambi_sieve'</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">'color'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'b'</span><span class="pun">},</span><span class="pln">
        </span><span class="str">'ambi_sieve_plain'</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">'color'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'b'</span><span class="pun">},</span><span class="pln">
         </span><span class="str">'sundaram3'</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">'color'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'b'</span><span class="pun">},</span><span class="pln">
        </span><span class="str">'sieve_wheel_30'</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">'color'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'b'</span><span class="pun">},</span><span class="pln">
</span><span class="com"># # #        'primesfrom2to': {'color': 'b'},</span><span class="pln">
        </span><span class="str">'primesfrom3to'</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">'color'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'b'</span><span class="pun">},</span><span class="pln">
        </span><span class="com"># 'rwh_primes': {'color': 'b'},</span><span class="pln">
        </span><span class="com"># 'rwh_primes1': {'color': 'b'},</span><span class="pln">
        </span><span class="str">'rwh_primes2'</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">'color'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'b'</span><span class="pun">},</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">


    </span><span class="com"># Get n in command line</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">sys</span><span class="pun">.</span><span class="pln">argv</span><span class="pun">)&gt;</span><span class="lit">1</span><span class="pun">:</span><span class="pln">
        n </span><span class="pun">=</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">sys</span><span class="pun">.</span><span class="pln">argv</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span><span class="pln">

    step </span><span class="pun">=</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">math</span><span class="pun">.</span><span class="pln">ceil</span><span class="pun">(</span><span class="pln">n </span><span class="pun">/</span><span class="pln"> float</span><span class="pun">(</span><span class="pln">nbcol</span><span class="pun">)))</span><span class="pln">
    nbs </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">array</span><span class="pun">([</span><span class="pln">i </span><span class="pun">*</span><span class="pln"> step </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">nbcol</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)])</span><span class="pln">
    set2 </span><span class="pun">=</span><span class="pln"> brewer2mpl</span><span class="pun">.</span><span class="pln">get_map</span><span class="pun">(</span><span class="str">'Paired'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'qualitative'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">12</span><span class="pun">).</span><span class="pln">mpl_colors

    </span><span class="kwd">print</span><span class="pln"> datetime</span><span class="pun">.</span><span class="pln">datetime</span><span class="pun">.</span><span class="pln">now</span><span class="pun">().</span><span class="pln">strftime</span><span class="pun">(</span><span class="pln">datetimeformat</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"Compute prime number to %(n)s"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> locals</span><span class="pun">())</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="str">""</span><span class="pun">)</span><span class="pln">

    results </span><span class="pun">=</span><span class="pln"> dict</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> pgen </span><span class="kwd">in</span><span class="pln"> primenumbers_gen</span><span class="pun">:</span><span class="pln">
        results</span><span class="pun">[</span><span class="pln">pgen</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dict</span><span class="pun">()</span><span class="pln">
        benchtimes </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> n </span><span class="kwd">in</span><span class="pln"> nbs</span><span class="pun">:</span><span class="pln">
            t </span><span class="pun">=</span><span class="pln"> timeit</span><span class="pun">.</span><span class="typ">Timer</span><span class="pun">(</span><span class="str">"lib.%(pgen)s(n)"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> locals</span><span class="pun">(),</span><span class="pln"> setup</span><span class="pun">=</span><span class="pln">config</span><span class="pun">)</span><span class="pln">
            execute_times </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">.</span><span class="pln">repeat</span><span class="pun">(</span><span class="pln">repeat</span><span class="pun">=</span><span class="pln">nb_benchloop</span><span class="pun">,</span><span class="pln">number</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            benchtime </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">mean</span><span class="pun">(</span><span class="pln">execute_times</span><span class="pun">)</span><span class="pln">
            benchtimes</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">benchtime</span><span class="pun">)</span><span class="pln">
        results</span><span class="pun">[</span><span class="pln">pgen</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">'benchtimes'</span><span class="pun">:</span><span class="pln">np</span><span class="pun">.</span><span class="pln">array</span><span class="pun">(</span><span class="pln">benchtimes</span><span class="pun">)}</span><span class="pln">

fig</span><span class="pun">,</span><span class="pln"> ax </span><span class="pun">=</span><span class="pln"> plt</span><span class="pun">.</span><span class="pln">subplots</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
plt</span><span class="pun">.</span><span class="pln">ylabel</span><span class="pun">(</span><span class="str">'Computation time (in second)'</span><span class="pun">)</span><span class="pln">
plt</span><span class="pun">.</span><span class="pln">xlabel</span><span class="pun">(</span><span class="str">'Numbers computed'</span><span class="pun">)</span><span class="pln">
i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> pgen </span><span class="kwd">in</span><span class="pln"> primenumbers_gen</span><span class="pun">:</span><span class="pln">

    bench </span><span class="pun">=</span><span class="pln"> results</span><span class="pun">[</span><span class="pln">pgen</span><span class="pun">][</span><span class="str">'benchtimes'</span><span class="pun">]</span><span class="pln">
    avgs </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">divide</span><span class="pun">(</span><span class="pln">bench</span><span class="pun">,</span><span class="pln">nbs</span><span class="pun">)</span><span class="pln">
    avg </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">average</span><span class="pun">(</span><span class="pln">bench</span><span class="pun">,</span><span class="pln"> weights</span><span class="pun">=</span><span class="pln">nbs</span><span class="pun">)</span><span class="pln">

    </span><span class="com"># Compute linear regression</span><span class="pln">
    A </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">vstack</span><span class="pun">([</span><span class="pln">nbs</span><span class="pun">,</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">ones</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">nbs</span><span class="pun">))]).</span><span class="pln">T
    a</span><span class="pun">,</span><span class="pln"> b </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">linalg</span><span class="pun">.</span><span class="pln">lstsq</span><span class="pun">(</span><span class="pln">A</span><span class="pun">,</span><span class="pln"> nbs</span><span class="pun">*</span><span class="pln">avgs</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">

    </span><span class="com"># Plot</span><span class="pln">
    i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="com">#label="%(pgen)s" % locals()</span><span class="pln">
    </span><span class="com">#ppl.plot(nbs, nbs*avgs, label=label, lw=1, linestyle='--', color=set2[i % 12])</span><span class="pln">
    label</span><span class="pun">=</span><span class="str">"%(pgen)s avg"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> locals</span><span class="pun">()</span><span class="pln">
    ppl</span><span class="pun">.</span><span class="pln">plot</span><span class="pun">(</span><span class="pln">nbs</span><span class="pun">,</span><span class="pln"> a </span><span class="pun">*</span><span class="pln"> nbs </span><span class="pun">+</span><span class="pln"> b</span><span class="pun">,</span><span class="pln"> label</span><span class="pun">=</span><span class="pln">label</span><span class="pun">,</span><span class="pln"> lw</span><span class="pun">=</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> color</span><span class="pun">=</span><span class="pln">set2</span><span class="pun">[</span><span class="pln">i </span><span class="pun">%</span><span class="pln"> </span><span class="lit">12</span><span class="pun">])</span><span class="pln">
</span><span class="kwd">print</span><span class="pln"> datetime</span><span class="pun">.</span><span class="pln">datetime</span><span class="pun">.</span><span class="pln">now</span><span class="pun">().</span><span class="pln">strftime</span><span class="pun">(</span><span class="pln">datetimeformat</span><span class="pun">)</span><span class="pln">

ppl</span><span class="pun">.</span><span class="pln">legend</span><span class="pun">(</span><span class="pln">ax</span><span class="pun">,</span><span class="pln"> loc</span><span class="pun">=</span><span class="str">'upper left'</span><span class="pun">,</span><span class="pln"> ncol</span><span class="pun">=</span><span class="lit">4</span><span class="pun">)</span><span class="pln">

</span><span class="com"># Change x axis label</span><span class="pln">
ax</span><span class="pun">.</span><span class="pln">get_xaxis</span><span class="pun">().</span><span class="pln">get_major_formatter</span><span class="pun">().</span><span class="pln">set_scientific</span><span class="pun">(</span><span class="kwd">False</span><span class="pun">)</span><span class="pln">
fig</span><span class="pun">.</span><span class="pln">canvas</span><span class="pun">.</span><span class="pln">draw</span><span class="pun">()</span><span class="pln">
labels </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">human_format</span><span class="pun">(</span><span class="pln">int</span><span class="pun">(</span><span class="pln">item</span><span class="pun">.</span><span class="pln">get_text</span><span class="pun">()))</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> item </span><span class="kwd">in</span><span class="pln"> ax</span><span class="pun">.</span><span class="pln">get_xticklabels</span><span class="pun">()]</span><span class="pln">

ax</span><span class="pun">.</span><span class="pln">set_xticklabels</span><span class="pun">(</span><span class="pln">labels</span><span class="pun">)</span><span class="pln">
ax </span><span class="pun">=</span><span class="pln"> plt</span><span class="pun">.</span><span class="pln">gca</span><span class="pun">()</span><span class="pln">

plt</span><span class="pun">.</span><span class="pln">show</span><span class="pun">()</span></code></pre>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/40101683" title="short permalink to this answer" class="short-link" id="link-post-40101683">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/40101683/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info user-hover">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/40101683/revisions" title="show all edits to this post">edited <span title="2017-05-23 12:10:30Z" class="relativetime">May 23 at 12:10</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/-1/community"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/a007be5a61f6aa8f3e85ae2fc18dd66e" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/-1/community">Community</a><span class="mod-flair" title="moderator">♦</span>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">1</span><span title="1 silver badge"><span class="badge2"></span><span class="badgecount">1</span></span>
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2016-10-18 07:05:58Z" class="relativetime">Oct 18 '16 at 7:05</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/2015612/bruno-adel%c3%a9"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/f4a804b1c2256bdefb9674105039dd98" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/2015612/bruno-adel%c3%a9">Bruno Adelé</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">548</span><span title="5 silver badges"><span class="badge2"></span><span class="badgecount">5</span></span><span title="11 bronze badges"><span class="badge3"></span><span class="badgecount">11</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-40101683" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-40101683" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="39879618"></a>
<div id="answer-39879618" class="answer" data-answerid="39879618" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="39879618">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">1</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>It's all written and tested. So there is no need to reinvent the wheel.</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pln">python </span><span class="pun">-</span><span class="pln">m timeit </span><span class="pun">-</span><span class="pln">r10 </span><span class="pun">-</span><span class="pln">s</span><span class="str">"from sympy import sieve"</span><span class="pln"> </span><span class="str">"primes = list(sieve.primerange(1, 10**6))"</span></code></pre>

<p>gives us a record breaking <strong>12.2 msec</strong>!</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="lit">10</span><span class="pln"> loops</span><span class="pun">,</span><span class="pln"> best of </span><span class="lit">10</span><span class="pun">:</span><span class="pln"> </span><span class="lit">12.2</span><span class="pln"> msec per loop</span></code></pre>

<p>If this is not fast enough, you can try PyPy:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pln">pypy </span><span class="pun">-</span><span class="pln">m timeit </span><span class="pun">-</span><span class="pln">r10 </span><span class="pun">-</span><span class="pln">s</span><span class="str">"from sympy import sieve"</span><span class="pln"> </span><span class="str">"primes = list(sieve.primerange(1, 10**6))"</span></code></pre>

<p>which results in:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="lit">10</span><span class="pln"> loops</span><span class="pun">,</span><span class="pln"> best of </span><span class="lit">10</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2.03</span><span class="pln"> msec per loop</span></code></pre>

<p>The answer with 247 up-votes lists 15.9 ms for the best solution.
Compare this!!!</p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/39879618" title="short permalink to this answer" class="short-link" id="link-post-39879618">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/39879618/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/39879618/revisions" title="show all edits to this post">edited <span title="2016-10-05 21:36:54Z" class="relativetime">Oct 5 '16 at 21:36</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2016-10-05 16:48:09Z" class="relativetime">Oct 5 '16 at 16:48</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/6731733/lifolofi"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/photo.jpg" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/6731733/lifolofi">lifolofi</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">37</span><span title="7 bronze badges"><span class="badge3"></span><span class="badgecount">7</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-39879618" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-67047713" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Somebody already provided the sympy solution, over a year ago.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/238704/james-k-polk" title="23,516 reputation" class="comment-user">James K Polk</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment67047713_39879618"><span title="2016-10-05 17:42:39Z" class="relativetime-clean">Oct 5 '16 at 17:42</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-67048435" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">But without measuring it. So your down-vote is unfair.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/6731733/lifolofi" title="37 reputation" class="comment-user">lifolofi</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment67048435_39879618"><span title="2016-10-05 18:05:06Z" class="relativetime-clean">Oct 5 '16 at 18:05</span></a></span>
                        <span class="edited-yes" title="this comment was edited 1 time"></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-39879618" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="2068436"></a>
<div id="answer-2068436" class="answer" data-answerid="2068436" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2068436">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>In general if you need fast number computation python is not the best choice. Today there are a lot of faster (and complex) algorithm. For example on my computer I got 2.2 second for your code, with Mathematica I got 0.088005.</p>

<p>First of all: do you need set?</p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/2068436" title="short permalink to this answer" class="short-link" id="link-post-2068436">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/2068436/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2010-01-14 23:56:33Z" class="relativetime">Jan 14 '10 at 23:56</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/238671/ruggero-turra"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/fc17c0a0eb63ef5ae4000782b5bb74d1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/238671/ruggero-turra">Ruggero Turra</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">5,764</span><span title="9 gold badges"><span class="badge1"></span><span class="badgecount">9</span></span><span title="41 silver badges"><span class="badge2"></span><span class="badgecount">41</span></span><span title="90 bronze badges"><span class="badge3"></span><span class="badgecount">90</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2068436" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-2000661" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">How you can say it? Have you tried the two solutions on the same machine?</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/238671/ruggero-turra" title="5,764 reputation" class="comment-user">Ruggero Turra</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2000661_2068436"><span title="2010-01-15 10:52:33Z" class="relativetime-clean">Jan 15 '10 at 10:52</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-2004885" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@wiso: He can use your proportions to extrapolate how long Mathematica will take on his machine.  If his extrapolation is wrong, then that could mean that the two algorithms are more or less efficient than usual depending on machine setup.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/18192/brian" title="17,264 reputation" class="comment-user">Brian</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2004885_2068436"><span title="2010-01-15 20:54:01Z" class="relativetime-clean">Jan 15 '10 at 20:54</span></a></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2068436" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="2068451"></a>
<div id="answer-2068451" class="answer" data-answerid="2068451" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2068451">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>The easiest optimization to implement is that if you want to check whether n is prime, you only have to check to see if n is divisible by a number up to square_root(n).
Is this for Project Euler?</p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/2068451" title="short permalink to this answer" class="short-link" id="link-post-2068451">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/2068451/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2010-01-15 00:01:05Z" class="relativetime">Jan 15 '10 at 0:01</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/127257/matt"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/e30f1d60c40c34f9395538cc52930281" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/127257/matt">Matt</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">8,733</span><span title="43 gold badges"><span class="badge1"></span><span class="badgecount">43</span></span><span title="148 silver badges"><span class="badge2"></span><span class="badgecount">148</span></span><span title="251 bronze badges"><span class="badge3"></span><span class="badgecount">251</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2068451" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-2040447" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">2</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">I think you misunderstood the problem.  jbochi wants to find the first N primes, not test an arbitrary N for primality. Trial division would probably be just about the <i>slowest</i> way of doing it -- the posted answers seem to be variations of the "Sieve of Eratosthenes" algorithm, which doesn't need to do division at all.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/153430/jim-lewis" title="29,265 reputation" class="comment-user">Jim Lewis</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2040447_2068451"><span title="2010-01-20 23:19:56Z" class="relativetime-clean">Jan 20 '10 at 23:19</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-2041250" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Indeed I did misread the question..</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/127257/matt" title="8,733 reputation" class="comment-user">Matt</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment2041250_2068451"><span title="2010-01-21 02:16:46Z" class="relativetime-clean">Jan 21 '10 at 2:16</span></a></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2068451" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="2129681"></a>
<div id="answer-2129681" class="answer" data-answerid="2129681" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="2129681">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>My guess is that the <em>fastest</em> of all ways is to hard code the primes in your code.</p>

<p>So why not just write a slow script that generates another source file that has all numbers hardwired in it, and then import that source file when you run your actual program.</p>

<p>Of course, this works only if you know the upper bound of N at compile time, but thus is the case for (almost) all project Euler problems. </p>

<p>&nbsp;</p>

<p><strong>PS:</strong> <em>I might be wrong though iff parsing the source with hard-wired primes is slower than computing them in the first place, but as far I know Python runs from compiled <code>.pyc</code> files so reading a binary array with all primes up to N should be bloody fast in that case.</em></p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/2129681" title="short permalink to this answer" class="short-link" id="link-post-2129681">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/2129681/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/2129681/revisions" title="show all edits to this post">edited <span title="2010-01-25 01:26:22Z" class="relativetime">Jan 25 '10 at 1:26</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2010-01-25 01:21:22Z" class="relativetime">Jan 25 '10 at 1:21</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/24468/akuhn"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/PWl6C.png" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/24468/akuhn">akuhn</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 20,326" dir="ltr">20.3k</span><span title="2 gold badges"><span class="badge1"></span><span class="badgecount">2</span></span><span title="44 silver badges"><span class="badge2"></span><span class="badgecount">44</span></span><span title="67 bronze badges"><span class="badge3"></span><span class="badgecount">67</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2129681" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-2129681" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="3476592"></a>
<div id="answer-3476592" class="answer" data-answerid="3476592" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="3476592">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>Sorry to bother but erat2() has a serious flaw in the algorithm.</p>

<p>While searching for the next composite, we need to test odd numbers only.
q,p both are odd; then q+p is even and doesn't need to be tested, but q+2*p is always odd. This eliminates the "if even" test in the while loop condition and saves about 30% of the runtime.</p>

<p>While we're at it: instead of the elegant 'D.pop(q,None)' get and delete method use 'if q in D: p=D[q],del D[q]' which is twice as fast! At least on my machine (P3-1Ghz).
So I suggest this implementation of this clever algorithm:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">def</span><span class="pln"> erat3</span><span class="pun">(</span><span class="pln"> </span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">from</span><span class="pln"> itertools </span><span class="kwd">import</span><span class="pln"> islice</span><span class="pun">,</span><span class="pln"> count

    </span><span class="com"># q is the running integer that's checked for primeness.</span><span class="pln">
    </span><span class="com"># yield 2 and no other even number thereafter</span><span class="pln">
    </span><span class="kwd">yield</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
    D </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
    </span><span class="com"># no need to mark D[4] as we will test odd numbers only</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> q </span><span class="kwd">in</span><span class="pln"> islice</span><span class="pun">(</span><span class="pln">count</span><span class="pun">(</span><span class="lit">3</span><span class="pun">),</span><span class="lit">0</span><span class="pun">,</span><span class="kwd">None</span><span class="pun">,</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> q </span><span class="kwd">in</span><span class="pln"> D</span><span class="pun">:</span><span class="pln">                  </span><span class="com">#  is composite</span><span class="pln">
            p </span><span class="pun">=</span><span class="pln"> D</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln">
            </span><span class="kwd">del</span><span class="pln"> D</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln">
            </span><span class="com"># q is composite. p=D[q] is the first prime that</span><span class="pln">
            </span><span class="com"># divides it. Since we've reached q, we no longer</span><span class="pln">
            </span><span class="com"># need it in the map, but we'll mark the next</span><span class="pln">
            </span><span class="com"># multiple of its witnesses to prepare for larger</span><span class="pln">
            </span><span class="com"># numbers.</span><span class="pln">
            x </span><span class="pun">=</span><span class="pln"> q </span><span class="pun">+</span><span class="pln"> p</span><span class="pun">+</span><span class="pln">p        </span><span class="com"># next odd(!) multiple</span><span class="pln">
            </span><span class="kwd">while</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> D</span><span class="pun">:</span><span class="pln">      </span><span class="com"># skip composites</span><span class="pln">
                x </span><span class="pun">+=</span><span class="pln"> p</span><span class="pun">+</span><span class="pln">p
            D</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">                  </span><span class="com"># is prime</span><span class="pln">
            </span><span class="com"># q is a new prime.</span><span class="pln">
            </span><span class="com"># Yield it and mark its first multiple that isn't</span><span class="pln">
            </span><span class="com"># already marked in previous iterations.</span><span class="pln">
            D</span><span class="pun">[</span><span class="pln">q</span><span class="pun">*</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> q
            </span><span class="kwd">yield</span><span class="pln"> q</span></code></pre>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/3476592" title="short permalink to this answer" class="short-link" id="link-post-3476592">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/3476592/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2010-08-13 12:04:55Z" class="relativetime">Aug 13 '10 at 12:04</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/1016274/user1016274"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/2c01f1ff90599b2cbaba251c5f200d1d" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/1016274/user1016274">user1016274</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">2,219</span><span title="1 gold badge"><span class="badge1"></span><span class="badgecount">1</span></span><span title="11 silver badges"><span class="badge2"></span><span class="badgecount">11</span></span><span title="13 bronze badges"><span class="badge3"></span><span class="badgecount">13</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-3476592" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-18180375" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">for a postponed addition of primes into the dict (until the square of a prime is seen in the input) see <a href="http://stackoverflow.com/a/10733621/849891">stackoverflow.com/a/10733621/849891</a> .</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/849891/will-ness" title="32,974 reputation" class="comment-user">Will Ness</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment18180375_3476592"><span title="2012-11-10 21:12:55Z" class="relativetime-clean">Nov 10 '12 at 21:12</span></a></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-3476592" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="3796455"></a>
<div id="answer-3796455" class="answer" data-answerid="3796455" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="3796455">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>The fastest method I've tried so far is based on the <a href="http://oreilly.com/pub/a/python/excerpt/pythonckbk_chap1/index1.html?page=last" rel="nofollow noreferrer">Python cookbook <code>erat2</code></a> function:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">import</span><span class="pln"> itertools </span><span class="kwd">as</span><span class="pln"> it
</span><span class="kwd">def</span><span class="pln"> erat2a</span><span class="pun">(</span><span class="pln"> </span><span class="pun">):</span><span class="pln">
    D </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">yield</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> q </span><span class="kwd">in</span><span class="pln"> it</span><span class="pun">.</span><span class="pln">islice</span><span class="pun">(</span><span class="pln">it</span><span class="pun">.</span><span class="pln">count</span><span class="pun">(</span><span class="lit">3</span><span class="pun">),</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        p </span><span class="pun">=</span><span class="pln"> D</span><span class="pun">.</span><span class="pln">pop</span><span class="pun">(</span><span class="pln">q</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> p </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">:</span><span class="pln">
            D</span><span class="pun">[</span><span class="pln">q</span><span class="pun">*</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> q
            </span><span class="kwd">yield</span><span class="pln"> q
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            x </span><span class="pun">=</span><span class="pln"> q </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*</span><span class="pln">p
            </span><span class="kwd">while</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> D</span><span class="pun">:</span><span class="pln">
                x </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*</span><span class="pln">p
            D</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span></code></pre>

<p>See <a href="https://stackoverflow.com/questions/2211990/how-to-implement-an-efficient-infinite-generator-of-prime-numbers-in-python/3796442#3796442">this</a> answer for an explanation of the speeding-up.</p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/3796455" title="short permalink to this answer" class="short-link" id="link-post-3796455">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/3796455/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info user-hover">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/3796455/revisions" title="show all edits to this post">edited <span title="2017-05-23 12:10:30Z" class="relativetime">May 23 at 12:10</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/-1/community"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/a007be5a61f6aa8f3e85ae2fc18dd66e" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/-1/community">Community</a><span class="mod-flair" title="moderator">♦</span>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">1</span><span title="1 silver badge"><span class="badge2"></span><span class="badgecount">1</span></span>
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-09-26 03:07:35Z" class="relativetime">Sep 26 '10 at 3:07</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/6899/tzot"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/132aeb33251a1eddee3efc87633c0af1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/6899/tzot">tzot</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 52,028" dir="ltr">52k</span><span title="18 gold badges"><span class="badge1"></span><span class="badgecount">18</span></span><span title="87 silver badges"><span class="badge2"></span><span class="badgecount">87</span></span><span title="162 bronze badges"><span class="badge3"></span><span class="badgecount">162</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-3796455" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-3796455" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="16004075"></a>
<div id="answer-16004075" class="answer" data-answerid="16004075" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="16004075">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>I may be late to the party but will have to add my own code for this. It uses approximately n/2 in space because we don't need to store even numbers and I also make use of the bitarray python module, further draStically cutting down on memory consumption and enabling computing all primes up to 1,000,000,000</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">from</span><span class="pln"> bitarray </span><span class="kwd">import</span><span class="pln"> bitarray
</span><span class="kwd">def</span><span class="pln"> primes_to</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
    size </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">//</span><span class="lit">2</span><span class="pln">
    sieve </span><span class="pun">=</span><span class="pln"> bitarray</span><span class="pun">(</span><span class="pln">size</span><span class="pun">)</span><span class="pln">
    sieve</span><span class="pun">.</span><span class="pln">setall</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    limit </span><span class="pun">=</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">**</span><span class="lit">0.5</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">limit</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> sieve</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
            val </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pln">
            sieve</span><span class="pun">[(</span><span class="pln">i</span><span class="pun">+</span><span class="pln">i</span><span class="pun">*</span><span class="pln">val</span><span class="pun">)::</span><span class="pln">val</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">*</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> v </span><span class="kwd">in</span><span class="pln"> enumerate</span><span class="pun">(</span><span class="pln">sieve</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> v </span><span class="kwd">and</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">]</span><span class="pln">

python </span><span class="pun">-</span><span class="pln">m timeit </span><span class="pun">-</span><span class="pln">n10 </span><span class="pun">-</span><span class="pln">s </span><span class="str">"import euler"</span><span class="pln"> </span><span class="str">"euler.primes_to(1000000000)"</span><span class="pln">
</span><span class="lit">10</span><span class="pln"> loops</span><span class="pun">,</span><span class="pln"> best of </span><span class="lit">3</span><span class="pun">:</span><span class="pln"> </span><span class="lit">46.5</span><span class="pln"> sec per loop</span></code></pre>

<p>This was run on a 64bit 2.4GHZ MAC OSX 10.8.3</p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/16004075" title="short permalink to this answer" class="short-link" id="link-post-16004075">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/16004075/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/16004075/revisions" title="show all edits to this post">edited <span title="2013-05-20 10:56:19Z" class="relativetime">May 20 '13 at 10:56</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2013-04-14 20:37:12Z" class="relativetime">Apr 14 '13 at 20:37</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/634135/cobie"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/e663a833765a8e904f7fe53827cc376e" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/634135/cobie">cobie</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">2,300</span><span title="7 gold badges"><span class="badge1"></span><span class="badgecount">7</span></span><span title="23 silver badges"><span class="badge2"></span><span class="badgecount">23</span></span><span title="44 bronze badges"><span class="badge3"></span><span class="badgecount">44</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-16004075" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-22909293" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">posting one timing for an unknown machine says nothing. The accepted answer here says "without psyco, for n=1000000, rwh_primes2 was the fastest". So if you'd provide your timings for that code as well as yours, on the same machine, and at 2, 4, 10 mln as well, <i>then</i> it'd be much more informative.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/849891/will-ness" title="32,974 reputation" class="comment-user">Will Ness</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment22909293_16004075"><span title="2013-04-17 07:32:12Z" class="relativetime-clean">Apr 17 '13 at 7:32</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-26883644" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">-1, This code depends on special features of the bitarray implemented in C, which is why the code is fast as most of the work is being done in native code in the slice assignment. The bitarray package <b>BREAKS</b> the standard definition for proper slices (indexed over a range) for mutable sequences in that it allows assigning a single boolean 0/1 or True/False to all elements of the slice, whereas the standard behavior for pure Python seems to be to not allow this and only allow the assignment value of 0 in which case it is treated as a del of all of the slice elements from the sequence/array.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/549617/gordonbgood" title="1,983 reputation" class="comment-user">GordonBGood</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment26883644_16004075"><span title="2013-08-19 16:46:36Z" class="relativetime-clean">Aug 19 '13 at 16:46</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-26885610" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">cont'd:  If calling non-standard native code were to be compared, we may as well write a "fastprimes" sequence generator package based on C code such as that of <a href="https://code.google.com/p/primesieve/" rel="nofollow noreferrer">Kim Walisch's primesieve</a> and generate all the primes in the four billion plus 32-bit number range in just a few seconds with a single call to the sequence generator.  This would also use almost no memory as the linked code is based on a segmented Sieve of Eratosthenes and thus only uses a few ten's of Kilobytes of RAM, and if a sequence were generated there would be no list storage required.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/549617/gordonbgood" title="1,983 reputation" class="comment-user">GordonBGood</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment26885610_16004075"><span title="2013-08-19 17:54:18Z" class="relativetime-clean">Aug 19 '13 at 17:54</span></a></span>
                        <span class="edited-yes" title="this comment was edited 1 time"></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-16004075" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="26704740"></a>
<div id="answer-26704740" class="answer" data-answerid="26704740" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="26704740">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>I collected several prime number sieves over time. The fastest on my computer is this:</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">from</span><span class="pln"> time </span><span class="kwd">import</span><span class="pln"> time
</span><span class="com"># 175 ms for all the primes up to the value 10**6</span><span class="pln">
</span><span class="kwd">def</span><span class="pln"> primes_sieve</span><span class="pun">(</span><span class="pln">limit</span><span class="pun">):</span><span class="pln">
    a </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="kwd">True</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> limit
    a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="com">#a[2] = True</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> n </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">4</span><span class="pun">,</span><span class="pln"> limit</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    root_limit </span><span class="pun">=</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">limit</span><span class="pun">**.</span><span class="lit">5</span><span class="pun">)+</span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln">root_limit</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> n </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> limit</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*</span><span class="pln">i</span><span class="pun">):</span><span class="pln">
                a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> a

LIMIT </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10</span><span class="pun">**</span><span class="lit">6</span><span class="pln">
s</span><span class="pun">=</span><span class="pln">time</span><span class="pun">()</span><span class="pln">
primes </span><span class="pun">=</span><span class="pln"> primes_sieve</span><span class="pun">(</span><span class="pln">LIMIT</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">print</span><span class="pln"> time</span><span class="pun">()-</span><span class="pln">s</span></code></pre>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/26704740" title="short permalink to this answer" class="short-link" id="link-post-26704740">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/26704740/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2014-11-02 21:39:27Z" class="relativetime">Nov 2 '14 at 21:39</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/1751920/stefan-gruenwald"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/Nt40N.jpg" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/1751920/stefan-gruenwald">Stefan Gruenwald</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">1,508</span><span title="15 silver badges"><span class="badge2"></span><span class="badgecount">15</span></span><span title="16 bronze badges"><span class="badge3"></span><span class="badgecount">16</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-26704740" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-26704740" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="28517084"></a>
<div id="answer-28517084" class="answer" data-answerid="28517084" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="28517084">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">0</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>I'm slow responding to this question but it seemed like a fun exercise. I'm using numpy which might be cheating and I doubt this method is the fastest but it should be clear. It sieves a Boolean array referring to its indices only and elicits prime numbers from the indices of all True values. No modulo needed.</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="kwd">import</span><span class="pln"> numpy </span><span class="kwd">as</span><span class="pln"> np
</span><span class="kwd">def</span><span class="pln"> ajs_primes3a</span><span class="pun">(</span><span class="pln">upto</span><span class="pun">):</span><span class="pln">
    mat </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">ones</span><span class="pun">((</span><span class="pln">upto</span><span class="pun">),</span><span class="pln"> dtype</span><span class="pun">=</span><span class="pln">bool</span><span class="pun">)</span><span class="pln">
    mat</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    mat</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    mat</span><span class="pun">[</span><span class="lit">4</span><span class="pun">::</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> idx </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">upto </span><span class="pun">**</span><span class="pln"> </span><span class="lit">0.5</span><span class="pun">)+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        mat</span><span class="pun">[</span><span class="pln">idx</span><span class="pun">*</span><span class="lit">2</span><span class="pun">::</span><span class="pln">idx</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">where</span><span class="pun">(</span><span class="pln">mat </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">]</span></code></pre>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/28517084" title="short permalink to this answer" class="short-link" id="link-post-28517084">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/28517084/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/28517084/revisions" title="show all edits to this post">edited <span title="2015-02-15 22:16:14Z" class="relativetime">Feb 15 '15 at 22:16</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2015-02-14 15:25:04Z" class="relativetime">Feb 14 '15 at 15:25</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/2065097/alan-james-salmoni"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/20530f8e8ba3a9dfcf4ef1fb96e5ead3" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/2065097/alan-james-salmoni">Alan James Salmoni</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">101</span><span title="1 silver badge"><span class="badge2"></span><span class="badgecount">1</span></span><span title="5 bronze badges"><span class="badge3"></span><span class="badgecount">5</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-28517084" class="comments ">
		    <table>
                <tbody data-remaining-comments-count="1" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">



    <tr id="comment-45357387" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">it is incorrect e.g., <code>ajs_primes3a(10)</code> -&gt; <code>array([2, 3, 5, 7, 9])</code>. <code>9</code> is not a prime</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/4279/j-f-sebastian" title="208,500 reputation" class="comment-user">J.F. Sebastian</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment45357387_28517084"><span title="2015-02-14 21:06:12Z" class="relativetime-clean">Feb 14 '15 at 21:06</span></a></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-45378579" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">You spotted an edge case I hadn't – well done! The problem was in 'for idx in range(3, int(upto ** 0.5), 2):' which should be 'for idx in range(3, int(upto ** 0.5) + 1, 2):'. Thanks but it works now.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/2065097/alan-james-salmoni" title="101 reputation" class="comment-user">Alan James Salmoni</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment45378579_28517084"><span title="2015-02-15 22:14:20Z" class="relativetime-clean">Feb 15 '15 at 22:14</span></a></span>
                        <span class="edited-yes" title="this comment was edited 2 times"></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-45378670" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">The reason was that the idx loop went up to 'upto ** 05' which for cases up to and including 15. From 16 onwards, it works fine. This was a set of edge cases I hadn't tested for. Adding 1 means it should work for all numbers.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/2065097/alan-james-salmoni" title="101 reputation" class="comment-user">Alan James Salmoni</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment45378670_28517084"><span title="2015-02-15 22:18:47Z" class="relativetime-clean">Feb 15 '15 at 22:18</span></a></span>
                        <span class="edited-yes" title="this comment was edited 1 time"></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-45380201" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">It seems to work now. It is the slowest among <code>numpy</code>-based solutions that return an array. Note: no true Sieve of Eratosthenes implementation uses modulo -- no need to mention it. You could use <code>mat[idx*idx::idx]</code> instead of <code>mat[idx*2::idx]</code>. And <code>np.nonzero(mat)[0]</code> instead of <code>np.where(mat == True)[0]</code>.</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/4279/j-f-sebastian" title="208,500 reputation" class="comment-user">J.F. Sebastian</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment45380201_28517084"><span title="2015-02-15 23:53:31Z" class="relativetime-clean">Feb 15 '15 at 23:53</span></a></span>
                        <span class="edited-yes" title="this comment was edited 1 time"></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-45403722" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Thanks JF. I tested against prime6() and got a result faster up to (IIRC) about 250k when prime6() took over. primesfrom2to() was faster. At up to 20m, ajs_primes3a() took 0.034744977951ms, prime6() took 0.0222899913788ms  and primesfrom2to() took 0.0104751586914ms (same machine, same load, best of 10 timings). It's honestly better than I thought it would be!</span>
                    –&nbsp;<a href="https://stackoverflow.com/users/2065097/alan-james-salmoni" title="101 reputation" class="comment-user">Alan James Salmoni</a>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#comment45403722_28517084"><span title="2015-02-16 15:54:08Z" class="relativetime-clean">Feb 16 '15 at 15:54</span></a></span>
                                                                            </div>
                    </td>
    </tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-28517084" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link  dno" title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”."></a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link " title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick="">show <b>1</b> more comment</a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="21505621"></a>
<div id="answer-21505621" class="answer" data-answerid="21505621" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="21505621">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">-2</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>This is an elegant and simpler solution to find primes using a stored list. Starts with a 4 variables, you only have to test odd primes for divisors, and you only have to test up to a half of what number you are testing as a prime (no point in testing whether 9, 11, 13 divide into 17). It tests previously stored primes as divisors.`</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="pln">    </span><span class="com"># Program to calculate Primes</span><span class="pln">
 primes </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">1</span><span class="pun">,</span><span class="lit">3</span><span class="pun">,</span><span class="lit">5</span><span class="pun">,</span><span class="lit">7</span><span class="pun">]</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> n </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">9</span><span class="pun">,</span><span class="lit">100000</span><span class="pun">,</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">primes</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">)):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> n </span><span class="pun">%</span><span class="pln"> primes</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">break</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        primes</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">print</span><span class="pln"> primes</span></code></pre>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/21505621" title="short permalink to this answer" class="short-link" id="link-post-21505621">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/21505621/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2014-02-02 00:41:24Z" class="relativetime">Feb 2 '14 at 0:41</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/3261711/user3261711"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/e975b510f3e2d9460b7621630a32f0a9" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/3261711/user3261711">user3261711</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">1</span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-21505621" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-21505621" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>

  
<a name="28504698"></a>
<div id="answer-28504698" class="answer downvoted-answer" data-answerid="28504698" itemscope="" itemtype="http://schema.org/Answer">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
        <input type="hidden" name="_id_" value="28504698">
        <a class="vote-up-off" title="This answer is useful">up vote</a>
        <span itemprop="upvoteCount" class="vote-count-post ">-3</span>
        <a class="vote-down-off" title="This answer is not useful">down vote</a>




</div>

            </td>
            


<td class="answercell">
    <div class="post-text" itemprop="text">
<p>This is the way you can compare with others.</p>

<pre class="lang-py prettyprint prettyprinted"><code><span class="com"># You have to list primes upto n</span><span class="pln">
nums </span><span class="pun">=</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10</span><span class="pun">):</span><span class="pln">
    nums </span><span class="pun">=</span><span class="pln"> filter</span><span class="pun">(</span><span class="kwd">lambda</span><span class="pln"> s</span><span class="pun">:</span><span class="pln"> s</span><span class="pun">==</span><span class="pln">i </span><span class="kwd">or</span><span class="pln"> s</span><span class="pun">%</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> nums</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">print</span><span class="pln"> nums</span></code></pre>

<p>So simple...</p>
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="https://stackoverflow.com/a/28504698" title="short permalink to this answer" class="short-link" id="link-post-28504698">share</a><span class="lsep">|</span><a href="https://stackoverflow.com/posts/28504698/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="https://stackoverflow.com/posts/28504698/revisions" title="show all edits to this post">edited <span title="2015-07-18 13:19:07Z" class="relativetime">Jul 18 '15 at 13:19</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/3478852/nisse-engstr%c3%b6m"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/yzEvc.jpg" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/3478852/nisse-engstr%c3%b6m">Nisse Engström</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">3,756</span><span title="9 gold badges"><span class="badge1"></span><span class="badgecount">9</span></span><span title="18 silver badges"><span class="badge2"></span><span class="badgecount">18</span></span><span title="32 bronze badges"><span class="badge3"></span><span class="badgecount">32</span></span>
        </div>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2015-02-13 16:55:13Z" class="relativetime">Feb 13 '15 at 16:55</span>
    </div>
    <div class="user-gravatar32">
        <a href="https://stackoverflow.com/users/4266559/lavee-singh"><div class="gravatar-wrapper-32"><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/saLWz.jpg" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="https://stackoverflow.com/users/4266559/lavee-singh">lavee_singh</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">406</span><span title="1 gold badge"><span class="badge1"></span><span class="badgecount">1</span></span><span title="4 silver badges"><span class="badge2"></span><span class="badgecount">4</span></span><span title="16 bronze badges"><span class="badge3"></span><span class="badgecount">16</span></span>
        </div>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-28504698" class="comments  dno">
		    <table>
                <tbody data-remaining-comments-count="0" data-canpost="false" data-cansee="true" data-comments-unavailable="false" data-addlink-disabled="true">

                        <tr><td></td><td></td></tr>
                </tbody>
		    </table>
	    </div>

        <div id="comments-link-28504698" data-rep="50" data-anon="true">

                <a class="js-add-link comments-link disabled-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add a comment</a><span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a class="js-show-link comments-link dno" title="expand to show all comments on this post" href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" onclick=""></a>
        </div>         
    </td>
</tr>    </tbody></table>
</div>
				    <div class="question-status">
        <h2>                    <b>protected</b> by <a href="https://stackoverflow.com/users/849891/will-ness">Will Ness</a> <span dir="ltr"><span title="2014-02-02 09:38:25Z" class="relativetime">Feb 2 '14 at 9:38</span></span>
</h2>
        <p>
Thank you for your interest in this question. 
Because it has attracted low-quality or spam answers that had to be removed, posting an answer now requires 10 <a href="https://stackoverflow.com/help/whats-reputation">reputation</a> on this site (the <a href="https://stackoverflow.com/help/privileges/new-user">association bonus does not count</a>).
<br><br>
Would you like to answer one of these <a href="https://stackoverflow.com/unanswered?fromProtectedNotice=true">unanswered questions</a> instead?
</p>
    </div>





						<h2 class="bottom-notice" data-loc="1">
Not the answer you're looking for?							Browse other questions tagged <a href="https://stackoverflow.com/questions/tagged/python" class="post-tag" title="show questions tagged &#39;python&#39;" rel="tag">python</a> <a href="https://stackoverflow.com/questions/tagged/math" class="post-tag" title="show questions tagged &#39;math&#39;" rel="tag">math</a> <a href="https://stackoverflow.com/questions/tagged/optimization" class="post-tag" title="show questions tagged &#39;optimization&#39;" rel="tag">optimization</a> <a href="https://stackoverflow.com/questions/tagged/primes" class="post-tag" title="show questions tagged &#39;primes&#39;" rel="tag">primes</a>  or <a href="https://stackoverflow.com/questions/ask">ask your own question</a>.						</h2>
			</div>
		</div>
				<div id="sidebar" class="show-votes" role="complementary" aria-label="sidebar">
						    <div class="module question-stats">
			        <table id="qinfo">
			            <tbody><tr>
			                <td>
			                    <p class="label-key">asked</p>
			                </td>
			                <td style="padding-left: 10px">
			                    <p class="label-key" title="2010-01-14 23:40:27Z"><b>7 years, 6 months ago</b></p>
			                </td>
			            </tr>
			            <tr>
			                <td>
			                    <p class="label-key">viewed</p>
			                </td>

			                <td style="padding-left: 10px">
			                    <p class="label-key">
                                    <b>126,247 times</b>
			                    </p>
			                </td>
			            </tr>
			                <tr>
			                    <td>
			                        <p class="label-key">active</p>
			                    </td>
			                    <td style="padding-left: 10px">
			                        <p class="label-key"><b><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188?lastactivity" class="lastactivity-link" title="2017-03-15 16:27:05Z">4 months ago</a></b></p>
			                    </td>
			                </tr>
			        </tbody></table>
			    </div>
						
			<script>
                var ados = ados || {}; ados.run = ados.run || [];
                ados.run.push(function () { ados_add_placement(22,8277,"adzerk1860010798",[5,17,2221,1129,43]).setZone(45); });
            </script>
            <div class="everyonelovesstackoverflow adzerk-vote" id="adzerk1860010798"><div id="careersadsdoublehigh" style="display:none;"></div><div class="adzerk-vote-controls" style="display:none;"><div class="adzerk-vote-option adzerk-vote-up"><div class="adzerk-vote-icon"></div></div><div class="adzerk-vote-option adzerk-vote-down"><div class="adzerk-vote-icon"></div></div></div><div class="adzerk-vote-survey" style="display:none;"><form><span>No problem. We won't show you that ad again. Why didn't you like it?</span><ul><li><label><input type="radio" value="12" name="downvoteReason">Uninteresting</label></li><li><label><input type="radio" value="13" name="downvoteReason">Misleading</label></li><li><label><input type="radio" value="14" name="downvoteReason">Offensive</label></li><li><label><input type="radio" value="15" name="downvoteReason">Repetitive</label></li><li><label><input type="radio" value="16" name="downvoteReason">Other</label></li></ul><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" class="adzerk-vote-cancel">Oops! I didn't mean to do this.</a></form></div><img height="0px" width="0px" border="0" style="position: absolute; display: none !important;" src="https://engine.adzerk.net/i.gif?e=eyJhdiI6NDE0LCJhdCI6NSwiYnQiOjAsImNtIjo5MjEsImNoIjoxMTc4LCJjayI6e30sImNyIjoyNjg4LCJkaSI6ImQ2Yzk2YzEwZDNlZTQ2NWVhOTFlOTZiNzA2M2ZiZDE4IiwiZG0iOjEsImZjIjoyNDg1LCJmbCI6MjY2MywiaXAiOiI4NC4yMjkuMTA1LjIwIiwia3ciOiJweXRob24sbWF0aCxvcHRpbWl6YXRpb24scHJpbWVzLHgtY3Jvc3Mtc2l0ZS11bml4LnN0YWNrZXhjaGFuZ2UuY29tIiwibnciOjIyLCJwYyI6MCwiZWMiOjAsInByIjo2MTczNywicnQiOjEsInJmIjoiaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjA2ODM3Mi9mYXN0ZXN0LXdheS10by1saXN0LWFsbC1wcmltZXMtYmVsb3ctbiIsInNhIjoiMyIsInNiIjoiaS0wZjUyZjBlMGU3MmI5YjU0NCIsInNwIjoxODAxMCwic3QiOjgyNzcsInVrIjoidWUxLTZhYWQ1OWExYTg0ODRjZDliNDA1MGU3N2FiOGZjY2M4Iiwiem4iOjQ1LCJ0cyI6MTUwMDE1MDUwNjg5NywiYmYiOnRydWUsInBuIjoiYWR6ZXJrMTg2MDAxMDc5OCIsImZxIjowfQ&amp;s=-1-OGfcZhu6s27CYji4d_HO85z8"></div>
            <div id="hireme" class="blue tagged tex2jax_ignore clc-jobs-multi"><a class="top " href="https://stackoverflow.com/jobs" target="_blank" data-clc-click="https://clc.stackoverflow.com/click?an=AaMAXP8KGA20DMDL1EglduJMSQICBJSffgqgf4KAn3U2awHxTttQx1EAAwCMsAAAgD8BAQAEmwKk0AfCoAmt7RAKAwABwOeHFzpnr0A_AQVsaW51eBsCgtgHwJsJqeMQBAMAZMCKKOY5SFdNPxsC3c0H6Y0J_7wQMAMAB8B6Ugo6H31yPxsC5LsHu_UI9owQCgMAAsAOQ_o5oRcVPwClSgceglxjHTec&amp;cr=10439&amp;ct=1&amp;url=https%3A%2F%2Fstackoverflow.com%2Fjobs%3Fmed=clc&amp;sig=GAzDtiwBrf5yBQ"><span>Looking for a job?</span></a><div class="middle"><ul class="jobs"><li class="&quot;clc-dismissable&quot;"><div class="job-wrap"><a class="job" title="Release Engineer at Facebook. Click to learn more." href="https://stackoverflow.com/jobs/146573/release-engineer-facebook" target="_blank" data-clc-click="https://clc.stackoverflow.com/click?an=AaMAXP8KGA20DMDL1EglduJMSQICBJSffgqgf4KAn3U2awHxTttQx1EAAwCMsAAAgD8BAQAEmwKk0AfCoAmt7RAKAwABwOeHFzpnr0A_AQVsaW51eBsCgtgHwJsJqeMQBAMAZMCKKOY5SFdNPxsC3c0H6Y0J_7wQMAMAB8B6Ugo6H31yPxsC5LsHu_UI9owQCgMAAsAOQ_o5oRcVPwClSgceglxjHTec&amp;cr=276141&amp;ct=0&amp;url=https%3A%2F%2Fstackoverflow.com%2Fjobs%2F146573%2Frelease-engineer-facebook%3Fmed=clc&amp;sig=3DCs1Esu5dqL1g"><div class="title">Release Engineer</div><div><span class="company">Facebook</span><span class="location">Tel Aviv-Yafo, Israel</span></div><div class="opts"><span class="opt relocate">Relocation</span></div><span class="post-tag highlight">linux</span><span class="post-tag">unix</span><div></div></a></div><a class="clc-dismiss" data-clc-click="https://clc.stackoverflow.com/click?an=AaMAXP8KGA20DMDL1EglduJMSQICBJSffgqgf4KAn3U2awHxTttQx1EAAwCMsAAAgD8BAQAEmwKk0AfCoAmt7RAKAwABwOeHFzpnr0A_AQVsaW51eBsCgtgHwJsJqeMQBAMAZMCKKOY5SFdNPxsC3c0H6Y0J_7wQMAMAB8B6Ugo6H31yPxsC5LsHu_UI9owQCgMAAsAOQ_o5oRcVPwClSgceglxjHTec&amp;cr=276141&amp;ct=-1&amp;sig=vW6f46kR41LmpA" data-clc-meta-target="-1"><span class="clc-tooltip above-left">dismiss this job</span></a></li><li class="&quot;clc-dismissable&quot;"><div class="job-wrap"><a class="job" title="Sr. Network Automation Engineer - Packet Tamer at PacketFabric. Click to learn more." href="https://stackoverflow.com/jobs/147796/sr-network-automation-engineer-packet-tamer-packetfabric" target="_blank" data-clc-click="https://clc.stackoverflow.com/click?an=AaMAXP8KGA20DMDL1EglduJMSQICBJSffgqgf4KAn3U2awHxTttQx1EAAwCMsAAAgD8BAQAEmwKk0AfCoAmt7RAKAwABwOeHFzpnr0A_AQVsaW51eBsCgtgHwJsJqeMQBAMAZMCKKOY5SFdNPxsC3c0H6Y0J_7wQMAMAB8B6Ugo6H31yPxsC5LsHu_UI9owQCgMAAsAOQ_o5oRcVPwClSgceglxjHTec&amp;cr=274857&amp;ct=0&amp;url=https%3A%2F%2Fstackoverflow.com%2Fjobs%2F147796%2Fsr-network-automation-engineer-packet-tamer-packetfabric%3Fmed=clc&amp;sig=aeQK-IfxK-n0sA"><div class="title">Sr. Network Automation Engineer - Packet Tamer</div><div><span class="company">PacketFabric</span><span class="location">No office location</span></div><div class="opts"><span class="opt salary">$120k - $135k</span><span class="opt remote">Remote</span></div><span class="post-tag">python</span><span class="post-tag">networking</span><div></div></a></div><a class="clc-dismiss" data-clc-click="https://clc.stackoverflow.com/click?an=AaMAXP8KGA20DMDL1EglduJMSQICBJSffgqgf4KAn3U2awHxTttQx1EAAwCMsAAAgD8BAQAEmwKk0AfCoAmt7RAKAwABwOeHFzpnr0A_AQVsaW51eBsCgtgHwJsJqeMQBAMAZMCKKOY5SFdNPxsC3c0H6Y0J_7wQMAMAB8B6Ugo6H31yPxsC5LsHu_UI9owQCgMAAsAOQ_o5oRcVPwClSgceglxjHTec&amp;cr=274857&amp;ct=-1&amp;sig=48NSsYM1tNUODg" data-clc-meta-target="-1"><span class="clc-tooltip above-left">dismiss this job</span></a></li><li class="&quot;clc-dismissable&quot;"><div class="job-wrap"><a class="job" title="SW Developer – Trading Platform at JP Morgan Chase. Click to learn more." href="https://stackoverflow.com/jobs/146191/sw-developer-trading-platform-jp-morgan-chase" target="_blank" data-clc-click="https://clc.stackoverflow.com/click?an=AaMAXP8KGA20DMDL1EglduJMSQICBJSffgqgf4KAn3U2awHxTttQx1EAAwCMsAAAgD8BAQAEmwKk0AfCoAmt7RAKAwABwOeHFzpnr0A_AQVsaW51eBsCgtgHwJsJqeMQBAMAZMCKKOY5SFdNPxsC3c0H6Y0J_7wQMAMAB8B6Ugo6H31yPxsC5LsHu_UI9owQCgMAAsAOQ_o5oRcVPwClSgceglxjHTec&amp;cr=269951&amp;ct=0&amp;url=https%3A%2F%2Fstackoverflow.com%2Fjobs%2F146191%2Fsw-developer-trading-platform-jp-morgan-chase%3Fmed=clc&amp;sig=ClT4PslhnmRu-w"><div class="title">SW Developer – Trading Platform</div><div><span class="company">JP Morgan Chase</span><span class="location">Herzliya, Israel</span></div><span class="post-tag">c++</span><span class="post-tag">python</span><div></div></a></div><a class="clc-dismiss" data-clc-click="https://clc.stackoverflow.com/click?an=AaMAXP8KGA20DMDL1EglduJMSQICBJSffgqgf4KAn3U2awHxTttQx1EAAwCMsAAAgD8BAQAEmwKk0AfCoAmt7RAKAwABwOeHFzpnr0A_AQVsaW51eBsCgtgHwJsJqeMQBAMAZMCKKOY5SFdNPxsC3c0H6Y0J_7wQMAMAB8B6Ugo6H31yPxsC5LsHu_UI9owQCgMAAsAOQ_o5oRcVPwClSgceglxjHTec&amp;cr=269951&amp;ct=-1&amp;sig=-ngK5q-I0zAI5Q" data-clc-meta-target="-1"><span class="clc-tooltip above-left">dismiss this job</span></a></li><li class="&quot;clc-dismissable&quot;"><div class="job-wrap"><a class="job" title="Big Data Architect at Aol. Click to learn more." href="https://stackoverflow.com/jobs/143393/big-data-architect-aol" target="_blank" data-clc-click="https://clc.stackoverflow.com/click?an=AaMAXP8KGA20DMDL1EglduJMSQICBJSffgqgf4KAn3U2awHxTttQx1EAAwCMsAAAgD8BAQAEmwKk0AfCoAmt7RAKAwABwOeHFzpnr0A_AQVsaW51eBsCgtgHwJsJqeMQBAMAZMCKKOY5SFdNPxsC3c0H6Y0J_7wQMAMAB8B6Ugo6H31yPxsC5LsHu_UI9owQCgMAAsAOQ_o5oRcVPwClSgceglxjHTec&amp;cr=263798&amp;ct=0&amp;url=https%3A%2F%2Fstackoverflow.com%2Fjobs%2F143393%2Fbig-data-architect-aol%3Fmed=clc&amp;sig=eemLYurYW-ogRw"><div class="title">Big Data Architect</div><div><span class="company">Aol</span><span class="location">Ramat Gan, Israel</span></div><span class="post-tag">python</span><span class="post-tag">java</span><div></div></a></div><a class="clc-dismiss" data-clc-click="https://clc.stackoverflow.com/click?an=AaMAXP8KGA20DMDL1EglduJMSQICBJSffgqgf4KAn3U2awHxTttQx1EAAwCMsAAAgD8BAQAEmwKk0AfCoAmt7RAKAwABwOeHFzpnr0A_AQVsaW51eBsCgtgHwJsJqeMQBAMAZMCKKOY5SFdNPxsC3c0H6Y0J_7wQMAMAB8B6Ugo6H31yPxsC5LsHu_UI9owQCgMAAsAOQ_o5oRcVPwClSgceglxjHTec&amp;cr=263798&amp;ct=-1&amp;sig=dn7zUKufNoudsw" data-clc-meta-target="-1"><span class="clc-tooltip above-left">dismiss this job</span></a></li></ul></div><img src="./python - Fastest way to list all primes below N - Stack Overflow_files/impression.gif" class="impression" style="display: none;"></div>
        <script>
window.clc_request = 'Avd8RQvAy9QIAAAAAJSPHwACAAAAAgAAAABFAAAAfHB5dGhvbnxtYXRofG9wdGltaXphdGlvbnxwcmltZXN8eC1jcm9zcy1zaXRlLXVuaXguc3RhY2tleGNoYW5nZS5jb218AF75SJP8hzlVyBY';;!function i(n){try{if("function"!=typeof[].indexOf)return;if(!window.addEventListener)return;if(!n.allowed)return;if(!RegExp(n.allowed).test(location.hostname))return;var t=window,e=t.document,c=n.wv;if(e.hidden&&c)return void e.addEventListener("visibilitychange",function t(){e.hidden||(i(n),e.removeEventListener("visibilitychange",t))});if(t.clc=t.clc||{},t.clc.init=t.clc.init||[],n.autoload&&t.clc.init.push(function(i){return i.load()}),t.clc.options){for(var o in t.clc.options)n[o]=t.clc.options[o];t.clc.options=n}else t.clc.options=n;var r=e.createElement("script");r.async=!0,r.src=n.lib,e.body.appendChild(r)}catch(i){}}.call(null, {"lib":"https://cdn.sstatic.net/clc/clc.min.js?v=d80e98d967bf","u":"https://clc.stackoverflow.com/markup.js","azw":true,"kt":2000,"tto":true,"d":{"sb":["hireme","clc-sb"],"tlb":["careers1","clc-tlb"],"mlb":["careers3","clc-mlb"]},"h":"clc.stackoverflow.com","autoload":true,"allowed":"^(((talent\\.)?stackoverflow)|(blog\\.codinghorror)|(serverfault|askubuntu)|([^\\.]+\\.stackexchange))\\.com$","wv":true});        </script>
			<div style="margin-bottom: 10px;">
        

<script>
    StackExchange.ready(function () {
        StackExchange.newsletterAd.init();
    });
</script>

<div id="newsletter-ad">
        <p id="newsletter-ad-header">Get the <b>weekly newsletter!</b> In it, you'll get:</p>
        <ul>
            <li>The week's top questions and answers</li>
            <li>Important community announcements</li>
            <li>Questions that need answers</li>
        </ul>
    <div id="newsletter-signup-container"><input id="newsletter-signup" type="button" value="Sign up for the newsletter"></div>
    <p id="newsletter-preview-container">see an <a href="https://stackexchange.com/newsletters/newsletter?site=stackoverflow.com" id="newsletter-preview">example newsletter</a></p>
    <div class="dno">
        
<p class="privacy-policy-agreement">
By subscribing, you agree to the <a href="https://stackexchange.com/legal/privacy-policy" name="privacy" target="_blank">privacy policy</a> and <a href="https://stackexchange.com/legal/terms-of-service" name="tos" target="_blank">terms of service</a>.</p>
<input type="hidden" name="legalLinksShown" value="1">
    </div>
</div>

    </div>

            <div class="module sidebar-linked">
	<h4 id="h-linked">Linked</h4>
	<div class="linked" data-tracker="lq=1">

<div class="spacer">
	<a href="https://stackoverflow.com/q/4911777?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">2</div>
	</a>
	<a href="https://stackoverflow.com/questions/4911777/finding-first-n-primes?noredirect=1&amp;lq=1" class="question-hyperlink">Finding first n primes?</a>
</div>
<div class="spacer">
	<a href="https://stackoverflow.com/q/15333313?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes  default">-2</div>
	</a>
	<a href="https://stackoverflow.com/questions/15333313/python-list-all-prime-numbers-that-exist-before-an-input-number?noredirect=1&amp;lq=1" class="question-hyperlink">Python: List all prime numbers that exist before an input number</a>
</div>
<div class="spacer">
	<a href="https://stackoverflow.com/q/17394838?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">4</div>
	</a>
	<a href="https://stackoverflow.com/questions/17394838/python-prime-numbers-generator-yield-vs-return?noredirect=1&amp;lq=1" class="question-hyperlink">Python prime numbers generator yield vs return</a>
</div>
<div class="spacer">
	<a href="https://stackoverflow.com/q/6555060?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">-3</div>
	</a>
	<a href="https://stackoverflow.com/questions/6555060/finding-if-a-number-is-prime-using-python?noredirect=1&amp;lq=1" class="question-hyperlink">Finding if a number is prime using Python</a>
</div>
<div class="spacer">
	<a href="https://stackoverflow.com/q/14147554?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">0</div>
	</a>
	<a href="https://stackoverflow.com/questions/14147554/adding-prime-numbers-and-fibonacci-numbers?noredirect=1&amp;lq=1" class="question-hyperlink">Adding Prime numbers and Fibonacci numbers</a>
</div>
<div class="spacer">
	<a href="https://stackoverflow.com/q/27769511?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes  default">-1</div>
	</a>
	<a href="https://stackoverflow.com/questions/27769511/python-list-vs-java-array-efficiency?noredirect=1&amp;lq=1" class="question-hyperlink">Python List vs Java Array efficiency</a>
</div>
<div class="spacer">
	<a href="https://stackoverflow.com/q/22222880?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">1</div>
	</a>
	<a href="https://stackoverflow.com/questions/22222880/python-getting-prime-numbers?noredirect=1&amp;lq=1" class="question-hyperlink">Python - Getting prime numbers</a>
</div>
<div class="spacer">
	<a href="https://stackoverflow.com/q/13880021?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">2</div>
	</a>
	<a href="https://stackoverflow.com/questions/13880021/trying-to-write-an-eratosthenes-sieve-in-python-is-this-correct-and-how-can-i-m?noredirect=1&amp;lq=1" class="question-hyperlink">Trying to write an Eratosthenes Sieve in Python. Is this correct and how can I make it faster?</a>
</div>
<div class="spacer">
	<a href="https://stackoverflow.com/q/15599326?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes  default">0</div>
	</a>
	<a href="https://stackoverflow.com/questions/15599326/how-can-i-make-python-work-faster?noredirect=1&amp;lq=1" class="question-hyperlink">How can I make Python work faster?</a>
</div>
<div class="spacer">
	<a href="https://stackoverflow.com/q/37312540?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">0</div>
	</a>
	<a href="https://stackoverflow.com/questions/37312540/finding-the-10001st-prime-number-in-python?noredirect=1&amp;lq=1" class="question-hyperlink">Finding the 10001st prime number (in python)?</a>
</div>					<div class="spacer more">
				<a href="https://stackoverflow.com/questions/linked/2068372?lq=1">see more linked questions…</a>
			</div>
	</div>
</div>

				<div class="module sidebar-related">
					<h4 id="h-related">Related</h4>
                    <div class="related js-gps-related-questions" data-tracker="rq=1">
                        <div class="spacer js-gps-track"><a href="https://stackoverflow.com/q/53513?rq=1" title="Vote score (upvotes - downvotes)"><div class="answer-votes answered-accepted extra-large">2054</div></a><a href="https://stackoverflow.com/questions/53513/best-way-to-check-if-a-list-is-empty?rq=1" class="question-hyperlink">Best way to check if a list is empty</a></div><div class="spacer js-gps-track"><a href="https://stackoverflow.com/q/295579?rq=1" title="Vote score (upvotes - downvotes)"><div class="answer-votes answered-accepted large">947</div></a><a href="https://stackoverflow.com/questions/295579/fastest-way-to-determine-if-an-integers-square-root-is-an-integer?rq=1" class="question-hyperlink">Fastest way to determine if an integer's square root is an integer</a></div><div class="spacer js-gps-track"><a href="https://stackoverflow.com/q/3207219?rq=1" title="Vote score (upvotes - downvotes)"><div class="answer-votes extra-large">1980</div></a><a href="https://stackoverflow.com/questions/3207219/how-do-i-list-all-files-of-a-directory?rq=1" class="question-hyperlink">How do I list all files of a directory?</a></div><div class="spacer js-gps-track"><a href="https://stackoverflow.com/q/3939660?rq=1" title="Vote score (upvotes - downvotes)"><div class="answer-votes answered-accepted default">49</div></a><a href="https://stackoverflow.com/questions/3939660/sieve-of-eratosthenes-finding-primes-python?rq=1" class="question-hyperlink">Sieve of Eratosthenes - Finding Primes Python</a></div><div class="spacer js-gps-track"><a href="https://stackoverflow.com/q/5466977?rq=1" title="Vote score (upvotes - downvotes)"><div class="answer-votes default">1</div></a><a href="https://stackoverflow.com/questions/5466977/python-prime-summands-to-an-even-number?rq=1" class="question-hyperlink">Python- Prime summands to an even number</a></div><div class="spacer js-gps-track"><a href="https://stackoverflow.com/q/29223052?rq=1" title="Vote score (upvotes - downvotes)"><div class="answer-votes default">0</div></a><a href="https://stackoverflow.com/questions/29223052/perfect-numbers-and-mersenne-primes-python?rq=1" class="question-hyperlink">Perfect Numbers and Mersenne Primes - Python</a></div><div class="spacer js-gps-track"><a href="https://stackoverflow.com/q/30032955?rq=1" title="Vote score (upvotes - downvotes)"><div class="answer-votes answered-accepted default">0</div></a><a href="https://stackoverflow.com/questions/30032955/euler-3-python-putting-the-prime-numbers-into-a-list?rq=1" class="question-hyperlink">Euler 3 Python. Putting the prime numbers into a list</a></div><div class="spacer js-gps-track"><a href="https://stackoverflow.com/q/32542052?rq=1" title="Vote score (upvotes - downvotes)"><div class="answer-votes answered-accepted default">1</div></a><a href="https://stackoverflow.com/questions/32542052/sum-of-primes-below-2-000-000-in-python?rq=1" class="question-hyperlink">Sum of primes below 2,000,000 in python</a></div><div class="spacer js-gps-track"><a href="https://stackoverflow.com/q/33213328?rq=1" title="Vote score (upvotes - downvotes)"><div class="answer-votes answered-accepted default">0</div></a><a href="https://stackoverflow.com/questions/33213328/listing-all-primes-below-n-using-euclid-infinitude-of-prime-proof?rq=1" class="question-hyperlink">Listing all primes below N using Euclid infinitude of prime proof</a></div><div class="spacer js-gps-track"><a href="https://stackoverflow.com/q/34251682?rq=1" title="Vote score (upvotes - downvotes)"><div class="answer-votes answered-accepted default">1</div></a><a href="https://stackoverflow.com/questions/34251682/finding-common-prime-divisors-in-two-sets-of-numbers-quickly?rq=1" class="question-hyperlink">Finding common prime divisors in two sets of numbers quickly</a></div>
                    </div>
				</div>
            

<div id="hot-network-questions" class="module tex2jax_ignore">
    <h4>
        <a href="https://stackexchange.com/questions?tab=hot" class="js-gps-track" data-gps-track="posts_hot_network.click({ item_type:1, location:11 })">
            Hot Network Questions
        </a>
    </h4>
    <ul>
            <li>
                <div class="favicon favicon-cseducators" title="Computer Science Educators Stack Exchange"></div><a href="https://cseducators.stackexchange.com/questions/2547/advances-in-cs-appropriate-for-cs1-and-cs2-made-by-female-computer-scientists" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:678 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Advances in CS appropriate for CS1 and CS2 made by female computer scientists
                </a>

            </li>
            <li>
                <div class="favicon favicon-worldbuilding" title="Worldbuilding Stack Exchange"></div><a href="https://worldbuilding.stackexchange.com/questions/86107/how-can-a-space-station-prevent-docked-ships-from-irradiating-each-other-or-the" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:579 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How can a space station prevent docked ships from irradiating each other or the station?
                </a>

            </li>
            <li>
                <div class="favicon favicon-physics" title="Physics Stack Exchange"></div><a href="https://physics.stackexchange.com/questions/345381/does-the-sea-level-increase-if-an-iceberg-melts" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:151 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Does the sea level increase if an iceberg melts?
                </a>

            </li>
            <li>
                <div class="favicon favicon-english" title="English Language &amp; Usage Stack Exchange"></div><a href="https://english.stackexchange.com/questions/400036/word-to-describe-to-sit-in-quiet-anger" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:97 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Word to describe to sit in quiet anger
                </a>

            </li>
            <li>
                <div class="favicon favicon-apple" title="Ask Different"></div><a href="https://apple.stackexchange.com/questions/290945/what-are-the-differences-between-launchagents-and-launchdaemons" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:118 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What are the differences between LaunchAgents and LaunchDaemons?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-tex" title="TeX - LaTeX Stack Exchange"></div><a href="https://tex.stackexchange.com/questions/380775/font-table-for-opentype-truetype-fonts" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:85 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Font table for OpenType/TrueType fonts
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-codegolf" title="Programming Puzzles &amp; Code Golf Stack Exchange"></div><a href="https://codegolf.stackexchange.com/questions/132428/put-together-a-senate-majority" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:200 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Put together a Senate majority
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-politics" title="Politics Stack Exchange"></div><a href="https://politics.stackexchange.com/questions/21763/how-does-donald-trump-jr-benefit-from-releasing-the-e-mails-he-released" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:475 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How does Donald Trump Jr. benefit from releasing the e-mails he released?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-workplace" title="The Workplace Stack Exchange"></div><a href="https://workplace.stackexchange.com/questions/95058/is-it-condescending-to-answer-a-question-with-a-question" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:423 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Is it condescending to answer a question with a question?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-ux" title="User Experience Stack Exchange"></div><a href="https://ux.stackexchange.com/questions/109934/in-a-static-data-table-should-rows-be-highlighted-on-hover" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:102 }); posts_hot_network.click({ item_type:2, location:11 })">
                    In a static data table, should rows be highlighted on hover?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-physics" title="Physics Stack Exchange"></div><a href="https://physics.stackexchange.com/questions/345805/why-dont-free-electrons-escape-from-a-conductor" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:151 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why don't free electrons escape from a conductor?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-workplace" title="The Workplace Stack Exchange"></div><a href="https://workplace.stackexchange.com/questions/95022/client-wants-to-reduce-hourly-rate-at-the-start-of-a-new-project" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:423 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Client wants to reduce hourly rate at the start of a new project
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-ell" title="English Language Learners Stack Exchange"></div><a href="https://ell.stackexchange.com/questions/136321/on-a-bus-or-on-the-bus" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:481 }); posts_hot_network.click({ item_type:2, location:11 })">
                    On a bus or on the bus?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-mathematica" title="Mathematica Stack Exchange"></div><a href="https://mathematica.stackexchange.com/questions/151550/what-is-the-one-word-command-for-the-following-list-operation" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:387 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What is the one word command for the following List Operation?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-codegolf" title="Programming Puzzles &amp; Code Golf Stack Exchange"></div><a href="https://codegolf.stackexchange.com/questions/132585/cover-a-set-with-multiples" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:200 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Cover a set with multiples
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-mathematica" title="Mathematica Stack Exchange"></div><a href="https://mathematica.stackexchange.com/questions/151564/opposite-of-part-in-matrices" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:387 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Opposite of Part in matrices?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-travel" title="Travel Stack Exchange"></div><a href="https://travel.stackexchange.com/questions/98044/are-schiphol-airport-hotels-noisy" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:273 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Are Schiphol airport hotels noisy?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-math" title="Mathematics Stack Exchange"></div><a href="https://math.stackexchange.com/questions/2359568/a-circle-tangent-to-an-ellipse" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:69 }); posts_hot_network.click({ item_type:2, location:11 })">
                    A circle tangent to an ellipse
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-chemistry" title="Chemistry Stack Exchange"></div><a href="https://chemistry.stackexchange.com/questions/78843/thermal-decomposition-of-calcium-propionate" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:431 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Thermal decomposition of calcium propionate
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-outdoors" title="The Great Outdoors Stack Exchange"></div><a href="https://outdoors.stackexchange.com/questions/16523/is-there-an-organization-for-adults-to-learn-outdoor-skills" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:395 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Is there an organization for adults to learn outdoor skills?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-gamedev" title="Game Development Stack Exchange"></div><a href="https://gamedev.stackexchange.com/questions/144584/why-are-games-built-on-cross-platform-engines-sometimes-exclusive-to-windows" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:53 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why are games built on cross-platform engines sometimes exclusive to Windows?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-cs" title="Computer Science Stack Exchange"></div><a href="https://cs.stackexchange.com/questions/77971/why-is-the-halting-problem-semi-decidable" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:419 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why is the halting problem semi-decidable?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-latin" title="Latin Language Stack Exchange"></div><a href="https://latin.stackexchange.com/questions/4829/what-is-latin-and-greek-for-medium-greek" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:644 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What is Latin (and Greek) for "medium"? (Greek)
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-aviation" title="Aviation Stack Exchange"></div><a href="https://aviation.stackexchange.com/questions/41006/do-commercial-jets-ever-make-360-in-the-pattern-for-separation" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:528 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Do commercial jets ever make 360 in the pattern for separation?
                </a>

            </li>
    </ul>

        
</div>
		</div>
	
<div id="feed-link">
    <div id="feed-link-text">
        <a href="https://stackoverflow.com/feeds/question/2068372" title="feed of this question and its answers">
            <span class="feed-icon"></span>question feed
        </a>
    </div>
</div>	<script>
StackExchange.ready(function(){$.get('/posts/2068372/ivc/b221');});
</script>
<noscript>
    &lt;div&gt;&lt;img src="/posts/2068372/ivc/b221" class="dno" alt="" width="0" height="0"&gt;&lt;/div&gt;
</noscript><div style="display:none" id="prettify-lang">lang-py</div></div>


        </div>
    </div><script async="" src="./python - Fastest way to list all primes below N - Stack Overflow_files/clc.min.js.download"></script>

        <footer id="footer" class="s-footer js-footer _short" role="contentinfo">
            <div class="-container">
                <div class="g-row js-sp-between">
                    <div class="-logo">
                        <a href="https://stackoverflow.com/"><svg role="icon" class="svg-icon iconLogo" width="150" height="30" viewBox="0 0 150 30"><g><path d="M33.9 18.6l-1.7-.2c-1.3-.1-1.9-.6-1.9-1.6 0-1.1.8-1.8 2.4-1.8 1.1 0 2.1.3 2.8.8l1-1c-1-.8-2.3-1.1-3.8-1.1-2.3 0-3.9 1.2-3.9 3.1 0 1.8 1.1 2.7 3.2 2.9l1.8.2c1.2.1 1.8.6 1.8 1.6 0 1.3-1.1 1.9-2.8 1.9-1.3 0-2.5-.3-3.3-1.2l-1 1c1.2 1.1 2.6 1.5 4.4 1.5 2.6 0 4.3-1.2 4.3-3.2-.2-2-1.5-2.7-3.3-2.9zm13.3-4.8c-1.7 0-2.8.3-3.7 1.5l1 1c.6-.9 1.3-1.2 2.7-1.2 1.9 0 2.7.8 2.7 2.3v1h-3.2c-2.4 0-3.7 1.2-3.7 3.1 0 .8.3 1.6.8 2.2.7.7 1.5 1 3 1 1.4 0 2.2-.3 3.1-1.1v1h1.6v-7.2c-.1-2.4-1.5-3.6-4.3-3.6zm2.7 7c0 .9-.2 1.5-.5 1.8-.7.6-1.5.7-2.4.7-1.7 0-2.4-.6-2.4-1.8 0-1.2.8-1.9 2.4-1.9h3l-.1 1.2zm7.6-5.6c1 0 1.6.3 2.4 1.2l1-1c-1.1-1.2-2-1.6-3.5-1.6-2.7 0-4.7 1.8-4.7 5.5 0 3.6 2 5.5 4.7 5.5 1.5 0 2.4-.4 3.5-1.6l-1.1-1c-.8.9-1.4 1.2-2.4 1.2s-1.9-.4-2.5-1.2c-.5-.7-.7-1.5-.7-2.9 0-1.3.2-2.2.7-2.9.7-.8 1.6-1.2 2.6-1.2zm13.4-1.3H69l-4.8 4.7V9.1h-1.6v15.4h1.6v-3.9l1.9-1.9 3.6 5.8h1.9l-4.4-6.9 3.7-3.7zm7.3-.5c-1.6 0-2.7.6-3.4 1.4-1 1-1.3 2.3-1.3 4.3s.3 3.3 1.3 4.3c.7.7 1.8 1.4 3.4 1.4 1.6 0 2.8-.6 3.4-1.4 1-1 1.3-2.3 1.3-4.3s-.3-3.3-1.3-4.3c-.6-.8-1.7-1.4-3.4-1.4zm1.3 8.3c-.3.3-.7.5-1.3.5-.6 0-1-.2-1.3-.5-.6-.6-.6-1.6-.6-2.7 0-1.2.1-2.1.6-2.7.3-.3.7-.5 1.3-.5.6 0 1 .2 1.3.5.6.6.6 1.5.6 2.7.1 1.2 0 2.2-.6 2.7zm10.8-8.2l-2.2 6.9-2.3-6.9h-2.9L87 24.6h2.2l4.1-11.1h-3zm7.6-.1c-2.9 0-4.8 2-4.8 5.7 0 4.5 2.5 5.7 5.1 5.7 2 0 3.1-.6 4.2-1.7l-1.7-1.6c-.7.7-1.3 1-2.5 1-1.6 0-2.4-1-2.4-2.5h6.9v-1.2c0-3.2-1.7-5.4-4.8-5.4zM95.8 18c0-.5.1-.8.3-1.2.3-.7.9-1.2 1.9-1.2.9 0 1.6.5 1.9 1.2.2.4.2.7.3 1.2h-4.4zm11-3.4v-1.1h-2.7v11.1h2.8v-6.7c0-1.4.9-2 1.8-2 .7 0 1 .2 1.5.7l2.1-2.1c-.8-.8-1.5-1-2.6-1-1.3-.1-2.3.4-2.9 1.1zm6.3-2.3v12.3h2.8v-8.8h2v-2.1h-2v-1.2c0-.6.3-1 1-1h1.1V9.2h-1.6c-2.3 0-3.3 1.6-3.3 3.1zm16.2 1.1c-1.6 0-2.7.6-3.4 1.4-1 1-1.3 2.3-1.3 4.3s.3 3.3 1.3 4.3c.7.7 1.8 1.4 3.4 1.4 1.6 0 2.8-.6 3.4-1.4 1-1 1.3-2.3 1.3-4.3s-.3-3.3-1.3-4.3c-.6-.8-1.8-1.4-3.4-1.4zm1.3 8.3c-.3.3-.7.5-1.3.5-.6 0-1-.2-1.3-.5-.6-.6-.6-1.6-.6-2.7 0-1.2.1-2.1.6-2.7.3-.3.7-.5 1.3-.5.6 0 1 .2 1.3.5.6.6.6 1.5.6 2.7 0 1.2 0 2.2-.6 2.7zm16.5-8.2l-1.8 6.9-2.3-6.9h-2l-2.3 6.9-1.8-6.9H134l3.4 11.1h2.3l2.3-7 2.3 7h2.3l3.4-11.1h-2.9zM122 21.2V9.1h-2.8v12.3c0 1.6 1 3.2 3.2 3.2h1.6v-2.3h-1c-.7 0-1-.4-1-1.1zm-80.7-5.6l1.4-1.4h-3v-3.5h-1.6v11.1c0 1.6.9 2.9 2.7 2.9h1.1v-1.3h-.8c-1 0-1.5-.6-1.5-1.6v-6.1h1.7v-.1z" fill="#222426"></path><path fill="#BCBBBB" d="M21 27v-8h3v11H0V19h3v8z"></path><path d="M5.402 19.101l13.561 1.96.164-2.38-13.256-2.547-.469 2.967zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm3.4-5.9l10.2 8.5 1.7-2-10.2-8.5-1.7 2zM17.1.2L15 1.8l7.9 10.6 2.1-1.6L17.1.2zM5 25h14v-3H5v3z" fill="#F48024"></path></g></svg></a>
                    </div>

                    <nav class="-nav js-category _visible" data-name="default">
                        <h5 class="-title"><a href="https://stackoverflow.com/" class="js-gps-track" data-gps-track="footer.click({ location: 2, link: 15})">Stack Overflow</a></h5>
                        <ul class="-list">
                            <li class="-item"><a href="https://stackoverflow.com/questions" class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 16})">Questions</a></li>
                                <li class="-item"><a href="https://stackoverflow.com/jobs" class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 17})">Jobs</a></li>
                                <li class="-item"><a href="https://stackoverflow.com/jobs/directory/developer-jobs" class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 11})">Developer Jobs Directory</a></li>
                                                            <li class="-item"><a href="https://stackoverflow.com/documentation" class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 18})">Documentation</a></li>
                            <li class="-item"><a href="https://stackoverflow.com/help" class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 3 })">Help</a></li>
                            <li class="-item"><a onclick="StackExchange.switchMobile(&quot;on&quot;)" class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 12 })">Mobile</a></li>
                        </ul>
                    </nav>

                    <nav class="-nav js-category _visible" data-name="default">
                        <h5 class="-title"><a href="https://www.stackoverflowbusiness.com/?utm_source=so-footer&amp;utm_medium=referral&amp;utm_campaign=brand-activation" class="js-gps-track" data-gps-track="footer.click({ location: 2, link: 19 })">Stack Overflow<br> Business</a></h5>
                        <ul class="-list">
                            <li class="-item"><a href="https://www.stackoverflowbusiness.com/talent?utm_source=so-footer&amp;utm_medium=referral&amp;utm_campaign=brand-activation" class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 20 })">Talent</a></li>
                            <li class="-item"><a href="https://www.stackoverflowbusiness.com/advertise?utm_source=so-footer&amp;utm_medium=referral&amp;utm_campaign=brand-activation" class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 21 })">Ads</a></li>
                            <li class="-item"><a href="https://www.stackoverflowbusiness.com/enterprise?utm_source=so-footer&amp;utm_medium=referral&amp;utm_campaign=brand-activation" class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 22 })">Enterprise</a></li>
                            <li class="-item"><a href="https://www.stackoverflowbusiness.com/insights?utm_source=so-footer&amp;utm_medium=referral&amp;utm_campaign=brand-activation" class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 23 })">Insights</a></li>
                        </ul>
                    </nav>

                    <nav class="-nav js-category _visible" data-name="default">
                        <h5 class="-title"><a class="js-gps-track" data-gps-track="footer.click({ location: 2, link: 1 })" href="https://stackoverflow.com/company/about">Company</a></h5>
                        <ul class="-list">
                            <li class="-item"><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 1 })" href="https://stackoverflow.com/company/about">About</a></li>
                            <li class="-item"><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 27 })" href="https://stackoverflow.com/company/press">Press</a></li>
                            <li class="-item"><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 9 })" href="https://stackoverflow.com/company/work-here">Work Here</a></li>
                            <li class="-item"><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 7 })" href="https://stackexchange.com/legal">Legal</a></li>
                            <li class="-item"><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 8 })" href="https://stackexchange.com/legal/privacy-policy">Privacy Policy</a></li>
                            <li class="-item"><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 13 })" href="https://stackoverflow.com/company/contact">Contact Us</a></li>
                        </ul>
                    </nav>

                    <div class="-network g-row">
                        <a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" class="-back-trigger js-back"><svg role="icon" class="svg-icon iconArrowLeftAlt" width="18" height="18" viewBox="0 0 18 18"><path d="M10.582 16l1.41-1.41L6.402 9l5.59-5.59L10.582 2l-7 7z"></path></svg></a>
                        <div>
                            <h5 class="-title"><a href="https://stackexchange.com/">Stack Exchange<br> Network</a></h5>
                            <ul class="-list">
                                <li class="-item"><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" class="-link _expandable js-category-trigger js-gps-track" data-gps-track="footer.click({ location: 2, link: 24 })" data-target="Technology">Technology</a></li>
                                <li class="-item"><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" class="-link _expandable js-category-trigger js-gps-track" data-gps-track="footer.click({ location: 2, link: 24 })" data-target="Life / Arts">Life / Arts</a></li>
                                <li class="-item"><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" class="-link _expandable js-category-trigger js-gps-track" data-gps-track="footer.click({ location: 2, link: 24 })" data-target="Culture / Recreation">Culture / Recreation</a></li>
                                <li class="-item"><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" class="-link _expandable js-category-trigger js-gps-track" data-gps-track="footer.click({ location: 2, link: 24 })" data-target="Science">Science</a></li>
                                <li class="-item"><a href="https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n/3035188#" class="-link _expandable js-category-trigger js-gps-track" data-gps-track="footer.click({ location: 2, link: 24 })" data-target="Other">Other</a></li>

                            </ul>
                        </div>
                    </div>
                    <nav class="-nav js-category" data-name="Technology">
        <ul class="-list">
                <li class="-item"><a href="https://stackoverflow.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="professional and enthusiast programmers">Stack Overflow</a></li>
                <li class="-item"><a href="https://serverfault.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="system and network administrators">Server Fault</a></li>
                <li class="-item"><a href="https://superuser.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="computer enthusiasts and power users">Super User</a></li>
                <li class="-item"><a href="https://webapps.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="power users of web applications">Web Applications</a></li>
                <li class="-item"><a href="https://askubuntu.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="Ubuntu users and developers">Ask Ubuntu</a></li>
                <li class="-item"><a href="https://webmasters.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="pro webmasters">Webmasters</a></li>
                <li class="-item"><a href="https://gamedev.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="professional and independent game developers">Game Development</a></li>
                    </ul></nav><nav class="-nav js-category" data-name="Technology"><ul class="-list">
                <li class="-item"><a href="https://tex.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="users of TeX, LaTeX, ConTeXt, and related typesetting systems">TeX - LaTeX</a></li>
                <li class="-item"><a href="https://softwareengineering.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="professionals, academics, and students working within the systems development life cycle">Software Engineering</a></li>
                <li class="-item"><a href="https://unix.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="users of Linux, FreeBSD and other Un*x-like operating systems">Unix &amp; Linux</a></li>
                <li class="-item"><a href="https://apple.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="power users of Apple hardware and software">Ask Different (Apple)</a></li>
                <li class="-item"><a href="https://wordpress.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="WordPress developers and administrators">WordPress Development</a></li>
                <li class="-item"><a href="https://gis.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="cartographers, geographers and GIS professionals">Geographic Information Systems</a></li>
                <li class="-item"><a href="https://electronics.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="electronics and electrical engineering professionals, students, and enthusiasts">Electrical Engineering</a></li>
                    </ul></nav><nav class="-nav js-category" data-name="Technology"><ul class="-list">
                <li class="-item"><a href="https://android.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="enthusiasts and power users of the Android operating system">Android Enthusiasts</a></li>
                <li class="-item"><a href="https://security.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="information security professionals">Information Security</a></li>
                <li class="-item"><a href="https://dba.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="database professionals who wish to improve their database skills and learn from others in the community">Database Administrators</a></li>
                <li class="-item"><a href="https://drupal.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="Drupal developers and administrators">Drupal Answers</a></li>
                <li class="-item"><a href="https://sharepoint.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="SharePoint enthusiasts">SharePoint</a></li>
                <li class="-item"><a href="https://ux.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="user experience researchers and experts">User Experience</a></li>
                <li class="-item"><a href="https://datascience.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="Data science professionals, Machine Learning specialists, and those interested in learning more about the field">Data Science</a></li>
                    </ul></nav><nav class="-nav js-category" data-name="Technology"><ul class="-list">
                <li class="-item"><a href="https://mathematica.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="users of Wolfram Mathematica">Mathematica</a></li>
                <li class="-item"><a href="https://salesforce.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="Salesforce administrators, implementation experts, developers and anybody in-between">Salesforce</a></li>
                <li class="-item"><a href="https://expressionengine.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="administrators, end users, developers and designers for ExpressionEngine® CMS">ExpressionEngine® Answers</a></li>
                <li class="-item"><a href="https://blender.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="people who use Blender to create 3D graphics, animations, or games">Blender</a></li>
                <li class="-item"><a href="https://networkengineering.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="network engineers">Network Engineering</a></li>
                <li class="-item"><a href="https://crypto.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="software developers, mathematicians and others interested in cryptography">Cryptography</a></li>
                <li class="-item"><a href="https://codereview.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="peer programmer code reviews">Code Review</a></li>
                    </ul></nav><nav class="-nav js-category" data-name="Technology"><ul class="-list">
                <li class="-item"><a href="https://magento.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="users of the Magento e-Commerce platform">Magento</a></li>
                <li class="-item"><a href="https://softwarerecs.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="people seeking specific software recommendations">Software Recommendations</a></li>
                <li class="-item"><a href="https://dsp.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="practitioners of the art and science of signal, image and video processing">Signal Processing</a></li>
                <li class="-item"><a href="https://emacs.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="those using, extending or developing Emacs">Emacs</a></li>
                <li class="-item"><a href="https://raspberrypi.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="users and developers of hardware and software for Raspberry Pi">Raspberry Pi</a></li>
                <li class="-item"><a href="https://codegolf.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="programming puzzle enthusiasts and code golfers">Programming Puzzles &amp; Code Golf</a></li>
                <li class="-item"><a href="https://ethereum.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="users of Ethereum, the decentralized application platform and smart contract enabled blockchain">Ethereum</a></li>
                            <li class="-item">
                    <a href="https://stackexchange.com/sites#technology" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 26 })">
                        <strong>
                            more (27)
                        </strong>
                    </a>
                </li>
        </ul>
    </nav>
    <nav class="-nav js-category" data-name="Life / Arts">
        <ul class="-list">
                <li class="-item"><a href="https://photo.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="professional, enthusiast and amateur photographers">Photography</a></li>
                <li class="-item"><a href="https://scifi.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="science fiction and fantasy enthusiasts">Science Fiction &amp; Fantasy</a></li>
                <li class="-item"><a href="https://graphicdesign.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="Graphic Design professionals, students, and enthusiasts">Graphic Design</a></li>
                <li class="-item"><a href="https://movies.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="movie and tv enthusiasts">Movies &amp; TV</a></li>
                <li class="-item"><a href="https://music.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="musicians, students, and enthusiasts">Music: Practice &amp; Theory</a></li>
                <li class="-item"><a href="https://worldbuilding.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="writers/artists using science, geography and culture to construct imaginary worlds and settings">Worldbuilding</a></li>
                <li class="-item"><a href="https://cooking.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="professional and amateur chefs">Seasoned Advice (cooking)</a></li>
                    </ul></nav><nav class="-nav js-category" data-name="Life / Arts"><ul class="-list">
                <li class="-item"><a href="https://diy.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="contractors and serious DIYers">Home Improvement</a></li>
                <li class="-item"><a href="https://money.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="people who want to be financially literate">Personal Finance &amp; Money</a></li>
                <li class="-item"><a href="https://academia.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="academics and those enrolled in higher education">Academia</a></li>
                <li class="-item"><a href="https://law.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="legal professionals, students, and others with experience or interest in law">Law</a></li>
                            <li class="-item">
                    <a href="https://stackexchange.com/sites#lifearts" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 26 })">
                        <strong>
                            more (16)
                        </strong>
                    </a>
                </li>
        </ul>
    </nav>
    <nav class="-nav js-category" data-name="Culture / Recreation">
        <ul class="-list">
                <li class="-item"><a href="https://english.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="linguists, etymologists, and serious English language enthusiasts">English Language &amp; Usage</a></li>
                <li class="-item"><a href="https://skeptics.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="scientific skepticism">Skeptics</a></li>
                <li class="-item"><a href="https://judaism.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="those who base their lives on Jewish law and tradition and anyone interested in learning more">Mi Yodeya (Judaism)</a></li>
                <li class="-item"><a href="https://travel.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="road warriors and seasoned travelers">Travel</a></li>
                <li class="-item"><a href="https://christianity.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="committed Christians, experts in Christianity and those interested in learning more">Christianity</a></li>
                <li class="-item"><a href="https://ell.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="speakers of other languages learning English">English Language Learners</a></li>
                <li class="-item"><a href="https://japanese.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="students, teachers, and linguists wanting to discuss the finer points of the Japanese language">Japanese Language</a></li>
                    </ul></nav><nav class="-nav js-category" data-name="Culture / Recreation"><ul class="-list">
                <li class="-item"><a href="https://gaming.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="passionate videogamers on all platforms">Arqade (gaming)</a></li>
                <li class="-item"><a href="https://bicycles.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="people who build and repair bicycles, people who train cycling, or commute on bicycles">Bicycles</a></li>
                <li class="-item"><a href="https://rpg.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="gamemasters and players of tabletop, paper-and-pencil role-playing games">Role-playing Games</a></li>
                <li class="-item"><a href="https://anime.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="anime and manga fans">Anime &amp; Manga</a></li>
                <li class="-item"><a href="https://puzzling.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="those who create, solve, and study puzzles">Puzzling</a></li>
                <li class="-item"><a href="https://mechanics.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="mechanics and DIY enthusiast owners of cars, trucks, and motorcycles">Motor Vehicle Maintenance &amp; Repair</a></li>
                            <li class="-item">
                    <a href="https://stackexchange.com/sites#culturerecreation" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 26 })">
                        <strong>
                            more (32)
                        </strong>
                    </a>
                </li>
        </ul>
    </nav>
    <nav class="-nav js-category" data-name="Science">
        <ul class="-list">
                <li class="-item"><a href="https://mathoverflow.net/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="professional mathematicians">MathOverflow</a></li>
                <li class="-item"><a href="https://math.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="people studying math at any level and professionals in related fields">Mathematics</a></li>
                <li class="-item"><a href="https://stats.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="people interested in statistics, machine learning, data analysis, data mining, and data visualization">Cross Validated (stats)</a></li>
                <li class="-item"><a href="https://cstheory.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="theoretical computer scientists and researchers in related fields">Theoretical Computer Science</a></li>
                <li class="-item"><a href="https://physics.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="active researchers, academics and students of physics">Physics</a></li>
                <li class="-item"><a href="https://chemistry.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="scientists, academics, teachers and students">Chemistry</a></li>
                <li class="-item"><a href="https://biology.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="biology researchers, academics, and students">Biology</a></li>
                    </ul></nav><nav class="-nav js-category" data-name="Science"><ul class="-list">
                <li class="-item"><a href="https://cs.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="students, researchers and practitioners of computer science">Computer Science</a></li>
                <li class="-item"><a href="https://philosophy.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="those interested in the study of the fundamental nature of knowledge, reality, and existence">Philosophy</a></li>
                            <li class="-item">
                    <a href="https://stackexchange.com/sites#science" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 26 })">
                        <strong>
                            more (10)
                        </strong>
                    </a>
                </li>
        </ul>
    </nav>
    <nav class="-nav js-category" data-name="Other">
        <ul class="-list">
                <li class="-item"><a href="https://meta.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="meta-discussion of the Stack Exchange family of Q&amp;A websites">Meta Stack Exchange</a></li>
                <li class="-item"><a href="https://stackapps.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="apps, scripts, and development with the Stack Exchange API">Stack Apps</a></li>
                <li class="-item"><a href="https://api.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="programmatic interaction with Stack Exchange sites">API</a></li>
                <li class="-item"><a href="https://data.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="querying Stack Exchange data using SQL">Data</a></li>
                <li class="-item"><a href="https://area51.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 29, link: 25 })" title="proposing new sites in the Stack Exchange network">Area 51</a></li>
                    </ul>
    </nav>
                    <div class="-copyright text-right">
                        <div class="g-column jc-sp-between">
                            <ul class="-list">
                                <li class="-item"><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link:4 })" href="https://stackoverflow.blog/?blb=1">Blog</a></li>
                                <li class="-item"><a href="https://www.facebook.com/officialstackoverflow/" class="-link">Facebook</a></li>
                                <li class="-item"><a href="https://twitter.com/stackoverflow" class="-link">Twitter</a></li>
                                <li class="-item"><a href="https://linkedin.com/company/stack-overflow" class="-link">LinkedIn</a></li>
                            </ul>

                            <div>
                                <p>
                                    site design / logo © 2017 Stack Exchange Inc; user contributions licensed under <a href="https://creativecommons.org/licenses/by-sa/3.0/" rel="license">cc by-sa 3.0</a>
                                    with <a href="https://stackoverflow.blog/2009/06/25/attribution-required/" rel="license">attribution required</a>.
                                    <span id="svnrev">rev 2017.7.14.1282</span>
                                </p>

                            </div>
                        </div>
                    </div>
                </div>

                            </div>
        </footer>

    <noscript>
        &lt;div id="noscript-warning"&gt;Stack Overflow works best with JavaScript enabled
            &lt;img src="https://pixel.quantserve.com/pixel/p-c1rF4kxgLUzNc.gif" alt="" class="dno"&gt;
        &lt;/div&gt;
    </noscript>
<script>var z=document.createElement("script");z.type="text/javascript",z.async=!0,z.src="https://static.adzerk.net/ados.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(z,s);</script>
<script>
var ados = ados || {};
ados.run = ados.run || [];


ados.run.push(function () {
    setTimeout(function () { $("#adzerk-user-match").remove(); }, window.AUMIframeDone ? 0 : 2000);
    ados_setKeywords('python,math,optimization,primes,x-cross-site-unix.stackexchange.com');; ados_load();
});   

</script>

    <script>
            (function(i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function() { (i[r].q = i[r].q || []).push(arguments) }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m);
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
                ga('create', 'UA-5620270-1');
                ga('create', 'UA-5620270-59', {name: 'pageData', sampleRate: 5 });
                ga('set', 'dimension2', '|python|math|optimization|primes|');
                ga('pageData.set', 'dimension2', '|python|math|optimization|primes|');
                ga('send', 'pageview');
                ga('pageData.send', 'pageview');
        var _qevents = _qevents || [],
            _comscore = _comscore || [];
        (function () {
            var ssl='https:'==document.location.protocol,
                s=document.getElementsByTagName('script')[0],
                qc=document.createElement('script');
                qc.async = true;
                qc.src = (ssl ? 'https://secure' : 'http://edge') + '.quantserve.com/quant.js';
                s.parentNode.insertBefore(qc, s);
                _qevents.push({ qacct: "p-c1rF4kxgLUzNc" });
                            var sc=document.createElement('script');
                sc.async=true;
                sc.src=(ssl?'https://sb':'http://b') + '.scorecardresearch.com/beacon.js';
                s.parentNode.insertBefore(sc, s);
                _comscore.push({ c1: "2", c2: "17440561" });
        })();

    </script>
        
    
            <script type="text/javascript">
                
                (function(appendChild) {
                    Node.prototype.appendChild = function() {
                        var parent = this;
                        var newNode = arguments[0];
                        if (parent.nodeName === 'HEAD'
                            && newNode
                            && newNode.nodeName === 'SCRIPT'
                            && newNode.src) {
                            
                            window.setTimeout(function() {
                                var result = newNode.src.match(/^https:\/\/maps\.googleapis\.com\/maps\/api\/place\/js\/(\w+)Service\./i) || [];
                                var service = result[1];
                                if (service) {
                                    if (service === 'Autocompletion') service =  2;
                                    else if (service === 'Place') service = 1;
                                    else service = 0;
                                    StackExchange.using('gps', function() {
                                        StackExchange.gps.track('google_maps_places_api.call', { service: service });
                                    });
                                }
                            }, 0);
                        }
                        return appendChild.apply(this, arguments);
                    };
                })(Node.prototype.appendChild);
            </script>
    

</body></html>